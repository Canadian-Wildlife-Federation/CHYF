package net.refractions.chyf.skeleontizer.points;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.geotools.filter.identity.FeatureIdImpl;
import org.junit.Test;
import org.locationtech.jts.geom.Coordinate;
import org.locationtech.jts.geom.LineString;
import org.locationtech.jts.io.ParseException;
import org.locationtech.jts.io.WKTReader;
import org.opengis.filter.identity.FeatureId;

import net.refractions.chyf.datasource.ChyfDataSource.EfType;
import net.refractions.chyf.directionalize.DirectionType;
import net.refractions.chyf.directionalize.Directionalizer;
import net.refractions.chyf.directionalize.graph.DGraph;
import net.refractions.chyf.directionalize.graph.EdgeInfo;

public class DirectionalizeTest {

	@Test
	public void donothing() {
		Coordinate[] ns_sinks = new Coordinate[] {
				new Coordinate(-63.7154359,44.4738089),
				new Coordinate(-63.716844,44.4728822),
				new Coordinate(-63.7908933,44.5359841),
				new Coordinate(-63.6097847,44.4790512),
				new Coordinate(-63.6081129,44.4937358),
				new Coordinate(-63.8472241,44.4969476),
				new Coordinate(-63.8489455,44.4913351),
				new Coordinate(-63.5567425,44.5734791),
				new Coordinate(-63.5545175,44.5507035),
				new Coordinate(-63.4928857,44.6101535),
				new Coordinate(-63.5069836,44.6193753),
				new Coordinate(-63.6564389,44.7245524),
				new Coordinate(-63.6622693,44.730293),
				new Coordinate(-63.8256175,44.5240438),
				new Coordinate(-63.6061015,44.6946811),
				new Coordinate(-63.6196391,44.7050887),
				new Coordinate(-63.9269989,44.6135756),
				new Coordinate(-63.9235355,44.598274),
				new Coordinate(-63.5274822,44.4982034),
				new Coordinate(-63.5236386,44.5100644),
				new Coordinate(-63.7372036,44.4791821),
				new Coordinate(-63.5817221,44.6210168),
				new Coordinate(-63.5667197,44.609058),
				new Coordinate(-63.8679179,44.5108285),
				new Coordinate(-63.8646065,44.5107159),
				new Coordinate(-63.6196391,44.7050887),
				new Coordinate(-63.6564389,44.7245524),
				new Coordinate(-63.9321307,44.5041713),
				new Coordinate(-63.9091183,44.5002626),
				new Coordinate(-63.8472241,44.4969476),
				new Coordinate(-63.8512169,44.5266291),
				new Coordinate(-63.8309607,44.5255029),
				new Coordinate(-63.8356721,44.5256904),
				new Coordinate(-63.7127943,44.4760274),
				new Coordinate(-63.9321307,44.5041713),
				new Coordinate(-63.9176512,44.5723356),
				new Coordinate(-63.6061015,44.6946811),
				new Coordinate(-63.5438818,44.6438562),
				new Coordinate(-63.6057403,44.471212),
				new Coordinate(-63.6189685,44.4599689),
				new Coordinate(-63.9269989,44.6135756),
				new Coordinate(-63.8309607,44.5255029),
				new Coordinate(-63.8256175,44.5240438),
				new Coordinate(-63.5438818,44.6438562),
				new Coordinate(-63.5069836,44.6193753),
				new Coordinate(-63.7846455,44.4912234),
				new Coordinate(-63.7639197,44.525799),
				new Coordinate(-63.5470179,44.4886531),
				new Coordinate(-63.5274822,44.4982034),
				new Coordinate(-63.6718515,44.4672442),
				new Coordinate(-63.6509696,44.4705516),
				new Coordinate(-63.6403868,44.4717386),
				new Coordinate(-63.6509696,44.4705516),
				new Coordinate(-63.5507959,44.4927473),
				new Coordinate(-63.6081129,44.4937358),
				new Coordinate(-63.6737816,44.7141979),
				new Coordinate(-63.6622693,44.730293),
				new Coordinate(-63.7422337,44.4755759),
				new Coordinate(-63.7639197,44.525799),
				new Coordinate(-63.5457419,44.5402316),
				new Coordinate(-63.5545175,44.5507035),
				new Coordinate(-63.9136217,44.5835804),
				new Coordinate(-63.918142,44.5938259),
				new Coordinate(-63.5507959,44.4927473),
				new Coordinate(-63.5470179,44.4886531),
				new Coordinate(-63.7372036,44.4791821),
				new Coordinate(-63.7410595,44.4801194),
				new Coordinate(-63.9091183,44.5002626),
				new Coordinate(-63.9033525,44.4981376),
				new Coordinate(-63.8699959,44.5065917),
				new Coordinate(-63.8783026,44.5061484),
				new Coordinate(-63.788117,44.527467),
				new Coordinate(-63.918142,44.5938259),
				new Coordinate(-63.9235355,44.598274),
				new Coordinate(-63.8679179,44.5108285),
				new Coordinate(-63.8699959,44.5065917),
				new Coordinate(-63.5457419,44.5402316),
				new Coordinate(-63.5236386,44.5100644),
				new Coordinate(-63.6097847,44.4790512),
				new Coordinate(-63.6169776,44.4682273),
				new Coordinate(-63.6000874,44.6310746),
				new Coordinate(-63.6189634,44.6402193),
				new Coordinate(-63.8866043,44.5039833),
				new Coordinate(-63.9033525,44.4981376),
				new Coordinate(-63.8356721,44.5256904),
				new Coordinate(-63.8512169,44.5266291),
				new Coordinate(-63.7846455,44.4912234),
				new Coordinate(-63.7873957,44.4803311),
				new Coordinate(-63.6718515,44.4672442),
				new Coordinate(-63.7091261,44.475661),
				new Coordinate(-63.7422337,44.4755759),
				new Coordinate(-63.7410595,44.4801194),
				new Coordinate(-63.6000874,44.6310746),
				new Coordinate(-63.5817221,44.6210168),
				new Coordinate(-63.6403868,44.4717386),
				new Coordinate(-63.6283675,44.4756572),
				new Coordinate(-63.4550154,44.5927255),
				new Coordinate(-63.6057403,44.471212),
				new Coordinate(-63.6169776,44.4682273),
				new Coordinate(-63.8489455,44.4913351),
				new Coordinate(-63.8646065,44.5107159),
				new Coordinate(-63.7127943,44.4760274),
				new Coordinate(-63.7091261,44.475661),
				new Coordinate(-63.6189685,44.4599689),
				new Coordinate(-63.6283675,44.4756572),
				new Coordinate(-63.5567425,44.5734791),
				new Coordinate(-63.5667197,44.609058),
				new Coordinate(-63.8866043,44.5039833),
				new Coordinate(-63.8783026,44.5061484),
				new Coordinate(-63.4928857,44.6101535),
				new Coordinate(-63.4550154,44.5927255),
				new Coordinate(-63.7873957,44.4803311),
				new Coordinate(-63.788117,44.527467),
				new Coordinate(-63.6737816,44.7141979),
				new Coordinate(-63.6189634,44.6402193),
				new Coordinate(-63.9136217,44.5835804),
				new Coordinate(-63.9176512,44.5723356),
		};
		
		Set<Coordinate> cs = new HashSet<>();
		for (Coordinate c : ns_sinks) cs.add(c);
		for (Coordinate c : cs) {
			System.out.println("new Coordinate(" + c.x + ", " + c.y + "),");
		}
	}
	@Test
	public void loop5Test() throws Exception {
		String[] edges = new String[] {

				"LINESTRING (-1553989.9433370244 356251.1884820012, -1553995.4499884082 356251.4652914353)",
				"LINESTRING (-1553877.645700978 355980.48915186897, -1553880.476014275 355982.895331691, -1553882.360611992 355987.34863408573, -1553883.2350367352 355993.53116438136, -1553894.6768928322 355997.35052932345, -1553902.203210011 355999.07322575327, -1553915.4946036052 356003.33384257613, -1553925.9309039316 356005.94170233986, -1553931.0221233375 356007.8893646337, -1553934.606240597 356009.7025033763, -1553936.9349457615 356018.11340423406)",
				"LINESTRING (-1553791.978779562 356312.30965743866 1892, -1553783.4881769342 356309.2400216013 1892, -1553773.2092501663 356305.5248455135 1891, -1553760.9945100704 356301.10878845025 1890, -1553754.1714576345 356299.64928400517 1889, -1553749.0160204216 356298.9617718896 1889, -1553738.7059709474 356298.4253372485 1887, -1553731.7331792982 356296.9127036212 1886, -1553723.8348792556 356298.2564775944 1885, -1553715.010185342 356302.4562038183 1884, -1553709.1360108282 356306.71544091497 1883, -1553702.6046117085 356312.9196100347 1881, -1553697.1480054876 356316.32139435504 1881, -1553689.8744793488 356318.899399274 1880, -1553682.6300070663 356321.6547569772 1878, -1553670.622041801 356319.32906356826 1876, -1553658.7928468115 356317.23608830385 1875, -1553650.927013161 356315.400707867 1874, -1553644.2537656426 356313.156219244 1873, -1553637.4302635335 356311.6976192929 1871, -1553630.4250225835 356313.36416032724 1870, -1553623.4206699166 356315.03115611617 1869, -1553614.0036808264 356314.8175014956 1868, -1553607.0612679366 356313.4840347916 1867, -1553601.7560373684 356313.58153679315 1867, -1553592.252134532 356310.3147446504 1865, -1553586.5917326664 356308.26834716275 1865, -1553579.7357810284 356309.9889140129 1864, -1553572.4627226002 356312.56604377273 1863, -1553563.133145952 356314.568749642 1862, -1553555.4711272418 356318.18157027196 1861, -1553549.7458306 356322.4934886554 1861, -1553545.5387852236 356328.36372939777 1860, -1553540.2898641543 356333.8563050376 1859, -1553535.96347714 356339.8503289893 1859, -1553530.6266939894 356343.12744187843 1858, -1553523.5899099675 356347.9735941719 1857, -1553517.0905453016 356350.9994933875 1857, -1553511.602409362 356357.5808828017 1856, -1553508.6773812524 356362.73818040546 1855, -1553505.7827273079 356368.074624897 1854, -1553501.456349671 356374.06863848306 1853, -1553498.800486608 356378.3149191318 1853, -1553493.9695720624 356382.9513760926 1852, -1553485.2328023857 356389.366555633 1851, -1553478.8831877005 356392.44558070414 1850, -1553470.2977764693 356395.55648717936 1849, -1553461.741853345 356398.8460874595 1848, -1553454.3494588875 356401.5492267534 1848, -1553446.0627004683 356403.92781601567 1847, -1553439.2076651934 356405.6488356702 1846, -1553432.202459047 356407.3153820755 1846, -1553426.920673509 356415.9879628001 1845, -1553424.5314629795 356422.6823961213 1845, -1553423.1559831754 356429.5753609268 1844, -1553421.6303320692 356436.413850002 1844, -1553416.7998897876 356441.0494062705 1843, -1553409.7626867455 356445.8964248905 1843, -1553404.2831375524 356440.7244832255 1842, -1553397.997526966 356437.44478213694 1842, -1553392.755131951 356434.5423080623 1842, -1553387.4823626345 356431.4606871577 1841, -1553383.544514957 356436.4198857434 1841, -1553377.401703 356441.58922640234 1840, -1553372.1823109095 356447.26046523266 1839, -1553368.2444668992 356452.2196598854 1839, -1553365.7387962658 356456.5203964319 1839, -1553361.8009540276 356461.47958877217 1839, -1553360.0685307824 356466.2277489314 1839, -1553356.1315775618 356471.18739311956 1838, -1553342.7473182396 356475.7542621279 1838, -1553338.1296995052 356474.086010593 1838, -1553327.7314701055 356470.49472812936 1837, -1553318.346514116 356467.10286767315 1837, -1553314.116962356 356464.3984829467 1837, -1553309.8000430085 356458.6396452598 1836, -1553307.1831093736 356451.3117745416 1836, -1553302.4490877867 356446.40949176624 1836, -1553292.4388977382 356441.7843114231 1835, -1553284.9901958625 356439.0924325222 1835, -1553276.7367811545 356438.292360072 1835, -1553267.675463548 356440.2239723718 1834, -1553258.3459530142 356442.22669496015 1833, -1553253.0711293097 356442.50336727314 1833, -1553241.717027056 356441.5915658735 1832, -1553236.6814186324 356440.77942691837 1832, -1553230.0955657018 356441.5894537233 1831, -1553219.3666954064 356441.9109808998 1830, -1553212.631105169 356442.66787873954 1830, -1553196.2384639978 356444.3017682601 1828, -1553189.6226729697 356444.9339945093 1828, -1553182.887085441 356445.6908953348 1827, -1553177.6122660432 356445.96757438406 1827, -1553168.9079996687 356449.203630276 1826, -1553160.6217193305 356451.5835855277 1825, -1553149.2352081342 356453.8509244509 1825, -1553142.6489093683 356454.66184709966 1824, -1553133.7083680916 356455.6289039431 1824, -1553127.3898823778 356455.5292549813 1824, -1553122.7722615113 356453.86102682445 1823, -1553116.842725995 356452.72569868714 1823, -1553111.4510420384 356449.7692456506 1822, -1553105.7902046898 356447.72380013857 1822, -1553100.2777641169 356445.73191930726 1822, -1553094.3806422309 356441.4174746359 1821, -1553090.4202343475 356437.80210762005 1820, -1553086.1028358885 356432.044189428 1820, -1553082.022629963 356428.5534967035 1819, -1553076.5425997493 356423.38249780424 1819, -1553051.218325354 356414.2315938724 1818, -1553042.0696439615 356413.10879578814 1813, -1553035.7230105104 356412.8300354611 1810, -1553027.8243460576 356414.17476610094 1808, -1553019.5695980901 356413.3751713624 1808, -1553008.6339409591 356411.60643580835 1807, -1552993.5885621395 356406.17055732943 1805, -1552980.2103148769 356402.3434217153 1803, -1552974.1614121369 356401.33412990347 1792, -1552963.4640741353 356398.4761395464 1789, -1552953.8108401203 356395.9958214611 1786, -1552948.1499956273 356393.95039691124 1785, -1552942.0691442294 356396.11934063584 1770, -1552935.514367125 356393.75072036777 1763, -1552928.454147792 356390.0241097575 1762, -1552920.8570397352 356387.2787312977 1761, -1552915.196194083 356385.23331114 1753, -1552913.8902212433 356377.37212178577 1748, -1552913.9541351509 356371.01342689805 1740, -1552912.917310344 356362.24122487474 1737, -1552909.40592317 356354.59108136036 1735, -1552904.227418812 356345.3299706979 1734, -1552899.6736975892 356337.3030646499 1724, -1552895.3567241959 356331.54427263234 1722, -1552887.7036518068 356323.40522280335 1717, -1552880.973566897 356315.76671952754 1713, -1552874.83966487 356309.18418467976 1712, -1552866.4420029614 356299.9356037341 1711, -1552861.6519739092 356289.6396884974 1702, -1552859.3027682628 356281.40126547124 1700, -1552851.8304754223 356270.136646864 1698, -1552846.8567401615 356266.32411712594 1698, -1552838.9580674928 356267.66889578477 1697, -1552833.2972058235 356265.62348647974 1696, -1552825.8804125004 356259.75344522204 1695, -1552819.3904008605 356251.02658039983 1694, -1552812.628790317 356246.5676644193 1693, -1552805.6879503096 356241.8769274447 1692, -1552799.3148261604 356236.3832129361 1691, -1552785.162433826 356231.2701481823 1689, -1552780.8125932033 356228.691377799 1689, -1552773.2213661864 356217.5518945558 1687, -1552769.0241637765 356211.6684273798 1686, -1552757.9063395357 356213.0257704416 1684, -1552751.588724657 356212.9266407443 1683, -1552745.2402791628 356212.6492528012 1682, -1552737.6116394738 356213.08349419385 1681, -1552731.2931383245 356212.9839126123 1681, -1552724.737878469 356210.61621263623 1680, -1552719.8839260305 356206.6790209543 1679, -1552711.0034532652 356204.6470640721 1677, -1552705.7310694205 356201.5668704957 1677, -1552698.9694455552 356197.1079718871 1675, -1552694.234007814 356192.20618587825 1675, -1552690.065829792 356186.50230753515 1674, -1552682.6813946574 356177.453153166 1673, -1552678.9891760647 356172.9285758585 1672, -1552678.3643830565 356171.6943695685 1672, -1552674.4354016895 356164.9016708601 1671, -1552669.2244503573 356158.8196948068 1670, -1552660.1076606466 356154.5187403476 1670, -1552659.2137229564 356154.1955488585 1670)",
				"LINESTRING (-1553886.0708610727 355956.9971086085 1894, -1553882.9389905115 355960.06413841434 1893, -1553878.1066528298 355964.698895121 1893, -1553877.235162367 355972.95049764775 1893, -1553877.0209331363 355979.254903174 1893, -1553877.645700978 355980.48915186897 1892)",
				"LINESTRING (-1554214.535746502 356506.9686487984, -1554197.7063359914 356511.8979846353, -1554185.0344666815 356514.6975601693, -1554181.1203675075 356515.23833224754, -1554173.8059232982 356515.40956743463, -1554161.5601362353 356514.6715477806, -1554149.1296470424 356514.44151791447, -1554131.5633806165 356513.1693397666, -1554126.9004137365 356512.14482987043, -1554106.519452025 356504.506838174)",
				"LINESTRING (-1553815.6642827804 355920.614904675, -1553824.0640227618 355922.82083325426, -1553834.0253091534 355924.1380665783, -1553837.3725287602 355924.12468970875, -1553843.85792797 355922.7942161085, -1553848.8748251088 355921.23882410175, -1553860.058065484 355917.1729614746, -1553866.0704562562 355914.2080993428, -1553869.4251818524 355914.13697599946, -1553872.6650375517 355917.27714420116, -1553876.7890550883 355919.68313336873, -1553890.3073639174 355929.4693154666, -1553902.7593541313 355935.42122229235, -1553897.5524147328 355942.5619493677, -1553890.545200778 355950.01248357294, -1553889.3752460976 355952.89808823634, -1553886.673175998 355955.3311433908, -1553886.0708610727 355956.9971086085)",
				"LINESTRING (-1553997.434329756 356200.8353182029, -1553990.5713494096 356211.2190390532, -1553986.3649054987 356225.2412028665, -1553986.2791237445 356229.0407520826, -1553987.9510926795 356236.6467360926, -1553988.8036564887 356245.25044676324, -1553989.9433370244 356251.1884820012)",
				"LINESTRING (-1554449.6994322585 356331.95993846096 1914, -1554448.8054982086 356331.63670934923 1914, -1554440.2489829448 356334.92487510666 1914, -1554433.1252059727 356336.71556833107 1913, -1554425.6444259845 356337.2017940264 1912, -1554418.37172311 356339.7779480554 1911, -1554410.0839437968 356342.15598159935 1910, -1554397.3875187577 356344.9537995672 1909, -1554388.682616421 356348.1883992329 1908, -1554381.438060822 356350.9436849188 1907, -1554371.570499687 356354.765190172 1905, -1554364.1775499755 356357.46690772753 1904, -1554357.1726991397 356359.1324768439 1903, -1554349.2748031518 356360.475273706 1903, -1554342.4192389478 356362.19486647286 1902, -1554335.9193401986 356365.2193577206 1901, -1554328.2576690495 356368.83120840415 1900, -1554323.6953785196 356372.5552868508 1900, -1554318.9498616087 356380.2453259295 1899, -1554313.937034911 356388.0069219889 1899, -1554309.9656527964 356396.1448550448 1898, -1554307.9643808731 356401.803193043 1898, -1554305.962655052 356407.46241740976 1897, -1554304.2006281877 356412.0319263851 1897, -1554301.8112622914 356418.72640559636 1897, -1554300.7025828508 356424.7083971109 1896, -1554300.6089789004 356430.8885059068 1896, -1554301.9423970478 356438.929884891 1895, -1554303.1598482665 356444.576655847 1895, -1554301.008840582 356450.18184681423 1895, -1554297.038808414 356458.3193222927 1894, -1554292.8321007234 356464.1886399705 1894, -1554289.936448639 356469.5246222289 1893, -1554286.8919674833 356474.8056928115 1893, -1554284.266384773 356479.2311115982 1893, -1554280.44732116 356484.0651687784 1892, -1554279.016466205 356484.72317522764 1892)",
				"LINESTRING (-1553993.112302908 356041.3831525261, -1553992.264572544 356046.4505473252, -1553988.7169383792 356059.24813559453, -1553985.0057883759 356068.01882092585)",
				"LINESTRING (-1554214.535746502 356506.9686487984, -1554213.113732641 356496.82304827194, -1554199.5995394015 356464.9778233189, -1554191.942693755 356451.02409522235, -1554182.1454210018 356439.335814954, -1554179.1224400392 356437.04666397965, -1554166.1203249437 356430.33517946536, -1554154.8815134342 356425.0057712401, -1554141.5248175624 356419.8671055859, -1554116.4601673114 356407.1737765323, -1554102.2705688314 356405.92786963773, -1554027.8299652406 356435.644881417, -1554017.1331585003 356440.7244299365, -1554014.122386159 356444.3378633345)",
				"LINESTRING (-1553993.112302908 356041.3831525261, -1553979.3725700204 356038.2944782385, -1553964.6568731223 356034.1164287751, -1553960.200976726 356032.4594457726, -1553944.6707003377 356023.80147850385, -1553936.9349457615 356018.11340423406)",
				"LINESTRING (-1553883.9337689881 356301.902746681, -1553857.1417362813 356304.31612903945, -1553829.8308135918 356308.8302997057, -1553818.449865205 356312.22871643805, -1553803.3872142439 356319.55056170485, -1553796.7574393402 356314.36671077454, -1553791.978779562 356312.30965743866)",
				"LINESTRING (-1554595.589828511 355353.8954632608 2146, -1554588.969408912 355357.88389164116 2142, -1554582.824463662 355363.05258975644 2138, -1554576.0547591643 355366.98699325044 2134, -1554570.326957104 355371.2990849428 2131, -1554564.4512100825 355375.5567188123 2127, -1554559.6182524452 355380.1924946606 2123, -1554555.6788172745 355385.15015861206 2121, -1554549.951907963 355389.4627009481 2116, -1554544.0761664174 355393.72033121996 2112, -1554537.003873164 355401.7446504496 2107, -1554532.7961383716 355407.6138229398 2103, -1554529.4814710382 355413.8057702258 2100, -1554525.541588867 355418.76431371924 2097, -1554520.9444278248 355425.66787780076 2096, -1554518.018306183 355430.8249688754 2090, -1554511.2161041277 355437.9386691991 2087, -1554506.38316124 355442.57443058304 2085, -1554501.1946492873 355445.0648450637 2084, -1554496.1254886421 355447.4314674055 2083, -1554488.4288869346 355454.22281991504 2081, -1554484.489468893 355459.18046539184 2079, -1554480.9056229433 355466.2834531963 2078, -1554477.8601593722 355471.5643254202 2076, -1554476.1266726376 355476.3122805832 2075, -1554472.5103146967 355486.5945639843 2073, -1554469.1618069578 355495.96622047666 2071, -1554465.223282787 355500.9243098069 2070, -1554461.283417858 355505.8828315111 2069, -1554454.2120501935 355513.90755962115 2067, -1554450.2730753839 355518.8665323928 2066, -1554447.2276198796 355524.14739080425 2065, -1554443.673269406 355531.4290581476 2064, -1554440.1768261332 355540.7462373283 2062, -1554437.280206708 355546.08200089075 2061, -1554433.0725026077 355551.9511307357 2060, -1554429.1331014023 355556.9087517429 2059, -1554425.1941341085 355561.8677137485 2058, -1554422.7734467098 355568.38284179475 2057, -1554420.2658245661 355572.6828667717 2055, -1554416.8322716379 355578.9998963522 2055, -1554412.3874635256 355582.5994394105 2049, -1554408.6851788743 355589.8266292652 2048, -1554406.177105176 355594.12753755227 2046, -1554400.5376362498 355600.6542441873 2044, -1554396.7475315263 355605.6658757897 2042, -1554388.4301310284 355607.865365413 2041, -1554378.9790784516 355610.8313798122 2040, -1554370.2740316545 355614.0661659138 2038, -1554361.953612388 355619.62363846693 2036, -1554352.3207727666 355625.7149094725 2034, -1554343.764132887 355629.00326316245 2032, -1554337.8884541807 355633.26084303483 2016, -1554336.3072998063 355634.7048037676 2015, -1554332.2814134846 355637.4486538302 2014, -1554324.651231862 355637.88095779903 2013, -1554314.8455056492 355638.7021038281 2012, -1554309.3908705718 355638.7455686331 2006, -1554303.491130716 355637.7879372919 2005, -1554291.9005273634 355634.60465950053 2004, -1554279.9218221416 355632.4575665938 2004, -1554271.6677668765 355631.65605852474 2004, -1554263.768404139 355632.9994198261 1997, -1554255.2442780347 355633.10850845464 1996, -1554249.3150551133 355631.9721828839 1995, -1554242.372079846 355630.6373121198 1994, -1554234.2364877982 355629.7115650978 1994, -1554227.2935125837 355628.376696649 1993, -1554221.9881676207 355628.47419316415 1992, -1554213.8745299776 355636.1220819717 1991, -1554210.9779503732 355641.457816449 1991, -1554213.8626459674 355647.8754147673 1990, -1554215.0462966359 355656.7020415254 1988, -1554213.549082504 355663.7190568317 1986, -1554210.8597081252 355671.14430367015 1984, -1554208.8579664198 355676.8037076704 1983, -1554205.5433744793 355682.9955678107 1981, -1554202.7350869651 355690.54594060034 1979, -1554200.463277154 355697.1159304753 1978, -1554198.9365828184 355703.95423222054 1976, -1554194.9317860152 355715.2712246347 1973, -1554193.823108174 355721.25338630285 1972, -1554192.027687704 355729.0018367367 1968, -1554190.2621846977 355736.93032688834 1964, -1554189.7233871515 355738.75107208174 1963, -1554188.6476593362 355741.55308317207 1963, -1554186.2573932305 355748.247301952 1961, -1554182.9436976644 355754.43959497195 1960, -1554171.127415623 355769.3154418273 1958, -1554166.9188910327 355775.18405077327 1957, -1554160.117707605 355782.2980839815 1956, -1554154.5976599797 355788.7009399086 1955, -1554149.7661503612 355793.336187711 1954, -1554141.4453549276 355798.89450406004 1953, -1554133.2773095225 355801.1480070334 1952, -1554121.708271518 355806.5392182823 1951, -1554115.3576043532 355809.6178657571 1951, -1554110.1076362464 355815.1101274453 1950, -1554105.275248825 355819.7449153336 1949, -1554100.4424081955 355824.3805900784 1946, -1554096.4710258252 355832.5187267568 1941, -1554094.8574024239 355837.1419143509 1941, -1554091.543729055 355843.3341790186 1938, -1554086.7108930466 355847.9698481504 1934, -1554080.8361693667 355852.2278395435 1928, -1554077.9405105491 355857.56397097185 1928, -1554073.787363592 355868.8273082217 1927, -1554071.7852176963 355874.4853143012 1921, -1554071.0326020317 355882.6118353177 1920, -1554071.9480712663 355891.5094731422 1918, -1554072.777042579 355898.1911586579 1916, -1554073.6046718361 355904.8732761843 1915, -1554069.872996623 355911.921646866 1912, -1554065.6662774752 355917.7911222996 1909, -1554062.7697377163 355923.1267825924 1907, -1554054.9258043705 355929.86486229394 1904, -1554051.4053898514 355933.96671804506 1903, -1554048.3609088305 355939.2479187967 1902, -1554046.0891374303 355945.8178282678 1901, -1554044.9818282784 355951.7994887056 1899, -1554041.6681717685 355957.9917186415 1898, -1554039.6655799479 355963.6505887974 1897, -1554037.903569121 355968.22018022835 1896, -1554035.0079240056 355973.556281507 1894, -1554033.274511138 355978.30411458295 1893, -1554031.3057462866 355980.7833263548 1892)",
				"LINESTRING (-1553997.434329756 356200.8353182029, -1554007.1954927128 356203.2012023079, -1554009.3014950862 356208.8284328297, -1554011.3193641321 356217.9764472648, -1554011.6865364565 356221.62645258044, -1554009.6760201824 356232.42118264263, -1554005.7973926377 356239.8334875835, -1554001.065078488 356251.18992868724, -1553995.4499884082 356251.4652914353)",
				"LINESTRING (-1554106.519452025 356504.506838174, -1554095.373730127 356500.3278701104, -1554040.4060569943 356468.69517585, -1554028.7418081854 356458.3552289584, -1554014.122386159 356444.3378633345)",
				"LINESTRING (-1553912.9118919782 356264.17333521275, -1553954.5506890656 356262.7132550929, -1553967.6468989467 356261.52904119116, -1553975.764547947 356258.7263186872, -1553983.4692573817 356254.9865245406, -1553989.9433370244 356251.1884820012)",
				"LINESTRING (-1554031.3057462866 355980.7833263548, -1554033.8978037136 355989.33138424123, -1554031.3562109307 355991.34816060186, -1554028.1550733573 355994.9146942852, -1554019.3372977674 356003.15680119564, -1554013.7076913905 356012.8055283312, -1554008.1736320986 356024.76077280164, -1554001.0330770956 356031.901981674, -1553993.112302908 356041.3831525261)",
				"LINESTRING (-1553985.0057883759 356068.01882092585, -1553982.8653068773 356074.0623717696, -1553978.9642106837 356083.1699754208, -1553971.9181177837 356097.6813600585, -1553969.2158900064 356101.9936572814, -1553960.367613503 356113.31528332236, -1553956.8625299 356119.9737044655, -1553954.2170411213 356125.71510069264, -1553952.629605281 356131.04953770555, -1553948.9937555094 356140.30888535955, -1553945.1782964037 356151.629807487, -1553949.034498999 356163.52155462623, -1553952.3147515552 356177.4952856108)",
				"LINESTRING (-1553972.9372937004 356407.8531492888, -1553927.1700735732 356360.3831765434, -1553909.330038775 356338.9983726537, -1553902.7775290417 356326.0461185245, -1553895.8157686684 356318.8765040835, -1553887.59140715 356311.1805531395, -1553883.9337689881 356301.902746681)",
				"LINESTRING (-1554010.7214891056 356445.2461432464, -1553982.0059623448 356417.1990184219, -1553972.9372937004 356407.8531492888)",
				"LINESTRING (-1553892.206949219 356264.12827928487, -1553889.0168492286 356272.7969755515, -1553887.7513364514 356277.73545217275, -1553885.092400953 356292.71043131937, -1553883.9337689881 356301.902746681)",
				"LINESTRING (-1554630.3950951255 355701.5839422187 2091, -1554615.2305250135 355725.83050925937 2080, -1554612.508094777 355736.4359222315 2077, -1554610.7416204133 355744.3639892172 2075, -1554610.2572024036 355751.5791072091 2074, -1554607.8373799277 355758.0946431514 2072, -1554606.7277539778 355764.0763663491 2071, -1554605.114066106 355768.6995863244 2063, -1554602.036511676 355777.16099778283 2060, -1554601.9701193923 355783.519971651 2058, -1554601.0975942563 355791.77125421166 2055, -1554599.3020962293 355799.51971261203 2053, -1554596.2236577522 355807.98065775447 2053, -1554593.9522398424 355814.54974574316 2049, -1554591.8002729542 355820.1546525294 2047, -1554590.4228011465 355827.0469688475 2046, -1554588.4201218989 355832.70589580014 2045, -1554585.0738386803 355842.0774368504 2044, -1554584.4366428307 355852.5973495748 2043, -1554583.2659033102 355861.5800604485 2041, -1554581.7686299214 355868.5970411943 2039, -1554580.7471776851 355877.6337692663 2037, -1554579.9076362827 355882.70487390365 2035, -1554579.4236571342 355889.921290908 2034, -1554578.0453019473 355896.8131316826 2032, -1554578.8737431988 355903.49575945735 2030, -1554577.3469895124 355910.334027132 2029, -1554575.344315683 355915.9929325599 2028, -1554572.2667773801 355924.4542865269 2027, -1554569.3706167666 355929.7890685918 2025, -1554566.9508103775 355936.30455065146 2023, -1554564.679403575 355942.8735997379 2021, -1554561.2128756412 355952.37065761257 2018, -1554558.5234491085 355959.7958283201 2016, -1554556.1036461166 355966.3113011103 2013, -1554552.1321737252 355974.44940354954 2011, -1554548.193679033 355979.40737237036 2009, -1554545.5662603949 355983.8319912385 2007, -1554542.4887331198 355992.29331770446 2005, -1554539.5301233607 356000.62951020896 2002, -1554537.528346263 356006.2888455838 2001, -1554532.2774408546 356011.78058783896 1991, -1554526.5733917695 356024.66696717124 1989, -1554522.6019309796 356032.80504634045 1988, -1554517.0822973137 356039.20692760404 1982, -1554510.011887386 356047.2318867557 1979, -1554506.0734053638 356052.1898373598 1977, -1554500.851993255 356057.86026588455 1974, -1554495.064520974 356065.1727386452 1970, -1554491.6309914896 356071.48962347955 1967, -1554487.8413455808 356076.5024790205 1965, -1554484.9157246419 356081.6585221151 1963, -1554480.3199590128 356088.56365837064 1961, -1554474.6814247528 356095.09065162484 1959, -1554471.9920232294 356102.5157702416 1957, -1554469.3325380587 356110.12092706375 1956, -1554467.301747915 356115.60064537264 1955, -1554466.193037582 356121.58272382896 1955, -1554464.6966796408 356128.6000729641 1954, -1554463.3192377882 356135.49229017925 1953, -1554461.5233243734 356143.24151206296 1952, -1554459.9400367455 356148.04380161315 1952, -1554460.0812853836 356156.4935007291 1950, -1554460.1027310465 356165.06787227467 1950, -1554458.7252909318 356171.9600785319 1949, -1554459.404457638 356178.5886008926 1948, -1554459.3394266802 356184.94702740293 1947, -1554460.0185930082 356191.57554655895 1946, -1554467.9931780605 356205.0421863543 1943, -1554471.2333639348 356213.60498581175 1941, -1554472.0618130378 356220.2875220487 1940, -1554472.7414311306 356226.915145766 1938, -1554473.3006933623 356234.5087050544 1936, -1554471.7739676614 356241.34686899744 1934, -1554469.5578928362 356253.310528039 1931, -1554466.6296849106 356261.82577100396 1929, -1554465.1038484825 356268.66438084 1927, -1554463.4897403207 356273.2883800464 1926, -1554461.4884403637 356278.94675561134 1925, -1554459.4866865024 356284.60601755325 1923, -1554457.96085198 356291.4446202619 1922, -1554455.9582118469 356297.10342460126 1921, -1554452.8820665022 356305.5641935775 1918, -1554452.1913779986 356310.6901111463 1917, -1554450.3968146313 356318.4388405783 1915, -1554449.288110957 356324.42086690944 1914, -1554450.3857457407 356330.19235061295 1914, -1554449.6994322585 356331.95993846096 1914)",
				"LINESTRING (-1554577.0868036193 357881.53003982455 2154, -1554570.3986611236 357858.9529324593 2150, -1554566.1136742458 357850.01243130676 2149, -1554563.2894389797 357840.5917890882 2147, -1554559.8983511438 357831.97451538406 2146, -1554559.2504422546 357822.1655907715 2145, -1554558.6016457013 357812.3562082378 2143, -1554556.252849722 357804.115727447 2142, -1554553.011037084 357795.5524677187 2141, -1554551.0507632014 357786.2772411341 2140, -1554551.8016794336 357778.1503929971 2139, -1554548.8049674062 357760.1009568684 2138, -1554545.532781683 357751.3585433988 2137, -1554542.7972299585 357744.1536992602 2136, -1554539.587501981 357732.41006076895 2135, -1554538.0127023913 357725.4577813782 2133, -1554534.5658835182 357711.4447379615 2128, -1554533.1114149152 357703.52880453225 2125, -1554532.2825799945 357696.84529271163 2123, -1554530.5584977977 357689.83898209035 2119, -1554526.691945379 357680.04149385635 2118, -1554523.181392015 357672.3882850036 2118, -1554522.1466473974 357660.256768208 2117, -1554521.4666354088 357653.6281577321 2117, -1554520.0117292893 357645.7108671414 2108, -1554518.0822633773 357636.61385060847 2105, -1554514.691149925 357627.9965258101 2102, -1554509.00729357 357617.3738710899 2098, -1554504.0667950616 357610.3790544225 2094, -1554502.1065012906 357601.10377352126 2091, -1554500.800869969 357593.24049344286 2088, -1554499.7344821154 357584.28843739163 2079, -1554499.5593939237 357579.01867916714 2078, -1554499.7723972297 357572.71282645315 2076, -1554498.0496460882 357565.70605532266 2074, -1554498.1133687228 357559.346176276 2066, -1554499.8744895435 357554.77644203044 2065, -1554502.2638340888 357548.08229099493 2064, -1554504.950498768 357540.6562860403 2057, -1554508.262347347 357534.46359578054 2056, -1554513.1244692674 357526.64883888233 2053, -1554516.643929625 357522.5468689259 2052, -1554520.5805100296 357517.588379262 2050, -1554524.5170914591 357512.62988835573 2048, -1554529.4095877411 357504.9942667121 2046, -1554535.1331028652 357500.6817800151 2044, -1554540.1128779878 357496.1005390873 2042, -1554543.2758880241 357489.8551537981 2040, -1554547.6005688743 357483.8605580721 2038, -1554551.8058842341 357477.99196917657 2036, -1554556.3685438624 357474.26724378206 2034, -1554559.680406093 357468.07453282457 2032, -1554561.2922570056 357463.4507545419 2031, -1554564.7859277942 357454.1330059571 2028, -1554566.7863070809 357448.47446708754 2026, -1554570.068691965 357442.10305827204 2024, -1554572.099007959 357436.62231843267 2022, -1554572.9692772776 357428.3715735134 2020, -1554574.0762023472 357422.3889082931 2018, -1554574.5900383594 357411.9925119877 2016, -1554575.460762919 357403.74087066203 2014, -1554575.0485938562 357396.2016426753 2012, -1554576.15640718 357390.219423539 2010, -1554575.8324999132 357384.894708314 2009, -1554576.7027706306 357376.64394556824 2007, -1554576.2910557636 357369.10382169764 2005, -1554576.1159749455 357363.8340133587 2004, -1554572.8451022122 357355.0910432115 2002, -1554567.904125018 357348.0970483357 2000, -1554564.6306376006 357342.71318000834 1998, -1554560.4337555557 357336.82738908567 1997, -1554556.6545280986 357329.2460742835 1995, -1554550.7027969698 357319.5338580832 1992, -1554547.0733021928 357312.0056762025 1991, -1554542.876415181 357306.1198828053 1989, -1554535.730479645 357299.33594940417 1987, -1554531.4137900602 357293.5748233637 1986, -1554526.5917131382 357286.455701652 1985, -1554523.1698225255 357281.0182598494 1984, -1554519.2711384906 357274.4010585882 1982, -1554514.987421077 357265.45996400993 1981, -1554511.0592531525 357258.66406979505 1980, -1554508.8922173376 357247.2983772075 1978, -1554508.0629126783 357240.6156411227 1977, -1554505.478753498 357230.10647185333 1976, -1554502.8629592995 357222.7768378621 1975, -1554498.964267133 357216.15962799545 1974, -1554492.4751330435 357207.42947956733 1973, -1554488.5469566032 357200.6335768346 1972, -1554484.2311392084 357194.8728963351 1971, -1554478.1591207855 357185.2862142613 1969, -1554471.194525433 357175.3758678166 1968, -1554467.535524254 357167.6689727949 1967, -1554464.7116514647 357158.2494650679 1966, -1554458.8476931946 357150.7526414953 1965, -1554454.9489886758 357144.13542411383 1964, -1554451.2895277496 357136.4294119552 1964, -1554446.1118664588 357127.1650621155 1963, -1554440.6975384827 357115.63260684535 1963, -1554440.6422391192 357110.2380880993 1963, -1554442.0178772812 357103.3452478424 1962, -1554444.0195945154 357097.68619257584 1962, -1554446.0204249811 357092.02668149583 1962, -1554449.3327283706 357085.83520443924 1962, -1554453.8945282472 357082.10993861314 1962, -1554465.9985274645 357074.8990226295 1962, -1554471.4542489462 357071.4969845321 1962, -1554473.603912351 357065.8923765607 1962, -1554485.0207294468 357060.4485316938 1962, -1554489.8816331623 357055.9923024727 1962, -1554490.2697286655 357054.9561851267 1962, -1554492.540182997 357048.387009453 1962, -1554492.397176049 357039.936693104 1962, -1554487.3388555383 357030.5485241851 1962, -1554476.919344351 357018.3806475643 1961, -1554471.7095868292 357012.296709165 1961, -1554471.7737359472 357005.93803542014 1961, -1554473.0629096103 356996.82929453906 1960, -1554477.0650209966 356985.5115597956 1960, -1554479.0662939227 356979.85336124804 1959, -1554481.2164170223 356974.2478420753 1959, -1554483.0978902527 356968.7143103946 1959, -1554484.862522821 356960.78575848415 1958, -1554487.281375915 356954.2701244438 1958, -1554487.4952641297 356947.9645699393 1957, -1554486.429739441 356939.01275225356 1957, -1554486.0184345616 356931.47385339346 1956, -1554486.0830398884 356925.1142701814 1956, -1554485.9409175948 356916.66436812095 1955, -1554485.8856226604 356911.26980371494 1954, -1554486.1315968083 356901.78377267905 1953, -1554487.1200387795 356895.9274474727 1953, -1554479.4365697892 356890.96368336584 1952, -1554474.938463169 356888.3289430542 1951, -1554467.4591179925 356888.8146606181 1950, -1554457.4200539386 356884.007395844 1949, -1554452.6282881098 356877.06734901574 1948, -1554448.3124328228 356871.3066206388 1947, -1554444.8900448023 356865.8700088421 1946, -1554443.1667979606 356858.8639548505 1944, -1554441.8325336657 356850.82222719025 1943, -1554441.4221069245 356843.28376204707 1942, -1554440.5927818595 356836.60093171336 1940, -1554439.5567261162 356827.8277770337 1939, -1554438.4595598336 356822.05551206414 1938, -1554438.0482447264 356814.5165846199 1936, -1554436.5950640813 356806.5999697298 1935, -1554435.7657373585 356799.9171306966 1934, -1554434.4613844336 356792.0554226376 1934, -1554432.5019194663 356782.7803313136 1933, -1554429.260887223 356774.21725058556 1932, -1554421.9102612326 356761.98464080226 1932, -1554416.7013529658 356755.90112417843 1931, -1554413.4278024563 356750.51717832405 1931, -1554408.4867321549 356743.52308944985 1930, -1554404.5910122492 356733.54796126764 1930, -1554404.1805771305 356726.0094662141 1930, -1554403.769708938 356718.46962683555 1930, -1554405.1167558597 356711.3984350441 1930, -1554404.7054331535 356703.8594791787 1929, -1554404.025382533 356697.2306405809 1929, -1554402.5721911672 356689.3139962368 1929, -1554400.2246181525 356681.07500958815 1928, -1554394.153395055 356671.4886527099 1928, -1554389.8375122068 356665.7278996436 1927, -1554384.3585193441 356660.554927174 1927, -1554378.494912199 356653.05935729947 1926, -1554374.8028841785 356648.5323859127 1926, -1554369.5939568512 356642.44885903876 1924, -1554362.897522081 356631.629149531 1922, -1554357.1823045167 356624.18714643177 1919, -1554353.13513997 356617.5162693281 1916, -1554347.68910049 356609.1632549837 1914, -1554342.8678061853 356602.0444771601 1913, -1554337.6575280682 356595.9613819616 1911, -1554333.3411772395 356590.20151333977 1910, -1554326.551118399 356585.5618696697 1908, -1554317.4687826121 356578.0778449802 1906, -1554313.9260271925 356573.60489467625 1903, -1554308.298619827 356568.3783556456 1901, -1554303.713537114 356563.5286111105 1900, -1554298.739471939 356559.7145512663 1898, -1554295.436843935 356554.1532360539 1897, -1554290.2595131686 356544.89009382017 1895, -1554285.943606707 356539.12933648564 1894, -1554282.2519943768 356534.6037051417 1893, -1554281.0020407157 356532.1361162467 1892)",
				"LINESTRING (-1554014.122386159 356444.3378633345, -1554010.7214891056 356445.2461432464)",
				"LINESTRING (-1553952.3147515552 356177.4952856108, -1553938.9352319632 356195.4673221937, -1553933.3110744786 356203.98486228875, -1553930.1724006175 356208.0220046371, -1553921.965830108 356217.62443128554, -1553910.6934061965 356229.143679723, -1553891.6519413786 356250.1758195887, -1553892.206949219 356264.12827928487)",
				"LINESTRING (-1554279.016466205 356484.72317522764, -1554258.3741086812 356509.0584245891)",
				"LINESTRING (-1554258.3741086812 356509.0584245891, -1554240.7596776015 356509.4324575067, -1554226.4666137984 356512.9306088113, -1554220.769975517 356510.4232490119, -1554214.535746502 356506.9686487984)",
				"LINESTRING (-1553952.3147515552 356177.4952856108, -1553957.020477251 356178.3549423617, -1553982.9363995017 356189.52528864134, -1553991.072072546 356194.58505611407, -1553997.434329756 356200.8353182029)",
				"LINESTRING (-1554605.534798794 356323.48938379716 1927, -1554604.2518726462 356324.20184923057 1925, -1554597.0107844907 356323.59833291266 1925, -1554589.6182554485 356326.2991471486 1924, -1554580.169125671 356329.26363320183 1923, -1554566.8465794516 356330.82760081254 1922, -1554560.4994282955 356330.54732071236 1921, -1554550.6938360867 356331.36830817163 1920, -1554543.4527517012 356330.7647988796 1919, -1554536.4773609105 356332.6090508718 1919, -1554527.0607613414 356332.394345223 1918, -1554517.2586654057 356329.85655585397 1917, -1554508.7360007719 356329.9650842948 1917, -1554501.2552139233 356330.45130094513 1916, -1554493.6264846902 356330.8830618281 1916, -1554483.791417157 356331.5253633354 1916, -1554477.2045664971 356332.33481275104 1915, -1554468.057156978 356331.2090952657 1915, -1554461.2340923494 356329.7494862629 1914, -1554455.1526438834 356331.91697605886 1914, -1554449.6994322585 356331.95993846096 1914)",
				"LINESTRING (-1554281.0020407157 356532.1361162467, -1554276.826962385 356526.9573415338, -1554268.954263941 356518.442962838, -1554262.0440789163 356511.60932239465, -1554258.3741086812 356509.0584245891)",
				"LINESTRING (-1553892.206949219 356264.12827928487, -1553912.9118919782 356264.17333521275)" };

		Coordinate sink = new Coordinate(-1552659.2137229564, 356154.1955488585);
		directionalize(edges, sink);
	}

	@Test
	public void loop4Test() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1592191.6195902217 335995.72008429276, -1592182.344248495 335980.2773192192, -1592165.892118767 335948.5253959679, -1592166.3474490088 335930.1865872812, -1592168.9952947705 335893.167960704, -1592150.7218593974 335858.14554181416, -1592149.117720815 335854.18659131083, -1592146.9384362046 335845.49065390974, -1592145.9497972182 335840.23171994573, -1592145.2245590098 335833.1815692246, -1592144.7378864794 335823.936716488, -1592144.8367978006 335816.6291995347, -1592145.9420580969 335804.93483384827, -1592148.606380764 335791.92498018366)",
				"LINESTRING (-1592338.6285580928 335592.73883808765, -1592331.0485904755 335585.59966949763, -1592321.1076260363 335574.81489078264, -1592307.023369889 335568.0446140953, -1592264.5586641843 335568.72905559995, -1592257.8800214329 335569.42966437316, -1592241.216270578 335572.157717444, -1592237.277610807 335573.95265273197, -1592231.3766228408 335577.43514224037, -1592220.4411009748 335585.5296986588)",
				"LINESTRING (-1592506.5264048746 335603.2416659426, -1592476.5331862697 335598.97787768365, -1592468.5637179194 335599.3474831463, -1592445.8534002933 335603.034281449, -1592424.4912316566 335603.92872358544, -1592408.3180145435 335604.0919913871, -1592386.5238322471 335602.3491972935, -1592371.7432596604 335602.703157953, -1592364.1769282839 335599.3058180589, -1592357.2936095996 335597.0017707691, -1592349.5049804 335594.92901194416, -1592338.6285580928 335592.73883808765)",
				"LINESTRING (-1592191.6195902217 335995.72008429276, -1592157.514696775 336054.0813728671, -1592148.5563262915 336072.8990917176, -1592146.4954187707 336083.0862800737, -1592134.8396686446 336103.4248591118, -1592125.3244855416 336118.74285605573, -1592116.84907919 336134.59628985997, -1592110.939568352 336143.7568290854, -1592108.6780083273 336153.8740410757, -1592110.8976880587 336202.48130229086, -1592106.163746562 336209.409111125, -1592100.5781268985 336216.1223759202, -1592094.5670286184 336221.9349225454, -1592088.7345313297 336226.2172878579, -1592083.6635097065 336229.19789528113, -1592061.5291657394 336239.25418110925, -1592060.0803902897 336238.77184558864, -1592033.7405472903 336252.3875646135)",
				"LINESTRING (-1592148.606380764 335791.92498018366, -1592142.274796458 335779.5377418997, -1592136.3733927065 335766.03315222764, -1592127.0618338767 335736.72974099795, -1592112.3151026096 335698.57719177974, -1592116.2410614295 335691.5605694203, -1592119.3666032045 335687.29312837205, -1592125.617457769 335668.14371012436, -1592128.9857200393 335660.92144001013, -1592134.285780118 335654.218643123, -1592139.9445156713 335647.92477749044, -1592154.0822924164 335635.1412400646, -1592164.4131715782 335625.0799906595, -1592174.3324909233 335617.215075114, -1592183.3968384815 335611.05532155174, -1592186.778794757 335609.42505387816, -1592191.6269976979 335607.3168050342, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592220.4411009748 335585.5296986588, -1592209.6614223358 335595.31342698634, -1592205.529090865 335599.74846181984, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592225.5002514354 335631.75421267434, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592752.5608748447 335391.84881301766, -1592748.9309571916 335392.9766489282, -1592734.9697623372 335401.84539500525, -1592714.9897471159 335415.5208388956, -1592702.920404009 335425.6498614436, -1592673.5609105062 335447.26474758494, -1592653.5951558503 335460.1771509302, -1592636.0486126824 335475.6115275554, -1592610.6648957608 335494.8790914479, -1592605.3780432027 335501.70882642956, -1592593.584968725 335518.54077203636, -1592567.9476473473 335548.398068443, -1592551.9237217726 335563.7265223983, -1592540.492585423 335575.6324310686, -1592531.9101886572 335583.57249186694, -1592525.5715285137 335588.8453062493, -1592514.8842891245 335596.44270034856, -1592506.5264048746 335603.2416659426)",
				"LINESTRING (-1592338.6285580928 335592.73883808765, -1592328.5469935983 335615.6041702009, -1592318.6315192324 335635.4678592637, -1592314.6596180866 335642.20818965766, -1592310.1592851488 335648.0027400696, -1592300.0704743264 335658.456927459, -1592292.1732077543 335665.24282903434, -1592287.774761278 335668.32909456594, -1592280.9404525748 335667.6104513103, -1592270.791974119 335665.8486198478, -1592267.6754299274 335664.7922491382, -1592258.927554059 335660.53715970676, -1592242.2805415748 335647.69293117785, -1592225.5002514354 335631.75421267434)",
				"LINESTRING (-1592506.5264048746 335603.2416659426, -1592508.9467640086 335616.03010863316, -1592510.0978405918 335627.9700100813, -1592507.0991015162 335647.42827673274, -1592504.4035051372 335657.83598273806, -1592500.6480021689 335667.02023238904, -1592495.4827293134 335676.03998902923, -1592481.228233391 335703.5092645861, -1592475.8699367165 335726.4553943735, -1592467.4680200478 335751.9383158782, -1592453.651774602 335784.0835534352, -1592443.545892203 335811.4163730806, -1592436.6345024158 335826.7987076126, -1592428.044761621 335844.0648545034, -1592423.430799884 335851.2151842614, -1592419.5317406387 335855.9413050704, -1592407.8688048513 335867.69198115857, -1592392.963544254 335879.71450695273, -1592380.5670546265 335891.5377633538, -1592365.5574403661 335904.0183899148, -1592352.256624691 335917.04005772434, -1592346.6197662866 335921.22805951233, -1592341.666439842 335923.82122878515, -1592339.4296822313 335924.3952003421, -1592322.3766728933 335928.1578755687, -1592302.6911833936 335930.44305566646, -1592294.3874378097 335932.6998335664, -1592289.270325759 335934.969249683, -1592272.2083017803 335943.49852158653, -1592265.0636379512 335947.5804054516, -1592260.3586028728 335950.7094502826, -1592248.1433318187 335960.10982078075, -1592222.324076108 335977.8900868832, -1592201.5383319266 335990.6036682818, -1592192.8367294872 335995.4581684367, -1592191.6195902217 335995.72008429276)", };

		Coordinate sink = new Coordinate(-1592752.5608748447, 335391.84881301766);
		directionalize(edges, sink);
	}

	@Test
	public void loop2Test() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1519331.268716602 258846.29881226402, -1519335.2552519934 258834.0006234433, -1519336.6999304902 258830.86422490882, -1519339.820397547 258825.85293465288, -1519347.4403120603 258817.61231693323, -1519355.4755618197 258810.42934973966, -1519369.8732177569 258802.00281496215, -1519385.1371764585 258794.91161588297, -1519390.9074332644 258792.95630623773, -1519397.5522149832 258791.42966638875, -1519408.642318669 258789.7821434724, -1519417.6789620144 258787.96565179786, -1519419.7229862812 258787.97302749677, -1519432.4448955937 258790.1176757068, -1519440.7988194253 258793.72818202505, -1519458.416726517 258804.216010008, -1519477.6868013535 258820.34389467444, -1519479.3293820613 258822.29545982752, -1519488.1899097026 258837.30499237883, -1519493.1445235389 258844.58043193692, -1519501.243892548 258854.8550824907, -1519512.950948958 258867.57716718162, -1519516.103779827 258870.3267609165, -1519527.8479765388 258878.4455591865, -1519534.085281963 258883.24133090573, -1519537.170669943 258884.9674115673, -1519544.5803527867 258888.5928613888, -1519553.8470699284 258892.4828449542, -1519577.1395492153 258899.671727904, -1519580.5544700564 258901.0271300832, -1519587.109247008 258904.5234805222, -1519591.6754268692 258907.76243620866)",
				"LINESTRING (-1518739.1941588 258733.06601408962 901, -1518740.580864498 258735.55540377833 901, -1518747.6127452054 258742.3417233508 900, -1518753.4892908798 258749.90160717163 899, -1518759.9571051914 258758.50289965048 898, -1518765.3733658453 258766.74158663675 897, -1518770.3493470924 258773.99009446055 896, -1518775.7656042413 258782.22877948266 895, -1518780.6448262439 258792.46033032145 894, -1518785.5245006576 258802.69098668452 892, -1518790.6868668522 258812.0150562264 891, -1518794.3011110285 258819.63053221535 890, -1518796.6108084463 258827.96924373973 889, -1518797.7372535863 258836.90316169616 888, -1518797.8659292297 258848.50963215902 887, -1518798.1551545504 258859.33261243626 885, -1518797.8798621416 258871.97144348174 884, -1518796.9858175577 258883.39185780007 882, -1518796.4966501845 258893.77811220754 881, -1518796.2901765057 258903.25778148323 880, -1518796.3659613868 258911.82952086907 879, -1518796.84662273 258919.36710430868 878, -1518796.3570012632 258929.7542345561 877, -1518796.8531349234 258931.0988694951 871, -1518798.117668011 258933.713580898 871, -1518798.4528171963 258935.84035156388 871, -1518802.0145941046 258940.4224464083 870, -1518807.2995587455 258949.62024864368 868, -1518811.629278012 258955.47331056464 867, -1518816.860005637 258961.63685510028 866, -1518823.3965983759 258967.0789697226 865, -1518828.1940728473 258974.09920692537 863, -1518833.857592574 258979.40695043094 862, -1518840.6759858313 258983.94203448202 861, -1518847.4948325872 258988.47622747533 860, -1518855.6470288977 258992.46599687077 859, -1518862.8982155689 258996.14528375398 858, -1518870.4321156347 258998.91575691942 858, -1518877.0366331497 259001.19828943536 857, -1518885.4706316972 259004.28103318997 856, -1518894.9278017108 259007.54892854393 856, -1518904.9503812827 259009.00143446214 855, -1518912.2699554653 259009.52024969738 855, -1518919.1576216144 259010.8953197254 854, -1518926.477196177 259011.4141370682 854, -1518936.9321200433 259012.0117418114 854, -1518944.5348460858 259011.6230927864 853, -1518951.8269380685 259011.96490991116 853, -1518961.2307728373 259012.19901845045 852, -1518970.1384802975 259011.0884928517 851, -1518978.427897175 259008.7586667398 850, -1518984.7661055038 259005.75530693494 849, -1518993.742649297 259001.48564515263 847, -1519002.383167023 258995.08875598758 846, -1519010.4596164557 258990.50682188012 846, -1519023.1360477363 258984.50009857863 845, -1519029.5968840374 258981.37051000353 844, -1519036.0847504868 258978.41881731804 844, -1519043.110552095 258973.4747235151 843, -1519049.731037802 258969.563434924 843, -1519056.0059361635 258964.35962891113 843, -1519061.0792069687 258958.74019422196 842, -1519066.9221965245 258954.39264208265 842, -1519079.1709310468 258943.8807730507 842, -1519085.3236737614 258938.80229517072 841, -1519092.0663357382 258934.76566515863 841, -1519100.4255128698 258929.27713767625 840, -1519107.7335996646 258923.42510412727 840, -1519115.8100812254 258918.84315610025 839, -1519122.8350171924 258913.89859410096 839, -1519130.5066173717 258910.35080020688 839, -1519136.967024128 258907.22209439147 838, -1519143.0922990127 258901.9666024372 838, -1519147.9116980652 258897.4325380223 837, -1519154.0360868059 258892.1765893111 837, -1519160.7796560791 258888.14040520787 836, -1519167.4001724578 258884.22910171095 836, -1519174.575660713 258879.3366558794 836, -1519181.6015029952 258874.39253892563 835, -1519188.6264578498 258869.44796674605 835, -1519195.8028418005 258864.5559716532 835, -1519202.2104015958 258858.39253692422 834, -1519208.3348054737 258853.1365779573 834, -1519217.312310316 258848.86734516732 834, -1519224.984390786 258845.31865056884 833, -1519230.8265312773 258840.97062086873 833, -1519237.8523897692 258836.02649509814 832, -1519244.623463337 258832.1673071403 832, -1519251.5791294663 258830.38279036526 832, -1519256.0469755535 258829.916708244 832, -1519259.4366983983 258828.90922013484 832, -1519267.657313784 258829.7407993339 831, -1519273.3896726929 258831.8894675579 831, -1519276.241883476 258832.87574489787 831, -1519284.6475428604 258835.78110754862 830, -1519293.0815736467 258838.86393191386 830, -1519301.020372429 258840.60255845264 829, -1519308.5538447662 258843.37400094327 829, -1519316.059834218 258845.96843867842 826)",
				"LINESTRING (-1519220.91189513 259364.32784602777, -1519232.257305153 259358.16806090245, -1519280.8529403626 259334.11151738814, -1519293.6519827498 259324.9189800242, -1519301.9027757326 259317.74615059837, -1519309.3497857763 259312.5971402468, -1519316.8269339348 259304.97166744407, -1519321.6536076292 259294.97997071885, -1519325.058985514 259286.67414812633, -1519334.9207091336 259269.0150396865, -1519338.1672176996 259261.8981143841, -1519342.073634194 259251.17495032924, -1519352.4090823855 259219.384804027, -1519355.0376331625 259208.82068402786, -1519355.6807413728 259194.89680367828, -1519356.9674700527 259180.8174371974, -1519357.0115272065 259170.55588854387, -1519354.2364553157 259146.52703116773, -1519352.7697346357 259138.8742370983, -1519349.8608669469 259116.76184263988, -1519349.722365466 259095.4134763969, -1519350.3834491614 259083.06753349374, -1519351.596355708 259071.02673977768, -1519353.2061333444 259064.95793208096, -1519357.805634171 259052.57870665507)",
				"LINESTRING (-1519316.059834218 258845.96843867842, -1519331.268716602 258846.29881226402)",
				"LINESTRING (-1519591.6754268692 258907.76243620866, -1519583.5826383405 258922.3449783868, -1519579.379937267 258926.7855031316, -1519574.6648871072 258930.4126656392, -1519555.2582692297 258944.28514372645, -1519531.9121875651 258959.26091815313, -1519523.9266159765 258963.66446240648, -1519505.3897563324 258976.0068584837, -1519477.2186474646 258990.69980418825, -1519471.212148303 258993.52309110848, -1519460.1143141345 258997.73965143855, -1519457.7375255374 259002.26133072018, -1519454.0118869958 259007.23284147025, -1519451.8495777561 259009.32759566192, -1519438.3354543615 259018.44159410405, -1519427.2133115923 259027.0057534467, -1519419.8260480422 259033.4450888622, -1519403.8937502012 259043.75600723602, -1519399.3192345994 259045.44446810643, -1519392.542760235 259046.5396080364, -1519368.3484889013 259049.00797175354, -1519357.805634171 259052.57870665507)",
				"LINESTRING (-1519887.1828888343 258878.37548303467, -1519863.1453262498 258881.5723101036, -1519840.0893588648 258881.21282531548, -1519829.6359562252 258881.6976422283, -1519799.6562021829 258880.5461106128, -1519775.2030706122 258878.70655099984, -1519757.4528961256 258878.432724694, -1519732.5603439654 258880.40166239045, -1519719.1613459475 258880.80856606693, -1519703.7366637217 258882.81656122004, -1519696.7882013922 258884.19814672443, -1519680.9776097313 258885.91331183643)",
				"LINESTRING (-1519334.5527168238 258928.64576566324, -1519337.8551694837 258953.06311745028, -1519339.1379336056 258978.01675100575, -1519341.703711786 259002.2381923713, -1519343.995899618 259016.7207601964, -1519345.0186406397 259030.0279192945, -1519346.766811583 259036.43759517604, -1519349.2719892426 259041.70996904076, -1519352.7283650811 259046.81829699094, -1519357.805634171 259052.57870665507)",
				"LINESTRING (-1519331.268716602 258846.29881226402, -1519330.5397125788 258854.2400100489, -1519331.3043655304 258874.356856845, -1519331.181120315 258883.74396674405, -1519331.7247494995 258894.52696925608, -1519334.5527168238 258928.64576566324)",
				"LINESTRING (-1519591.6754268692 258907.76243620866, -1519605.8341646427 258903.97932646814, -1519632.7877621562 258897.95802296893, -1519653.7315678848 258892.7306898363, -1519671.5333711535 258887.81128601037, -1519680.9776097313 258885.91331183643)", };
		Coordinate sink = new Coordinate(-1519887.1828888343, 258878.37548303467);
		directionalize(edges, sink);
	}

	@Test
	public void simpleTest() throws Exception {

		String[] edges = new String[] {
				"LINESTRING (-73.15328463933459 45.54434237238221, -73.15328809833301 45.544290086780165, -73.15323508631288 45.54381524730181, -73.1531974077247 45.54345775274076, -73.15317279424471 45.54318688591405, -73.153486 45.5420309)",
				"LINESTRING (-73.1491125 45.5431244, -73.14942931909866 45.54468807011558)",
				"LINESTRING (-73.15449143198734 45.54398966188659, -73.15426468900314 45.54401319467915, -73.15413824782006 45.544028983493725, -73.15410595357483 45.54403619512957, -73.15384317759876 45.5441319442946, -73.15362382277513 45.544216341461976, -73.15328463933459 45.54434237238221)",
				"LINESTRING (-73.1565179 45.5446226, -73.15646393095983 45.544522306947925, -73.1563512208263 45.544500963199496, -73.15613853409046 45.544472486499664, -73.15602110087515 45.54444813971366, -73.155963843444 45.544434301852455, -73.15577927320355 45.54441623546854, -73.15574256446722 45.54441030293186, -73.15567762796307 45.544395769427524, -73.15557433413223 45.54432940568481, -73.15549588027112 45.54427393273803, -73.1552689216986 45.54418474270723, -73.15514196225435 45.54413035483615, -73.1550380802485 45.54408838511583, -73.15464194096059 45.54401442867892, -73.15449143198734 45.54398966188659)",
				"LINESTRING (-73.1451483 45.544273, -73.1453104612229 45.54444326934901, -73.1453632652145 45.54442785976631, -73.14550966025875 45.54442134702657, -73.1455482325203 45.54442554140257, -73.14560341792483 45.54443491995271, -73.14567918530994 45.54443693718577, -73.14569908129606 45.544438651482984, -73.14572831084462 45.54444430502913, -73.14577690903216 45.54445535457252, -73.14588394259232 45.54450510391952, -73.14596375548466 45.54454869508024, -73.14598186447243 45.5445554023759, -73.14615397395559 45.54459602407243, -73.14625440246607 45.544621565055834, -73.14633792281971 45.54464647005172, -73.14642621939934 45.544670527888435, -73.1464918822875 45.54469374416239, -73.14652646180329 45.544704326195976, -73.14663713768824 45.544728273224, -73.14671537013817 45.54473721860897, -73.14678350852863 45.54474244737605, -73.14685589095465 45.544746243509074, -73.14689961940809 45.54474489446988, -73.14703030783828 45.544734616244185, -73.14722098599535 45.54471569713162, -73.14728483936302 45.54471285877576, -73.14737982166811 45.544712043746394, -73.14741707098898 45.54470229580627, -73.14760968055126 45.54466702772674)",
				"LINESTRING (-73.15328463933459 45.54434237238221, -73.15310196293346 45.544533790555825)",
				"LINESTRING (-73.14942931909866 45.54468807011558, -73.14933488008113 45.54467374857307, -73.14915276890555 45.54463796690407, -73.1489998687983 45.54459570778474, -73.1488687655396 45.5445845085075, -73.14855798781394 45.544548416197955, -73.14845349964239 45.54454157110391, -73.14840987104272 45.54453353317556, -73.14825013763773 45.544575799739825, -73.14811105768229 45.54460906183861, -73.1480359203133 45.544625034795004, -73.14789831582429 45.54464023434295, -73.14760968055126 45.54466702772674)",
				"LINESTRING (-73.1519815824733 45.54494551799351, -73.15208956103893 45.54491457774376, -73.15222672677321 45.54486771253815, -73.15256689021578 45.54473856619745, -73.15288559433705 45.544603531611116, -73.15300611965827 45.54456636532857, -73.15310196293346 45.544533790555825)",
				"LINESTRING (-73.14942931909866 45.54468807011558, -73.14951031787712 45.544700544082716)",
				"LINESTRING (-73.15158562321348 45.545123213171316, -73.15145077274273 45.54508204592838, -73.1512278086057 45.54502014497314, -73.15106401134847 45.54497279375422, -73.15079455922023 45.54491582847549, -73.15058431991135 45.5448682662435, -73.15040813639862 45.5448467883451, -73.15022215928215 45.544820165495224, -73.15001122261597 45.54478619197667, -73.14984649828806 45.54475291514514, -73.14980517870039 45.54474771856242, -73.14962510216377 45.5447177481549, -73.14951031787712 45.544700544082716)",
				"LINESTRING (-73.15158562321348 45.545123213171316, -73.1517553356116 45.54504546762222, -73.1519815824733 45.54494551799351)",
				"LINESTRING (-73.1519089 45.548568, -73.15194087497179 45.548444017971505, -73.15192654528501 45.54840644020434, -73.15192171695773 45.548380727516545, -73.15192358425003 45.54830298621434, -73.15193288996205 45.54820819064991, -73.15193286712432 45.5481414038083, -73.15194527055394 45.54807187308011, -73.1519512478404 45.54801818393341, -73.15196203639906 45.5479529501925, -73.15196664679151 45.547911287176575, -73.15196634264287 45.54785275546219, -73.15195887998804 45.54771032118352, -73.15195372120823 45.54764600391057, -73.15194720353176 45.54759095718655, -73.15193482428626 45.54752123385391, -73.15191928733397 45.54744810618745, -73.15185160793486 45.547171131262296, -73.15182104917298 45.547074292189855, -73.15178694304763 45.54697482018366, -73.15176335760144 45.54687996150825, -73.15171459366972 45.546699212772644, -73.15159872985843 45.54628738127399, -73.15154700847582 45.54612309389745, -73.15147950209197 45.54592245567217, -73.15149832950563 45.54576031346462, -73.15153115165768 45.545503869704994, -73.15158562321348 45.545123213171316)",

		};

		Coordinate sink = new Coordinate(-73.153486, 45.5420309);
		directionalize(edges, sink);
	}

	@Test
	public void looptest() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-73.15353649672267 45.54533108445293, -73.15509980244569 45.546112737314445, -73.15484426208712 45.54755578875108)",
				"LINESTRING (-73.1567833624551 45.54705973981974, -73.1568585213841 45.54990074733562)",
				"LINESTRING (-73.15272478028956 45.54488013087899, -73.15353649672267 45.54533108445293)",
				"LINESTRING (-73.15615202745158 45.54863807732856, -73.15568604209183 45.54838253696999)",
				"LINESTRING (-73.157835587461 45.54678916767537, -73.1567833624551 45.54705973981974)",
				"LINESTRING (-73.14992886813107 45.54988571554982, -73.14907205634057 45.54991577912142)",
				"LINESTRING (-73.15792577817578 45.55003603340781, -73.1568585213841 45.54990074733562)",
				"LINESTRING (-73.15568604209183 45.54838253696999, -73.15529521566107 45.54806686946823)",
				"LINESTRING (-73.14973345491569 45.550396796266966, -73.14992886813107 45.54988571554982)",
				"LINESTRING (-73.15529521566107 45.54806686946823, -73.15484426208712 45.54755578875108)",
				"LINESTRING (-73.15272478028956 45.54488013087899, -73.15183790492746 45.54480497194999)",
				"LINESTRING (-73.15449853101376 45.5482773144694, -73.15484426208712 45.54755578875108)",
				"LINESTRING (-73.15427305422679 45.55017131947999, -73.15237904921621 45.54969030233445)",
				"LINESTRING (-73.14659181168385 45.543737715158315, -73.15010924956066 45.54512063945176)",
				"LINESTRING (-73.1496733277725 45.547976678753436, -73.15295025707654 45.549224316974694)",
				"LINESTRING (-73.15449853101376 45.5482773144694, -73.15218363600083 45.54692445374756, -73.15183790492746 45.54480497194999)",
				"LINESTRING (-73.15264962136057 45.54838253696999, -73.15382210065285 45.548893617687135)",
				"LINESTRING (-73.154182863512 45.550727495554526, -73.15427305422679 45.55017131947999)",
				"LINESTRING (-73.15382210065285 45.548893617687135, -73.15295025707654 45.549224316974694)",
				"LINESTRING (-73.15449853101376 45.5482773144694, -73.15382210065285 45.548893617687135)",
				"LINESTRING (-73.1567833624551 45.54705973981974, -73.15529521566107 45.54806686946823)",
				"LINESTRING (-73.15555075601965 45.549239348760494, -73.15573113744922 45.55000596983621)",
				"LINESTRING (-73.15077064813578 45.54990074733562, -73.15071052099259 45.55042685983856)",
				"LINESTRING (-73.15237904921621 45.54969030233445, -73.15077064813578 45.54990074733562)",
				"LINESTRING (-73.1496733277725 45.547976678753436, -73.15010924956066 45.54512063945176)",
				"LINESTRING (-73.15295025707654 45.549224316974694, -73.15237904921621 45.54969030233445)",
				"LINESTRING (-73.15010924956066 45.54512063945176, -73.15183790492746 45.54480497194999)",
				"LINESTRING (-73.15194312742805 45.54161823336075, -73.15183790492746 45.54480497194999)",
				"LINESTRING (-73.15311560672032 45.546112737314445, -73.15353649672267 45.54533108445293)",
				"LINESTRING (-73.1568585213841 45.54990074733562, -73.15573113744922 45.55000596983621)",
				"LINESTRING (-73.15573113744922 45.55000596983621, -73.15427305422679 45.55017131947999)",
				"LINESTRING (-73.15077064813578 45.54990074733562, -73.14992886813107 45.54988571554982)",
				"LINESTRING (-73.14829040347905 45.54884852232974, -73.1496733277725 45.547976678753436)", };

		Coordinate sink = new Coordinate(-73.14907205634057, 45.54991577912142);
		Coordinate sink2 = new Coordinate(-73.15071052099259, 45.55042685983856);
		ArrayList<Coordinate> sinks = new ArrayList<>();
		sinks.add(sink);
		sinks.add(sink2);
		
		for (String s : edges) System.out.println(s);
		System.out.println("---");
		
		DGraph graph = makeGraph(edges);
		Directionalizer dd = new Directionalizer();
		dd.directionalize(graph, sinks);

		printEdges(graph);
	}

	@Test
	public void looptest2() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1592338.6285580928 335592.73883808765, -1592331.0485904755 335585.59966949763, -1592321.1076260363 335574.81489078264, -1592307.023369889 335568.0446140953, -1592264.5586641843 335568.72905559995, -1592257.8800214329 335569.42966437316, -1592241.216270578 335572.157717444, -1592237.277610807 335573.95265273197, -1592231.3766228408 335577.43514224037, -1592220.4411009748 335585.5296986588)",
				"LINESTRING (-1592225.5002514354 335631.75421267434, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592506.5264048746 335603.2416659426, -1592476.5331862697 335598.97787768365, -1592468.5637179194 335599.3474831463, -1592445.8534002933 335603.034281449, -1592424.4912316566 335603.92872358544, -1592408.3180145435 335604.0919913871, -1592386.5238322471 335602.3491972935, -1592371.7432596604 335602.703157953, -1592364.1769282839 335599.3058180589, -1592357.2936095996 335597.0017707691, -1592349.5049804 335594.92901194416, -1592338.6285580928 335592.73883808765)",
				"LINESTRING (-1592148.606380764 335791.92498018366, -1592142.274796458 335779.5377418997, -1592136.3733927065 335766.03315222764, -1592127.0618338767 335736.72974099795, -1592112.3151026096 335698.57719177974, -1592116.2410614295 335691.5605694203, -1592119.3666032045 335687.29312837205, -1592125.617457769 335668.14371012436, -1592128.9857200393 335660.92144001013, -1592134.285780118 335654.218643123, -1592139.9445156713 335647.92477749044, -1592154.0822924164 335635.1412400646, -1592164.4131715782 335625.0799906595, -1592174.3324909233 335617.215075114, -1592183.3968384815 335611.05532155174, -1592186.778794757 335609.42505387816, -1592191.6269976979 335607.3168050342, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592338.6285580928 335592.73883808765, -1592328.5469935983 335615.6041702009, -1592318.6315192324 335635.4678592637, -1592314.6596180866 335642.20818965766, -1592310.1592851488 335648.0027400696, -1592300.0704743264 335658.456927459, -1592292.1732077543 335665.24282903434, -1592287.774761278 335668.32909456594, -1592280.9404525748 335667.6104513103, -1592270.791974119 335665.8486198478, -1592267.6754299274 335664.7922491382, -1592258.927554059 335660.53715970676, -1592242.2805415748 335647.69293117785, -1592225.5002514354 335631.75421267434)",
				"LINESTRING (-1592220.4411009748 335585.5296986588, -1592209.6614223358 335595.31342698634, -1592205.529090865 335599.74846181984, -1592202.109515076 335604.37855958805)",
				"LINESTRING (-1592191.6195902217 335995.72008429276, -1592157.514696775 336054.0813728671, -1592148.5563262915 336072.8990917176, -1592146.4954187707 336083.0862800737, -1592134.8396686446 336103.4248591118, -1592125.3244855416 336118.74285605573, -1592116.84907919 336134.59628985997, -1592110.939568352 336143.7568290854, -1592108.6780083273 336153.8740410757, -1592110.8976880587 336202.48130229086, -1592106.163746562 336209.409111125, -1592100.5781268985 336216.1223759202, -1592094.5670286184 336221.9349225454, -1592088.7345313297 336226.2172878579, -1592083.6635097065 336229.19789528113, -1592061.5291657394 336239.25418110925, -1592060.0803902897 336238.77184558864, -1592033.7405472903 336252.3875646135)",
				"LINESTRING (-1592191.6195902217 335995.72008429276, -1592182.344248495 335980.2773192192, -1592165.892118767 335948.5253959679, -1592166.3474490088 335930.1865872812, -1592168.9952947705 335893.167960704, -1592150.7218593974 335858.14554181416, -1592149.117720815 335854.18659131083, -1592146.9384362046 335845.49065390974, -1592145.9497972182 335840.23171994573, -1592145.2245590098 335833.1815692246, -1592144.7378864794 335823.936716488, -1592144.8367978006 335816.6291995347, -1592145.9420580969 335804.93483384827, -1592148.606380764 335791.92498018366)",
				"LINESTRING (-1592506.5264048746 335603.2416659426, -1592508.9467640086 335616.03010863316, -1592510.0978405918 335627.9700100813, -1592507.0991015162 335647.42827673274, -1592504.4035051372 335657.83598273806, -1592500.6480021689 335667.02023238904, -1592495.4827293134 335676.03998902923, -1592481.228233391 335703.5092645861, -1592475.8699367165 335726.4553943735, -1592467.4680200478 335751.9383158782, -1592453.651774602 335784.0835534352, -1592443.545892203 335811.4163730806, -1592436.6345024158 335826.7987076126, -1592428.044761621 335844.0648545034, -1592423.430799884 335851.2151842614, -1592419.5317406387 335855.9413050704, -1592407.8688048513 335867.69198115857, -1592392.963544254 335879.71450695273, -1592380.5670546265 335891.5377633538, -1592365.5574403661 335904.0183899148, -1592352.256624691 335917.04005772434, -1592346.6197662866 335921.22805951233, -1592341.666439842 335923.82122878515, -1592339.4296822313 335924.3952003421, -1592322.3766728933 335928.1578755687, -1592302.6911833936 335930.44305566646, -1592294.3874378097 335932.6998335664, -1592289.270325759 335934.969249683, -1592272.2083017803 335943.49852158653, -1592265.0636379512 335947.5804054516, -1592260.3586028728 335950.7094502826, -1592248.1433318187 335960.10982078075, -1592222.324076108 335977.8900868832, -1592201.5383319266 335990.6036682818, -1592192.8367294872 335995.4581684367, -1592191.6195902217 335995.72008429276)",
				"LINESTRING (-1592752.5608748447 335391.84881301766, -1592748.9309571916 335392.9766489282, -1592734.9697623372 335401.84539500525, -1592714.9897471159 335415.5208388956, -1592702.920404009 335425.6498614436, -1592673.5609105062 335447.26474758494, -1592653.5951558503 335460.1771509302, -1592636.0486126824 335475.6115275554, -1592610.6648957608 335494.8790914479, -1592605.3780432027 335501.70882642956, -1592593.584968725 335518.54077203636, -1592567.9476473473 335548.398068443, -1592551.9237217726 335563.7265223983, -1592540.492585423 335575.6324310686, -1592531.9101886572 335583.57249186694, -1592525.5715285137 335588.8453062493, -1592514.8842891245 335596.44270034856, -1592506.5264048746 335603.2416659426)", };

		Coordinate sink = new Coordinate(-1592752.5608748447, 335391.84881301766);
		directionalize(edges, sink);
	}

	@Test
	public void customtest() throws Exception {
		String[] edges = new String[] { "LINESTRING (-1530082.5 382043.3, -1530076.4 382273.3)",
				"LINESTRING (-1530076.4 382273.3, -1529365.3 382412.5, -1528669.3 382730.2, -1528412.1 383256.8, -1528732.9 383728.8, -1529413.7 384104, -1529852.5 384101)",
				"LINESTRING (-1529852.5 384101, -1529840.4 384346.1)",
				"LINESTRING (-1530076.4 382273.3, -1530094.6 382569.9)",
				"LINESTRING (-1530094.6 382569.9, -1529649.8 383026.8)",
				"LINESTRING (-1530094.6 382569.9, -1530439.5 382917.9)",
				"LINESTRING (-1530061.3 383281, -1530439.5 382917.9)",
				"LINESTRING (-1530061.3 383281, -1529649.8 383026.8)",
				"LINESTRING (-1530037.1 383650.1, -1530061.3 383281)",
				"LINESTRING (-1530037.1 383650.1, -1530527.3 383480.7, -1530581.8 383069.2, -1530439.5 382917.9)",
				"LINESTRING (-1530037.1 383650.1, -1530003.8 383801.4)",
				"LINESTRING (-1530003.8 383801.4, -1529471.2 383489.8, -1529456.1 383323.3, -1529649.8 383026.8)",
				"LINESTRING (-1529852.5 384101, -1530003.8 383801.4)", };

		Coordinate sink = new Coordinate(-1530082.5, 382043.3);
		directionalize(edges, sink);
	}

	@Test
	public void routeTest2() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1493212.5849368477 246962.67810817994 1137, -1493205.8704178103 246963.41325969622 1137, -1493198.686916544 246962.9867283916 1137, -1493192.2550202373 246962.81410263572 1137, -1493184.78935209 246963.2944596121 1137, -1493176.1203254384 246963.3670432819 1137, -1493169.2185569596 246962.03228377458 1137, -1493162.0350572688 246961.6057575075 1137, -1493154.700979127 246961.12719627842 1137, -1493147.3664472152 246960.64952840284 1137, -1493140.5872292647 246959.18845112342 1137, -1493133.2531517635 246958.7098930478 1137, -1493127.470193745 246959.92891218234 1137, -1493118.6695834498 246960.96042691078 1137, -1493108.8433509166 246961.8118721405 1137, -1493100.5121637194 246964.0064161308 1137, -1493092.2090249406 246966.37708011828 1137, -1493084.5552784412 246970.13848725427 1137, -1493077.305358744 246972.8662334159 1137, -1493068.5694629843 246976.0939856395 1136, -1493059.9846018977 246979.37288131565 1136, -1493052.7346868177 246982.1006277064 1136, -1493045.6172482779 246983.86990773864 1136, -1493037.7188337552 246985.20736759808 1136, -1493030.4689224334 246987.935114732 1136, -1493022.4479604587 246989.39889755845 1136, -1493013.863108879 246992.67779471073 1136, -1493006.180441878 246996.26262875833 1136, -1492999.8995927018 246996.14116592612 1136, -1492992.43401573 247001.97293233033 1136)",
				"LINESTRING (-1493146.259469215 246925.1573768463 1136, -1493139.9786026832 246925.03590399213 1136, -1493133.0112889383 246926.85587512515 1136, -1493125.112855392 246928.1933338903 1136, -1493115.7573794166 246930.20737381 1136, -1493108.2912570904 246930.68863687012 1136, -1493098.7187015049 246930.45573634375 1136, -1493090.1998175709 246930.57902719826 1136, -1493080.994035495 246932.64465356898 1136, -1493071.167800244 246933.49610989355 1136, -1493063.2693739084 246934.83357509598 1136, -1493055.86930778 246937.51064116042 1136, -1493048.2535020995 246937.94032885786 1136, -1493041.069114512 246937.5133672459 1136, -1493033.0481419724 246938.97715760395 1136, -1493023.8428228805 246941.04189756606 1136, -1493016.1610348877 246944.62719778623 1136, -1493010.434213045 246948.8741688421 1136, -1493004.3031154214 246954.15569239203 1136, -1492998.1715838674 246959.43586862087 1136, -1492994.8998704636 246965.68501114938 1136, -1492992.5294514557 246972.23963460792 1136, -1492991.9932262201 246979.58315522876 1136, -1492990.958640789 246985.5870775925 1136, -1492992.43401573 247001.97293233033 1136)",
				"LINESTRING (-1493212.5849368477 246962.67810817994 1137, -1493208.0246875605 246954.61213251017 1137, -1493202.440610552 246946.36475203 1137, -1493198.782995959 246938.6038222676 1137, -1493195.1538625136 246931.0203569224 1137, -1493189.343710949 246926.71004975308 1137, -1493181.7934372087 246923.98499545455 1136, -1493174.459351615 246923.50643462315 1136, -1493167.7742014588 246924.41951474082 1136, -1493161.2107125618 246925.20581965055 1136, -1493153.594007179 246925.6350416215 1136, -1493146.259469215 246925.1573768463 1136)" };
		Coordinate sink = new Coordinate(-1492992.43401573, 247001.97293233033);
		directionalize(edges, sink);
	}

	@Test
	public void routeTest() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1510871.5069223386 263362.7001933659, -1510874.4689206278 263368.2752105343, -1510876.504759466 263374.49547995045, -1510878.6291222416 263385.6818956501, -1510880.6677269961 263403.7925647008, -1510881.1243634506 263413.25154268026, -1510880.8505588088 263424.1600121431, -1510879.48521987 263441.5500270091, -1510880.0223754067 263446.0072185766, -1510881.3224092165 263450.35688452784)",
				"LINESTRING (-1510642.6036785769 263535.14165345713, -1510652.7233054254 263533.66943054413, -1510667.9013154563 263530.75502103986, -1510673.1272005723 263528.16946246836, -1510680.3542608332 263523.86160152813, -1510686.4231864323 263518.8663804301, -1510688.0312535835 263517.1372557874, -1510688.7474080024 263515.74857427855, -1510691.9603880038 263507.82038920646, -1510702.5308819974 263478.3905050207, -1510706.6082395092 263469.2880218281)",
				"LINESTRING (-1510477.4310501975 263502.78067806666, -1510471.1437518902 263491.2394947959)",
				"LINESTRING (-1510699.03640161 263151.216643841 862, -1510666.279786221 263164.7277791891 870, -1510670.3361284782 263219.53645311017 867)",
				"LINESTRING (-1511280.836947511 264478.66953350697 1257, -1511273.5824127286 264474.99993162137 1252, -1511251.3100694148 264472.3552479902 1248, -1511245.7939707653 264472.46574845724 1240, -1511238.0068710612 264470.78928137105 1235, -1511224.268505456 264464.71971005294 1235, -1511217.013966855 264461.050117732 1225, -1511203.1539151117 264455.1071976479 1220, -1511189.4439435299 264449.21503279824 1216, -1511179.7399147693 264443.5303337984 1208, -1511176.3895366548 264441.20489645936 1199, -1511167.3965477494 264433.7552161226 1196, -1511155.5516883994 264425.32426537666 1193, -1511144.3265659579 264418.1117283255 1191, -1511137.1358071438 264411.2818093989 1189, -1511127.460167316 264405.77451582253 1178, -1511123.9588128792 264403.3978768289 1174, -1511123.3390717565 264402.1794654513 1168, -1511109.727347714 264389.7910308726 1164, -1511097.6646524726 264379.1087292759 1157, -1511083.4336089904 264365.5032315897 1150, -1511076.9543096207 264356.9096729327 1150, -1511074.2869957802 264352.6432005577 1145, -1511068.6452559875 264347.519416702 1140, -1511061.1104329568 264344.75838972256 1134, -1511052.5525988326 264341.81234153546 1127, -1511043.8357318202 264339.6490840744 1127, -1511021.538573635 264330.63531032205 1122, -1511020.3578747176 264331.2326399805 1114, -1511014.7156738397 264326.1097542094 1110, -1511006.9042327998 264318.0632190639 1105, -1511000.7648552794 264311.5957300281 1100, -1510995.525916035 264305.4394541895 1095, -1510991.1874346738 264299.59215410147 1090, -1510985.2375714183 264283.64718509 1088, -1510980.2788861825 264276.58236161247 1081, -1510976.3087431733 264273.03852171544 1072, -1510969.4853776144 264268.51386026107 1068, -1510962.2307990897 264264.84430414904 1065, -1510950.3220964153 264259.57374117896 1064, -1510942.7872576092 264256.8127339557 1061, -1510933.7304316533 264252.5234331284 1059, -1510917.139653091 264245.4735850906 1056, -1510900.5763832682 264238.60068580694 1053, -1510893.041086358 264235.8405786762 1051, -1510891.4920404195 264234.134450824 1044, -1510885.786500315 264232.1710347794 1040, -1510875.8296613481 264227.57188011426 1036, -1510861.9406697652 264221.4525560187 1033, -1510844.046153889 264215.1271557519 1030, -1510833.1884138077 264210.2176921116 1028, -1510826.8342637469 264206.85936749727 1027, -1510822.9274188317 264200.1560781114 1026, -1510820.7577098892 264197.2333238954 1022, -1510798.243526676 264185.968743762 1019, -1510787.2356946955 264181.0085410839 1017, -1510774.8917476693 264171.23439409863 1016, -1510755.511011572 264160.0443321392 1013, -1510739.19999203 264152.0868921112 1011, -1510731.0449255034 264148.1084011961 1010, -1510725.742633861 264145.1116091497 1009, -1510719.1994892044 264139.67843337264 1008, -1510715.912379298 264134.19355775416 1008, -1510704.9678354808 264126.0739079695 1004, -1510689.9880159202 264117.5712368572 1000, -1510682.235310976 264112.55890228506 998, -1510674.981133651 264108.89073585346 995, -1510658.6700904493 264100.93332310766 988, -1510642.7902494445 264092.12080581486 987, -1510625.8589864655 264082.94588516746 985, -1510614.6332794642 264075.73435088247 982, -1510603.1264288672 264069.43091618177 979, -1510597.203911432 264065.2166185798 972, -1510591.0640019472 264058.75005696714 971, -1510590.6965269833 264056.44704326056 965, -1510588.9580233742 264052.6669455571 960, -1510583.225386624 264038.97423188016 956, -1510572.9367827673 264017.1841978701 951, -1510567.485731568 264002.58248003107 947, -1510564.4783923961 263996.1899376968 946, -1510562.8036125926 263989.2517011585 935, -1510559.860908499 263979.6992390966 931, -1510558.781954524 263967.6083560297 928, -1510553.0226710779 263942.1853383323 923, -1510551.5373326787 263937.3210740881 922, -1510547.9102253919 263929.71010418516 913, -1510545.5872758944 263921.37603891455 906, -1510543.9124903153 263914.4377847491 901, -1510543.8225689847 263905.8669851236 900, -1510542.961457489 263896.0274550421 898, -1510539.3352348018 263888.4169293847 897, -1510524.735951253 263860.95778453164 891, -1510515.7802974281 263838.62105029076 886, -1510508.6888434738 263813.744972066 882, -1510503.9433985557 263803.5736170523 878, -1510502.7391905435 263797.8012242038 876, -1510508.2056491121 263779.589607141 874, -1510508.4596959138 263766.9520402141 874, -1510507.0376361 263758.92824122775 874, -1510496.8419674144 263734.15548027866 872, -1510492.5671007126 263725.1499896683 871, -1510490.674447089 263715.96028894465 871, -1510490.9555875938 263715.0521776909 871, -1510487.682444608 263688.30803483166 870, -1510487.4645919073 263686.0566314524 870, -1510486.6911499018 263679.42774127796 870, -1510486.19839404 263671.89162801486 870, -1510483.875419519 263663.5574907232 870, -1510480.9322227421 263654.00581788924 869, -1510480.841833844 263645.4358241251 869, -1510479.2985375023 263637.5377496602 869, -1510477.4063316006 263628.34712794423 869, -1510475.0828988405 263620.01386988256 869, -1510473.5396005812 263612.1157883266 869, -1510472.2676147406 263604.1426935829 869, -1510473.577127767 263597.2262890218 869, -1510475.9362920555 263590.67137960345 869, -1510478.3600881866 263580.9565008506 869, -1510483.636699508 263572.22329974454 869, -1510490.4977337166 263561.8584108418 869, -1510497.72625578 263553.7965725763 869, -1510502.5363268326 263549.25631855614 869, -1510507.0377431628 263545.44723572396 869)",
				"LINESTRING (-1510706.6082395092 263469.2880218281, -1510711.1409785093 263457.4220072522, -1510713.0675166524 263453.64275733917, -1510718.2864918243 263447.8222591617, -1510721.2045549979 263445.5566829687, -1510735.654124633 263436.5512591022, -1510743.0000158567 263431.0154318231, -1510750.5287527444 263426.5899941373, -1510756.759035634 263424.07504920993, -1510771.1058008827 263420.6950656103)",
				"LINESTRING (-1510588.7020922503 263319.87595335767 867, -1510592.605924438 263321.21870522294 867, -1510601.0422985593 263324.2890822729 867, -1510604.7964983163 263325.58019458875 867, -1510618.7853263584 263325.20250770357 867, -1510623.532142384 263323.82176761795 867, -1510624.4963558263 263320.97251121886 867, -1510622.7356789696 263310.82198171224 867, -1510624.3169776194 263303.831808161 867, -1510627.5151444338 263300.74625066016 867, -1510632.5147074 263298.2799758287 867, -1510644.0814943626 263296.06410752237 867, -1510646.9121849455 263290.67546281405 867, -1510649.2727399445 263284.120011989 867, -1510650.604434894 263283.5738368025 867, -1510664.8111282578 263285.4475987479 867, -1510674.8319495684 263286.8862822801 867, -1510682.7706814357 263288.6129217418 867, -1510689.1019471514 263285.6004732903 867, -1510696.5479554636 263279.7908559013 867, -1510703.5636399144 263274.8368357383 867, -1510708.3737726386 263270.2965138322 867, -1510711.7857771988 263264.1034644563 867, -1510719.484540001 263257.2083054725 867, -1510720.8166917858 263256.6612386061 867)",
				"LINESTRING (-1510918.0258844069 263340.0692533547, -1510925.2811001348 263340.4545977779, -1510934.6212383702 263342.71571881184, -1510958.0334046436 263346.91184442234, -1510965.5419273898 263347.4383308042)",
				"LINESTRING (-1510588.7020922503 263319.87595335767 867, -1510590.7814900174 263314.228643517 867, -1510592.9250740833 263305.4222146636 867, -1510593.3969981372 263295.03582235053 867, -1510594.8286600015 263287.9940052619 867, -1510599.5497529767 263274.88310511503 867, -1510603.5584701612 263263.5377099076 867, -1510608.2153819338 263253.5859191818 867, -1510614.3296845336 263248.3224637378 867, -1510626.2143037748 263241.8623710852 867, -1510632.9763487799 263237.9934167722 867, -1510636.8575906395 263232.96671207994 867, -1510647.8413029446 263226.1963006696 867, -1510654.4532669089 263222.27659459226 867, -1510658.7024465692 263219.5520872837 867, -1510664.3209019464 263218.30379474256 867, -1510670.3361284782 263219.53645311017 867)",
				"LINESTRING (-1510918.0258844069 263340.0692533547, -1510907.7997604152 263340.22239420674, -1510898.4433413895 263342.2144349554, -1510895.9194636708 263343.0713167065, -1510881.975534119 263349.7223404779, -1510876.5508408505 263354.3970786853, -1510871.5069223386 263362.7001933659)",
				"LINESTRING (-1510507.0377431628 263545.44723572396, -1510517.0914536917 263537.80835121265)",
				"LINESTRING (-1510920.3651983216 263328.001646067, -1510918.0258844069 263340.0692533547)",
				"LINESTRING (-1510871.5069223386 263362.7001933659, -1510865.6447494053 263364.2318239289, -1510857.6977546862 263367.3789273545, -1510836.4900228556 263380.5417106574, -1510820.482197273 263387.58417247346, -1510815.6486558174 263387.72983935964, -1510800.0596482528 263386.91226384335, -1510797.9874263264 263387.2051457727)",
				"LINESTRING (-1511236.9289367613 263127.0209542841, -1511221.5514152164 263145.01967000583, -1511210.8285927786 263159.98301729816, -1511206.8192732295 263166.7304772661, -1511198.8810664266 263178.6493257464, -1511192.2490008778 263185.2896962487, -1511181.4798391203 263200.0456588506, -1511174.0370785308 263213.50264643715, -1511171.0027413296 263219.9365724868, -1511163.1328200744 263241.67864762753, -1511156.5726475713 263257.3024326993, -1511148.1092568734 263274.5982193841, -1511142.4087125831 263284.3909401559, -1511135.415886298 263294.9890433099, -1511130.4189126515 263300.8344061892, -1511128.7272796137 263302.0157055749, -1511120.2080324846 263305.7168794861, -1511102.0637247723 263314.7645558561, -1511095.1997294852 263318.8027729904, -1511076.2094126658 263325.6197561453, -1511060.7467582359 263333.26634289866, -1511047.6680428274 263338.6786101903, -1511037.581652624 263343.6237348347, -1511007.1073873795 263353.3980099428)",
				"LINESTRING (-1510461.6224746641 263521.63096470607, -1510450.8403479925 263529.0623467448, -1510438.7690446326 263541.2717724808, -1510429.5390089862 263549.498807587, -1510423.4209562945 263556.3115677223, -1510409.2255163006 263569.11378090124, -1510402.6290103227 263577.0285657028, -1510395.1209263904 263583.07536200696, -1510387.662147911 263589.8060620314, -1510371.7289883199 263606.2277952955, -1510367.6384537958 263611.7463214734, -1510349.950393312 263641.58222272724, -1510346.886410872 263645.52109045105, -1510340.5108938136 263652.46460619615, -1510337.9555483863 263656.1796131118, -1510330.1898098062 263671.11355015007, -1510328.6089716365 263675.2064934542)",
				"LINESTRING (-1511007.1073873795 263353.3980099428, -1511006.6472920212 263362.30557240074, -1511005.4110982018 263367.8119763603, -1511002.8996792817 263373.83630397765, -1510998.944828774 263379.050268468, -1510995.834055353 263381.73054910044, -1510984.5322106355 263389.8512253808, -1510959.3632621502 263402.1554433903, -1510949.3468940938 263408.7310580791, -1510945.8243784464 263411.6784722688, -1510940.1242780127 263419.87840654363)",
				"LINESTRING (-1510965.5419273898 263347.4383308042, -1510978.519992588 263348.52997685067, -1510997.4270191726 263350.9573727123, -1511002.296534962 263351.92117148824, -1511007.1073873795 263353.3980099428)",
				"LINESTRING (-1510797.9874263264 263387.2051457727, -1510792.1437296907 263388.9726071613, -1510788.4188496117 263390.9200294256, -1510786.007104891 263392.635965183, -1510783.943116708 263394.84222982556, -1510782.1077126542 263397.78155900055, -1510779.255151856 263406.444999684, -1510776.9906197917 263411.33863508486, -1510771.1058008827 263420.6950656103)",
				"LINESTRING (-1511343.3966503625 263050.8843435887, -1511347.1308885217 263045.5728493698, -1511358.9089812462 263032.46131172945, -1511363.4241446208 263025.48296721024, -1511369.4076033244 263010.98546872445, -1511373.6205718103 262999.3028235849, -1511378.9571286167 262987.32936388714, -1511382.3932123487 262977.3796294705, -1511383.6218436966 262969.6942752736, -1511383.1650775291 262960.1410067466, -1511380.6723421626 262949.845586096)",
				"LINESTRING (-1510517.0914536917 263537.80835121265, -1510519.2244486727 263538.9683769904, -1510521.485162788 263541.4875534108, -1510522.3255837157 263542.5993875674, -1510523.3045035962 263545.4604434601, -1510530.3055537457 263550.88499461726, -1510533.786105448 263552.4902680863, -1510538.2517379378 263553.78514850314, -1510547.68274498 263555.30199260585, -1510565.1911126503 263554.71853355196, -1510593.13395596 263551.2716732873, -1510604.8905222719 263549.23839140614, -1510614.040022203 263548.3199493523, -1510626.602976394 263547.84182549897, -1510629.3074698034 263547.0043863483, -1510632.7169277736 263544.99924633454, -1510642.6036785769 263535.14165345713)",
				"LINESTRING (-1510670.3361284782 263219.53645311017 867, -1510680.632737413 263226.26040933374 867, -1510686.5842246593 263230.651310266 867, -1510693.4077705522 263235.17601613794 867, -1510706.8016780955 263245.3096205881 867, -1510714.2454424948 263251.0518858582 867, -1510720.8166917858 263256.6612386061 867)",
				"LINESTRING (-1510471.1437518902 263491.2394947959 869, -1510472.108839543 263488.39071816206 867, -1510475.1524103028 263479.8942266302 867, -1510479.2469798138 263471.75879120734 867, -1510483.0698020072 263463.69701872487 867, -1510483.5363493836 263459.5040444089 867, -1510481.6445714622 263450.31470346637 867, -1510479.2003558672 263442.1062571369 867, -1510474.6452040842 263434.00925408583 867, -1510471.9193900803 263426.7098187851 867, -1510470.9280860424 263417.8294334458 867, -1510468.8871262944 263408.5875477409 867, -1510468.3943641423 263401.05135256983 867, -1510470.7548820546 263394.495944961 867, -1510472.4025950728 263389.7046909407 867, -1510474.7631143057 263383.14927961957 867, -1510478.7076068374 263374.96305693965 867, -1510482.3998162665 263367.8614663724 867, -1510487.8659057766 263361.2022028379 867, -1510490.8104260135 263359.20172746107 867, -1510494.8457655045 263359.5847040443 867, -1510501.883565179 263361.001004789 867, -1510508.7070992438 263365.5256640911 867, -1510513.9466576464 263371.68113370147 867, -1510520.1504191617 263374.9873563703 867, -1510522.3830218872 263374.75149498787 867, -1510526.263799567 263369.72348143253 867, -1510528.9629557594 263365.2946261661 867, -1510531.6046299734 263357.83107777406 867, -1510533.684017332 263352.1837805277 867, -1510534.64911281 263349.3349838676 867, -1510537.2898997231 263341.870975662 867, -1510540.890427865 263337.7515347898 867, -1510545.3560925904 263337.27891885675 867, -1510558.5976625823 263342.00145648327 867, -1510572.119921652 263345.81676227134 867, -1510575.9374144576 263343.94830671046 867, -1510583.0159084632 263335.83562455326 867, -1510587.4567360943 263323.63333763834 867, -1510588.7020922503 263319.87595335767 867)",
				"LINESTRING (-1510754.189828637 263272.8322792733 867, -1510755.7972888004 263277.5713770557 867, -1510758.182655846 263282.7456449857 867, -1510763.1410495804 263289.8093063999 867, -1510770.3989191272 263298.8373573739 867, -1510776.6890067568 263305.3548451876 867, -1510781.0620841144 263307.8639668161 867, -1510789.6273157157 263304.61523712426 867, -1510798.8109703227 263302.5853942083 867, -1510803.8968702178 263303.3303515315 867, -1510811.9878946978 263310.4680275507 867, -1510818.4728083718 263312.8661695551 867, -1510823.0606084096 263312.2682643179 867, -1510829.3918879614 263309.25583086815 867, -1510837.055756879 263305.6976798149 867, -1510839.690752294 263304.4279343812 867, -1510845.1220091372 263301.10563554335 867, -1510848.5366906396 263300.27197017893 867, -1510857.0942985355 263303.2166357031 867, -1510857.9956681454 263303.526063011 867)",
				"LINESTRING (-1511380.6723421626 262949.845586096, -1511383.991151916 262944.04328795196, -1511394.116702929 262923.3764236925, -1511407.2518686613 262900.18909875123, -1511412.1363614637 262888.290612768, -1511421.030569133 262869.0176057058, -1511433.82533953 262839.69190036686, -1511441.2051695 262820.52636431856, -1511444.7926413403 262812.4068693644)",
				"LINESTRING (-1510642.6036785769 263535.14165345713, -1510637.3487285022 263530.1965953368, -1510632.4777655837 263527.05545281555, -1510604.1562800729 263518.5811652297, -1510594.2715120888 263514.2543436408, -1510580.123020641 263507.3832104016, -1510574.0647884225 263503.6004651241, -1510571.8161787735 263495.16628844896, -1510568.994819597 263489.6301541303, -1510567.2730496353 263487.56477015215, -1510560.2987694943 263482.73818748427, -1510548.3126680146 263475.65759997367, -1510543.7594346884 263473.8591790672, -1510537.0816247251 263472.3321645976, -1510531.705571968 263471.88958877977, -1510527.737583479 263472.07594512065, -1510521.1506678306 263473.6764845855, -1510502.6646841066 263481.4455154649, -1510499.8266335775 263483.1652218381, -1510491.599791288 263489.1535985623, -1510482.687466642 263497.7446661422)",
				"LINESTRING (-1510754.189828637 263272.8322792733 867, -1510756.8894741067 263268.4025072446 867, -1510759.8982182585 263263.242896338 867, -1510762.6647299463 263261.01337107643 867, -1510772.9002828028 263259.34503577277 867, -1510785.2183851958 263257.3878582772 867, -1510794.8974876325 263251.3414876433 867, -1510801.4150934685 263245.0445964495 867, -1510805.5770760141 263239.1084139431 867, -1510811.8198195046 263227.52668648586 867, -1510815.6652891007 263225.83652024623 867, -1510818.301632065 263224.56632914115 867, -1510825.8371081084 263227.3264325913 867, -1510832.9417994737 263230.9430303145 867, -1510836.3501975464 263236.3023262685 867, -1510842.426451025 263245.9273344083 867, -1510845.1792800839 263253.4047157066 867, -1510849.9866904248 263260.4171965169 867, -1510857.7974557374 263268.46347873006 867, -1510864.621441471 263272.9873212455 867, -1510866.5095887866 263276.8191885799 867, -1510865.0778783876 263283.8610293856 867, -1510861.3213802967 263294.1217938345 867, -1510857.9956681454 263303.526063011 867)",
				"LINESTRING (-1510477.4310501975 263502.78067806666, -1510482.687466642 263497.7446661422)",
				"LINESTRING (-1511354.5018567455 263058.4609475257, -1511343.3966503625 263050.8843435887)",
				"LINESTRING (-1511437.6949770744 263983.6149820946 1206, -1511438.4427777426 263978.513946495 1204, -1511435.8043219857 263974.4238897553 1202, -1511429.9456446848 263967.0490344232 1197, -1511426.9397544265 263960.65592173487 1194, -1511422.882442415 263953.9003803516 1191, -1511417.7073129416 263944.5835486669 1186, -1511414.982580488 263937.2823235132 1182, -1511411.9766862544 263930.8892062474 1179, -1511408.069888893 263924.1857578736 1175, -1511403.732299649 263918.338775184 1172, -1511397.8736106367 263910.96391382534 1167, -1511396.3879220393 263906.0982176 1164, -1511391.8618133375 263898.17767132353 1159, -1511388.0183653617 263888.31469082553 1153, -1511385.2652252202 263880.8360546315 1148, -1511382.2234790619 263877.7794051152 1145, -1511373.8510239671 263871.54846024327 1138, -1511367.928971358 263867.3331249021 1134, -1511362.971174518 263860.2685886342 1129, -1511358.4162211225 263852.1692903787 1124, -1511355.9079377712 263847.119907164 1121, -1511358.6714109653 263839.532067609 1118, -1511359.1439733715 263829.1449142024 1113, -1511360.7244941094 263822.1543985922 1111, -1511361.4144103478 263814.0195520194 1108, -1511361.6058131652 263804.5405012844 1104, -1511363.749545904 263795.7342022052 1101, -1511363.8128991302 263792.57466242183 1100, -1511362.3914454386 263784.5498608127 1097, -1511361.899296452 263777.0127871623 1094, -1511361.1902290036 263767.22473785 1091, -1511360.4523263106 263757.2579379268 1088, -1511358.8423521663 263747.15955176484 1084, -1511357.0818572573 263737.0090647545 1080, -1511356.092081456 263728.1282259999 1077, -1511351.4154277418 263720.15554259345 1074, -1511350.1436001298 263712.18236289173 1071, -1511349.003737291 263703.25076470897 1068, -1511348.7918565767 263694.8050946593 1064, -1511346.4699247084 263686.47128073964 1060, -1511345.076864334 263678.62384963967 1056, -1511344.3393914823 263668.6583615206 1051, -1511343.1641393248 263663.0623615375 1048, -1511344.4060775938 263653.9452245841 1044, -1511342.3653038342 263644.70327747427 1040, -1511341.1611964605 263638.9307620572 1037, -1511343.521852801 263632.37538365554 1034, -1511343.9884864157 263628.1823961884 1032, -1511344.6115678828 263617.8472480858 1027, -1511345.7034223836 263608.6793413516 1023, -1511347.1631720765 263601.8136244202 1020, -1511349.7761388284 263594.1736004036 1016, -1511349.3482272362 263583.47735593934 1011, -1511350.1602656182 263575.2171210628 1007, -1511351.6200172221 263568.3513934575 1004, -1511352.4320563439 263560.09115291387 1000, -1511354.7927189923 263553.53574955 997, -1511355.2014762452 263546.30893424805 994, -1511351.953108727 263525.93458749074 985, -1511349.912330299 263516.69259304367 980, -1511350.9412902147 263510.6833308358 978, -1511347.0339922723 263503.9806889938 974, -1511343.6894718038 263495.4609001996 970, -1511341.3675281063 263487.12702377886 967, -1511340.8120200292 263482.7494409904 965, -1511336.9051725783 263476.04590282403 962, -1511334.5198751385 263470.8716032868 959, -1511333.9634767713 263466.49356424063 958, -1511330.5909860237 263457.7977084182 954, -1511327.3681256236 263449.1534935441 951, -1511324.4264260447 263439.6011470724 949, -1511320.4328370504 263429.6872639777 946, -1511318.1397402035 263421.5298822047 944, -1511315.1337973482 263415.1366622234 942, -1511311.7612992062 263406.4407935282 940, -1511307.8548761986 263399.7385884132 937, -1511305.7498440223 263393.655693111 935, -1511298.7089950803 263386.87853659224 932, -1511292.419426223 263380.3600652572 928, -1511288.110170182 263374.6904045753 926, -1511283.5555884156 263366.59233250376 923, -1511278.1284912797 263358.36133532505 920, -1511272.458669117 263353.0613231156 917, -1511267.6517761291 263346.04789333325 915, -1511263.3136593844 263340.2017182233 913, -1511257.39152736 263335.98635161575 911, -1511252.9891735655 263333.29931923 897, -1511252.9286829056 263324.90608133096 897, -1511252.0699512667 263315.0662240712 896, -1511252.8819751586 263306.8059028089 894, -1511254.745001344 263298.9066567952 891, -1511255.8377331581 263289.7390859183 889, -1511257.5795290277 263281.9655949762 887, -1511260.3430189318 263274.3775585843 885, -1511262.7036813512 263267.8220715346 883, -1511264.4166245873 263259.87205953803 881, -1511266.777288518 263253.3165677842 879, -1511270.1039956082 263243.91269998625 877, -1511272.4646614054 263237.35720301326 876, -1511275.5093194586 263228.86101181805 875, -1511278.5544331262 263220.3639253378 874, -1511280.6990658226 263211.5578531353 872, -1511284.64464509 263203.37197881006 871, -1511288.6190808245 263195.36261436157 870, -1511292.2839547484 263188.083981337 870, -1511296.4464634415 263182.149121942 869, -1511300.1397405418 263175.0478890827 869, -1511302.7536133004 263167.40816884674 868, -1511305.545974478 263159.9966023853 868, -1511311.2938556552 263152.43047119584 868, -1511318.5235414845 263144.36891804077 867, -1511323.3342143137 263139.8299210826 867, -1511331.0340273543 263132.9351906078 867, -1511338.199914863 263128.03414883185 867, -1511344.3143630153 263122.77067989483 867, -1511350.99157767 263115.6922685243 867, -1511356.2059997292 263110.1189208487 867, -1511361.4837773787 263101.38593934197 867, -1511365.4293850143 263093.200017198 867, -1511367.790965097 263086.6449226374 867, -1511368.5396619465 263081.54414302576 867, -1511363.7322958799 263074.53152550105 867, -1511361.5630110898 263071.60773246177 867, -1511360.9441454993 263070.389711692 867, -1511359.9564917798 263066.8689940544 867, -1511359.458858759 263065.52521021105 867, -1511354.5018567455 263058.4609475257 867)",
				"LINESTRING (-1510881.3224092165 263450.35688452784, -1510869.8006666086 263463.95271850633, -1510858.318910777 263471.49047130207, -1510849.442666964 263476.17562407954, -1510845.7796453591 263477.2947803122, -1510841.2015331301 263477.92914582585, -1510823.5376712088 263478.0054109574, -1510817.1408131993 263477.04769889126, -1510805.267217238 263471.8644242769, -1510802.4006284394 263470.08164577733, -1510800.654942182 263467.68322609167, -1510795.218617979 263457.7182112335, -1510791.6198799547 263449.92636489955, -1510786.1267850634 263440.04367082944, -1510776.526083414 263428.14884008665, -1510771.1058008827 263420.6950656103)",
				"LINESTRING (-1510461.6224746641 263521.63096470607, -1510465.4064114194 263515.90015684546, -1510474.1600845924 263505.7452538403, -1510477.4310501975 263502.78067806666)",
				"LINESTRING (-1511343.3966503625 263050.8843435887, -1511341.034406695 263053.94271665247, -1511339.132563279 263055.6716897842, -1511323.2484866143 263067.4435948976, -1511319.7080011822 263070.7079133515, -1511310.7846126736 263080.6237058306, -1511297.5758527857 263090.82356500585, -1511288.981675294 263099.6115071134, -1511283.2093476453 263104.9167690453, -1511269.6720433044 263114.7122667329, -1511263.1596827249 263120.3718034133, -1511258.3733887447 263123.2028000557, -1511252.4138150197 263125.314721215, -1511242.9699333268 263126.72777397704, -1511236.9289367613 263127.0209542841)",
				"LINESTRING (-1511236.9289367613 263127.0209542841, -1511235.8780727403 263121.4464822024, -1511234.444993436 263107.723511152)",
				"LINESTRING (-1510947.2653932287 262845.9823353309 862, -1510808.2706597077 262954.9394795727 862, -1510759.5594491756 263019.61318557523 862, -1510699.03640161 263151.216643841 862)",
				"LINESTRING (-1510720.8166917858 263256.6612386061 867, -1510730.1539946937 263260.0419575488 867, -1510739.6138702212 263263.29647889826 867, -1510749.101258213 263266.7279512724 867, -1510753.9728767867 263270.5812821444 867, -1510754.189828637 263272.8322792733 867)",
				"LINESTRING (-1510857.9956681454 263303.526063011 867, -1510865.2508674953 263307.1947579589 867, -1510874.3070068997 263311.4836387569 867, -1510882.743836845 263314.55317895114 867, -1510885.5966684145 263315.5348874433 867, -1510893.1316739253 263318.29589342326 867, -1510906.2231634231 263322.9677868206 867, -1510920.3651983216 263328.001646067 867)",
				"LINESTRING (-1510881.3224092165 263450.35688452784, -1510888.8686548972 263449.92682515254, -1510899.4693576777 263450.3646367373, -1510913.6285373808 263445.4682981921, -1510920.752737912 263442.4480750846, -1510924.2883652232 263440.16575502587, -1510929.0149426472 263434.04232499236, -1510935.9007855817 263426.3400442766, -1510940.1242780127 263419.87840654363)",
				"LINESTRING (-1510517.0914536917 263537.80835121265, -1510506.8948749104 263530.8829747092, -1510501.359966515 263528.62753045396, -1510498.682864818 263528.2117587593, -1510495.7199827963 263528.3123224467, -1510482.107970338 263529.63803001033, -1510477.7189831093 263529.1411202219, -1510474.2711546642 263528.2422985562, -1510470.6063066777 263526.73888306005, -1510461.6224746641 263521.63096470607)",
				"LINESTRING (-1511380.6723421626 262949.845586096, -1511372.8421088397 262950.7621026518, -1511365.5151446585 262952.60305241327, -1511352.9081663091 262957.444705442, -1511337.1378699278 262964.86363803473, -1511333.3339303348 262967.78246378974, -1511329.6379004216 262971.42445118487, -1511319.6133562175 262983.26438446704, -1511313.081325324 262989.4728064302, -1511296.8527202525 263000.3982830325, -1511284.3514070658 263011.9242424229, -1511268.4800997977 263021.9959552623, -1511265.9275024408 263024.3847888356, -1511261.9156900137 263029.0276225852, -1511255.2140612546 263039.1018801645, -1511244.3342061753 263062.3108178192, -1511233.6691980222 263092.3221981923, -1511233.348094224 263096.4359932294, -1511234.444993436 263107.723511152)", };

		directionalize(edges, new Coordinate(-1511444.7926413403, 262812.4068693644));
	}

	@Test
	public void routeTest3() throws Exception {
		String[] edges = new String[] {
				"LINESTRING (-1544847.3271408193 273377.75382876163, -1544838.6085768854 273385.86126269505, -1544831.0586453315 273394.01713460486, -1544823.0455510619 273404.30672200053, -1544814.8157516401 273416.61057409033, -1544804.273061802 273429.7149239382, -1544792.123123732 273442.5714112695, -1544787.7704902214 273446.7006960163, -1544773.11634381 273458.76536251564, -1544751.4970260756 273474.52171580534, -1544736.4242731668 273486.9692565046, -1544707.04205839 273525.2773085323, -1544701.081274619 273534.392900154, -1544691.4414342511 273551.6192904043, -1544677.4161471892 273580.7236623665, -1544663.872191695 273611.84289464424, -1544646.7870767377 273661.3659038041, -1544639.1488691124 273682.10034191795, -1544634.9133500326 273696.2659907761, -1544628.8978275994 273724.09262680454, -1544612.4639794435 273774.04133428994, -1544596.9696409407 273825.38742614316, -1544588.997381578 273857.29596835084, -1544585.1613708653 273877.0256417888, -1544581.750251271 273915.4884094896, -1544581.223979695 273942.9634766532, -1544583.3551449762 273970.2821843677, -1544584.3168715546 273996.7236127127, -1544584.0750020035 274033.292619545, -1544584.7049174802 274076.09794258705, -1544588.5429165214 274099.4856945188, -1544590.1307020811 274114.68554242776, -1544592.7974145415 274124.47978400893, -1544596.894679892 274136.83690201584, -1544613.653569247 274178.9311263624, -1544616.351903217 274187.53530569153, -1544619.488326051 274200.0904369443)",
				"LINESTRING (-1542941.824610261 273782.96405892423, -1542935.259716788 273791.28237079363, -1542924.4873859615 273807.890058499, -1542919.667290684 273813.5674157933, -1542915.3965707049 273819.4389385419, -1542908.3955797078 273830.5055750578, -1542903.3890155563 273836.50350821833, -1542900.618171618 273840.4962462667, -1542894.1631563238 273854.7218240556, -1542890.9655901797 273863.696336752, -1542883.8764962219 273886.834298666, -1542886.7894981534 273900.5713726458, -1542889.9164407172 273904.6123145588, -1542893.7634027493 273908.402915894, -1542909.8159868363 273919.96311734035, -1542916.5169144783 273923.8068572513, -1542931.7911920925 273927.25230712746, -1542934.7803795447 273927.5910485835, -1542954.4541788183 273927.87050505425, -1542975.9015482576 273926.9758050694, -1542981.37571725 273921.05718879483, -1542985.8195045306 273917.60793083214)",
				"LINESTRING (-1541796.2862031898 271990.120542128, -1541806.8012910897 271998.3614326682, -1541811.6528763918 272003.26695511513, -1541817.4323580067 272012.22446400544, -1541826.748432103 272028.6917783157, -1541832.7425647702 272035.2367129453, -1541834.6805379791 272036.8195917371, -1541839.130217304 272039.3968322581, -1541860.1659931333 272055.11915952206, -1541883.4733321543 272075.87289362116, -1541914.8882115437 272101.7292128522, -1541926.9326753707 272110.2538799172, -1541945.410122769 272124.48219869076, -1541951.9056959494 272129.00823010283, -1541955.6462714798 272130.77203505253, -1541965.8762379806 272134.9740138559, -1541980.9526246465 272140.4500347948, -1542007.9068525129 272146.68776034703, -1542034.9667862924 272152.13317552477, -1542065.9319415635 272161.5728726928, -1542095.3783896875 272169.8450015431, -1542119.037026269 272172.9505513102, -1542151.3581891714 272179.05223748565, -1542198.1237322232 272191.8616855061, -1542255.6687340927 272204.2077142399, -1542293.2744934133 272215.77876873733, -1542317.2453593714 272224.4732573373, -1542324.4947103807 272228.05593939597, -1542343.5188882449 272235.73458121857, -1542365.7602609266 272246.50994955044, -1542378.974186881 272254.66215107305, -1542388.5714434725 272259.6082883388)",
				"LINESTRING (-1542733.7238132858 271956.58606644254 540, -1542740.8091194027 271948.5057004653 540, -1542750.6977724573 271933.01779807266 540, -1542757.5721953646 271910.9285089616 540, -1542760.0858288698 271898.04824025277 540, -1542759.9448291124 271892.62680937443 540, -1542753.9897209562 271873.57603218313 540, -1542748.0867822082 271869.31519469246 540, -1542741.6374224455 271860.6666191509 540, -1542740.5185649248 271851.7114800941 540, -1542746.4429556355 271826.2667359179 540, -1542748.60276166 271817.457830769 540, -1542745.8998104467 271798.37671924103 540, -1542747.442999244 271788.34434651304 540, -1542754.1245679064 271769.54533595406 540, -1542756.3979972594 271765.98088178504 540, -1542770.8597454175 271755.29230070114 540, -1542778.641550587 271751.6527032489 540, -1542793.5278023272 271733.7274921173 540, -1542787.4841435808 271712.2955316873 540, -1542789.019193342 271707.63195075 540, -1542794.9233589924 271700.1413877625 540, -1542808.7498875356 271694.4335824 540, -1542843.911328787 271691.199704024 540, -1542870.989995591 271698.71865698416 540, -1542893.557226667 271703.64131774753 540, -1542895.5041902375 271704.3275126405 540, -1542909.683371271 271706.2974924436 540, -1542925.518498182 271703.47908949945 540, -1542949.7716332565 271692.04072336666 540, -1542974.075884469 271683.64322032686 540, -1543023.6307333116 271661.1372449547 540, -1543028.0901840092 271660.6922450727 540, -1543048.4979321477 271662.67426708154 540, -1543064.6045396228 271671.5343388142 540, -1543073.4223837198 271697.1341904383 540, -1543080.1540144747 271704.8762003295 540, -1543083.6156079588 271707.1021989798 540, -1543097.794347227 271709.07312312257 539, -1543121.1290603885 271703.52411179896 539, -1543144.4816232314 271703.52139287256 539, -1543161.408195427 271709.4813136328 539, -1543175.3735608638 271720.9461068278 539, -1543176.9584503956 271731.0726233246 539, -1543177.5095173067 271753.59404287767 539, -1543180.8301885081 271762.149577816 539, -1543187.8436588706 271768.9835644942 539, -1543228.4123806222 271780.41587091144 539, -1543255.8435469584 271783.8640509099 539, -1543296.1522275438 271766.4985594433 539, -1543314.6923410844 271771.01280737016 539, -1543328.3671309163 271777.0043920791 539, -1543350.6588973312 271789.2188201472 539, -1543371.8314461694 271804.22993346304 539, -1543394.2554580814 271815.48459631205 539, -1543431.4113698113 271839.48294527363 539, -1543460.4045387134 271871.01438949537 539, -1543473.6824987696 271884.4209946422 539, -1543521.5034099421 271937.6941275969 539, -1543537.1747610052 271959.162041815 539, -1543545.6393282744 271977.0850080233 539, -1543561.8829324811 272014.87131170277 539, -1543574.8488322948 272040.758538316 539, -1543578.0982423464 272052.48013696726 539, -1543585.4021018331 272064.7896085009 539, -1543604.9599950344 272081.2482573418 539, -1543623.497207763 272097.5144615583 539, -1543632.457957911 272105.03605815116 539, -1543644.9514070596 272111.6198515296 539, -1543659.4625196273 272115.72469301894 539, -1543666.7686865602 272116.28325269185 539, -1543683.2190406774 272114.6913170591 539, -1543703.9162067142 272122.1509206481 539, -1543738.1538403232 272148.314268535 539, -1543754.866255027 272163.77129157446 539, -1543768.003192751 272171.7564650802 539, -1543794.4627413165 272178.0569851892 539, -1543817.1006257576 272168.0685019316 539, -1543841.8267647696 272164.18905804213 539, -1543855.246461463 272171.2666945653 539, -1543869.8778260434 272186.9986342108 539, -1543887.8478712174 272216.8336727014 539, -1543892.9223599553 272229.36584408674 539, -1543896.1635512451 272234.70532118436 539, -1543906.0299209745 272248.9263079902 539, -1543913.8805776648 272253.8739966564 539, -1543914.7785843331 272254.1903394535 539, -1543930.6117138735 272263.1268399162 539, -1543936.2322064491 272268.29674680624 539, -1543942.5400023174 272271.52718593925 539)",
				"LINESTRING (-1541654.0360486822 272138.30774652865, -1541647.0017267326 272113.8122444086, -1541643.4923707924 272108.5037895087, -1541627.7064580126 272087.63818095974, -1541622.7878478137 272079.7075348122, -1541617.4761999631 272068.662202639, -1541612.5144970992 272059.74645881564, -1541609.1737840625 272054.6092363019, -1541601.987284965 272045.260115692, -1541598.35276568 272041.11696471146, -1541594.9250820875 272038.1081741517, -1541578.8952609906 272024.97259187815, -1541568.5413188685 272017.20884172636, -1541533.9612283532 271983.90877338254, -1541528.1736670102 271976.5328917511, -1541513.6287744679 271965.8458978987, -1541500.972781884 271954.7223629995, -1541493.4137057075 271946.5093088176, -1541482.7610113716 271931.9642434954, -1541479.349207535 271926.09045862785, -1541476.1738554433 271919.12818863423, -1541466.0014897108 271892.05031034653, -1541460.8744211604 271886.6289258693, -1541447.1647347133 271870.00433559605, -1541442.449813745 271863.4522482209, -1541439.6152143509 271858.2357400199, -1541433.0236824753 271842.26876569615, -1541425.6326320297 271827.1822090138, -1541420.9152351215 271812.84041445423, -1541419.055198978 271803.9173308183, -1541415.3880436542 271791.015212905, -1541412.295410896 271778.17278862797, -1541410.5699921732 271768.5489870311, -1541409.659784422 271758.39271378337)",
				"LINESTRING (-1543197.2160677467 273891.71333262196, -1543189.5835697397 273881.58599522116, -1543171.732646241 273864.1206518356, -1543165.0746877373 273858.6355145782, -1543132.1682108976 273837.43490449147, -1543118.7251567761 273831.40567563457, -1543108.5421706564 273828.7660318235, -1543104.5522079961 273828.1835177972, -1543059.550634323 273825.9639112311, -1543042.5141415463 273823.1568074227, -1543021.2751131158 273817.9003238768, -1543001.9744929508 273811.76977315865, -1542954.4029437127 273787.900697801, -1542941.824610261 273782.96405892423)",
				"LINESTRING (-1546568.7976514818 274505.84466035326, -1546550.7001355703 274488.9289882245, -1546540.5318152474 274478.4325781252, -1546532.5073012002 274468.91243737395, -1546522.6636004688 274454.9849553213, -1546503.4850292208 274439.2226632693, -1546481.5129959024 274418.3012695932, -1546468.4997261574 274408.77573734254, -1546448.1039802523 274392.44572393695, -1546423.2385666554 274369.0114905342, -1546397.834470453 274348.22383696784, -1546378.3555407359 274330.6139436494, -1546368.1037230177 274322.0268293857, -1546350.6969411199 274305.41444041516, -1546314.4937171026 274267.39833873557, -1546297.0585477883 274255.4285581259, -1546287.9364624673 274248.36663139705, -1546275.5439745544 274235.8871943402, -1546240.0646640537 274202.64951161196, -1546231.515626088 274195.6803281196, -1546209.5739611236 274179.50652778364, -1546203.9564952126 274175.5898226169, -1546196.2545889711 274171.1241728633, -1546186.9115605613 274167.05354040314, -1546162.8312754596 274157.7143698845, -1546158.3294402892 274155.49863541784, -1546155.3391058508 274152.34741216403, -1546149.1305301904 274147.54062566947, -1546133.4712159862 274137.15434529114, -1546086.1825947138 274112.6173658901, -1546066.2659616657 274101.50097908254, -1546052.0974461655 274096.18357548845, -1546030.9503595934 274090.42851055105, -1546021.155129974 274088.4713611852, -1545992.4037221896 274084.03903881746, -1545959.155624187 274080.90771582327, -1545925.8441602925 274080.35647482733, -1545914.6828072397 274084.6477743414, -1545889.7046248517 274095.485353777, -1545870.0373574526 274102.80593793374, -1545841.833041733 274110.97203282616, -1545813.3682975804 274118.4362632721, -1545787.537337709 274127.6001929455, -1545763.4098600403 274131.54629415524, -1545740.2399391092 274137.82027097006, -1545714.6770936723 274147.69072137686, -1545700.5123246685 274155.3392242876, -1545674.4461709273 274166.50730430323, -1545642.563914405 274183.59551463637, -1545629.0766181468 274189.8401652582, -1545621.3919852055 274194.8979593165, -1545605.5312284569 274206.42636738386, -1545578.4571779566 274223.3412583199, -1545572.3818821225 274226.09925363294, -1545567.154454776 274227.5451383755, -1545525.058640731 274248.55516916764, -1545513.357492831 274257.2133501952, -1545500.10308987 274265.40391217574, -1545486.9110843728 274272.51092893374, -1545471.892100932 274279.2040322488, -1545460.0177867697 274285.37002668047, -1545429.8809884933 274302.39528066403, -1545417.4343264876 274310.7165829606, -1545405.4041330984 274320.38116667187, -1545399.34922225 274323.4677704872, -1545391.969307401 274328.26758141513, -1545373.6711926188 274341.4898366778, -1545365.6661284498 274347.7911223568, -1545350.5429949365 274357.14014065696, -1545333.8860311953 274369.60525475594, -1545307.391101339 274385.8464350393, -1545296.468253976 274391.03201106365, -1545285.7915430043 274397.12825042545, -1545259.967583932 274414.46585252625, -1545231.912916149 274434.67858138436, -1545216.908781654 274446.97540316347, -1545198.9353265641 274460.93218122434, -1545185.816139488 274469.92333987344, -1545177.6498046804 274474.9952767037, -1545150.7318158504 274486.5884984151, -1545132.408550999 274496.2322757901, -1545098.5653806708 274508.65860091016, -1545076.569799029 274515.782887725, -1545055.4567282028 274520.62525543134, -1545025.0303372343 274532.45637714124, -1544997.5646331604 274539.11031924956, -1544979.9010313621 274544.99805696314, -1544944.1300198415 274554.21765638585, -1544926.6873773946 274552.9380415106, -1544918.428969053 274551.73511658766, -1544911.4593399568 274550.2196937453, -1544885.0457459448 274542.66426647484, -1544850.989467649 274531.88051599945, -1544839.8682384586 274527.80567542213, -1544828.9897254892 274522.93615509523, -1544820.4290370974 274518.71212421736, -1544799.6872422262 274506.80598187714, -1544787.2359280514 274493.9301329478, -1544760.4302213853 274462.234338742, -1544753.2007325075 274453.04010523134, -1544744.5945051822 274441.16957687086, -1544737.3980958916 274429.79684597364, -1544730.44078511 274417.29218392563, -1544724.4984513628 274402.3964192364, -1544716.426648229 274387.27150091704, -1544710.2893878852 274373.8408933159, -1544703.2378150779 274361.9949306979, -1544689.7665877377 274341.56544589397, -1544682.0918887109 274328.2803069066, -1544670.054292457 274302.8115938231, -1544665.0488759528 274293.49543355743, -1544661.761132333 274288.1611120543, -1544659.5952800012 274285.4065995112, -1544640.310114628 274262.969038813)",
				"LINESTRING (-1542650.243599813 272967.0920947947, -1542660.3174163715 272954.6452575155, -1542671.9771274503 272944.00548444426, -1542677.1433928916 272936.7532482013, -1542689.8045118141 272909.062254378, -1542701.0820325152 272879.5018213877, -1542705.1440341934 272871.2245964553, -1542710.2170696657 272863.8001391755, -1542713.1216785081 272860.5259609042, -1542717.8396584317 272857.00664612965, -1542726.1212013955 272851.7255464785, -1542745.888134252 272846.075237374, -1542759.3628263213 272844.4052490279, -1542771.6250510905 272841.92826561356, -1542793.651741307 272836.21927257837, -1542798.9513043154 272834.0714003818, -1542817.2373000851 272821.4986602306, -1542820.4228523313 272818.5668028142, -1542837.4284517253 272795.40127552295, -1542848.0253506422 272774.2697262183)",
				"LINESTRING (-1544479.52227361 274227.62592039694, -1544487.07228559 274222.53142320766, -1544494.9315594183 274218.21778995724, -1544500.3381775203 274216.0775033449, -1544509.1454366928 274213.5261092664, -1544513.0765184143 274212.97337402747, -1544528.8454128837 274212.3094341041, -1544548.7143403988 274213.61542834586, -1544554.6973449534 274213.4156145293, -1544619.488326051 274200.0904369443)",
				"LINESTRING (-1544348.31080465 273178.86483178573, -1544340.5075120118 273173.5756156584, -1544332.2402671303 273170.6080988177, -1544328.1643408975 273168.02593123884, -1544316.3368152392 273156.8202033818, -1544312.9027835175 273150.77018535347, -1544309.1675089954 273146.0304686207, -1544307.0637148856 273143.8869303264, -1544299.0252850181 273137.6546031416, -1544296.3084204393 273133.4787872484, -1544294.252618362 273103.0456843226, -1544294.9794226235 273092.27276345744, -1544297.8960295417 273072.1272448359, -1544297.650986501 273059.0668457858, -1544296.9317738242 273055.518120721, -1544296.1428515762 273053.7085189839, -1544291.2955253315 273048.1709774569, -1544287.5721060976 273046.21944665705, -1544270.4575509406 273040.01701326383, -1544259.4312888389 273037.18014099845, -1544252.394105829 273035.9515010483, -1544227.875668379 273032.9663387629, -1544184.755324657 273031.1668071347, -1544175.2165082789 273031.91911936953, -1544152.8481165876 273035.3912035156, -1544135.4047743294 273036.95101097814, -1544123.9199215635 273042.56002827454, -1544121.018827465 273043.22978215164, -1544119.1139599534 273042.94616746705, -1544108.0212063207 273039.37304148084, -1544103.8201858671 273037.38026234135, -1544098.385839081 273032.88881893, -1544092.8516070659 273025.99699757074, -1544088.3831946163 273017.4822629718, -1544081.846643925 272999.9925980812, -1544077.7534986641 272982.02125503373, -1544073.2652873965 272958.1576268032, -1544067.390819517 272942.0417441334, -1544063.3919120093 272933.05954971694, -1544059.4254040204 272926.2894634344, -1544055.9263361637 272922.53246518347, -1544043.8548544277 272916.55811456207)",
				"LINESTRING (-1542927.1135561932 273747.90450060717, -1542924.3785130964 273740.6547853967, -1542920.5457759858 273733.597435612, -1542919.560209999 273723.2110755825, -1542919.5407061183 273717.1752004262, -1542924.6295317276 273671.0603565612, -1542926.6934433305 273659.4416254696, -1542929.0924782923 273639.21986001235, -1542938.8674378847 273578.3373266777, -1542940.2035234282 273562.2876163926, -1542941.9591234117 273548.42951528996, -1542945.098525951 273530.3298318517, -1542945.6604221826 273524.19015265687, -1542945.2534354755 273516.53619598673, -1542943.0271103352 273502.3125572261, -1542940.6670351825 273493.516095225, -1542931.612596712 273472.3948814759, -1542925.126650862 273458.99419707165, -1542912.1887022564 273438.70880195237, -1542902.9041694114 273425.8995917289, -1542888.6457358138 273385.79411839525, -1542878.3114011406 273367.0459222026, -1542857.9365689026 273338.75322929706, -1542853.5696743277 273331.42268776265, -1542850.4319611576 273324.31370752834, -1542844.0644120104 273304.28658609564, -1542845.4800925618 273290.69543725444, -1542850.3321116152 273271.8894050201, -1542852.2665513558 273256.91263170436, -1542852.3668394934 273255.2605332676, -1542848.1571597029 273244.2894776769, -1542829.6355826193 273227.6360710112, -1542824.729248329 273221.3804167364, -1542820.8407878713 273212.8784198361, -1542816.201465879 273198.3981720177, -1542788.1275107926 273141.11610465776, -1542781.5974980707 273130.24005000165, -1542760.126034656 273092.26651600405, -1542749.382172749 273075.0673022, -1542734.0297571865 273057.28432988835, -1542713.9478143505 273036.3060249528, -1542704.8856435425 273023.5730489469, -1542698.1383045318 273015.71747959976, -1542685.8988789443 273004.15540648863, -1542669.8982801426 272994.01510035805, -1542662.8795939845 272987.30064608017, -1542660.193097642 272984.06578253093, -1542657.1544965298 272979.476194939, -1542650.243599813 272967.0920947947)",
				"LINESTRING (-1544619.488326051 274200.0904369443, -1544624.9573106205 274210.1846914235, -1544632.3471075369 274229.33550611127, -1544635.5988837543 274240.8503349745, -1544640.310114628 274262.969038813)",
				"LINESTRING (-1542927.1135561932 273747.90450060717, -1542933.6876792402 273762.0923528442, -1542938.0935409202 273774.49057797587, -1542941.824610261 273782.96405892423)",
				"LINESTRING (-1542388.5714434725 272259.6082883388, -1542388.875791193 272267.0090623258, -1542390.9141485412 272274.89116120915, -1542391.2773507396 272277.8590555394, -1542390.9090894666 272285.80565643, -1542389.5826281225 272293.6308534866, -1542386.7924409965 272299.58882297354, -1542374.7209504682 272312.4544760508, -1542368.27632241 272320.49794108066, -1542371.7951365535 272325.9142816655, -1542376.2373367443 272330.31648585387, -1542382.0354995856 272335.18154242606, -1542391.8755677498 272346.9811970235, -1542400.0906848786 272357.58972274425, -1542408.4910382037 272365.72354299895, -1542422.5831534313 272380.66388765833, -1542433.0430390134 272392.8370331671, -1542435.867866188 272396.621732049, -1542437.2739096973 272399.4232735882, -1542438.4153400557 272405.25709580304, -1542437.6452859596 272414.352546168)",
				"LINESTRING (-1544145.2440255096 273852.24970348086 538, -1544116.8345428335 273881.35199667607 538)",
				"LINESTRING (-1544348.31080465 273178.86483178573, -1544345.4886396423 273185.07100960973, -1544343.4253734644 273192.79716785497, -1544339.10525078 273204.2295874954, -1544334.6526192473 273218.37850439263, -1544331.1030744738 273226.77150455845, -1544326.3860585499 273240.8253948234, -1544323.7573782392 273246.64649273583, -1544317.871972889 273254.9274327598, -1544314.2039187746 273258.12069961, -1544308.4499213109 273261.69887632487, -1544298.088896566 273267.40293421305, -1544293.5748468118 273269.33314713446, -1544285.912231289 273270.2448749971, -1544248.3235450892 273276.21392817295, -1544234.4454489097 273282.9686670132, -1544230.6424183617 273286.44110345416, -1544224.1671303734 273293.9554218311, -1544220.4361455007 273305.2912406064, -1544217.5372018397 273316.4617310185, -1544217.9755032875 273322.2400304289, -1544219.527761207 273327.92707761796, -1544222.0441436972 273333.8275792472, -1544234.3812791968 273357.7433191641, -1544237.4429906758 273365.05882662756, -1544243.1528331651 273382.0231207257, -1544243.794117963 273385.90676741005, -1544243.4272716548 273397.7252084882, -1544241.7984780609 273423.03586291306, -1544242.680486141 273440.5094616313, -1544245.0279369422 273448.579584394, -1544255.2666630514 273472.2795618153, -1544256.8239769603 273474.55771469144, -1544288.035824834 273505.5943059388, -1544292.210962342 273510.22383231384, -1544348.9423563664 273559.99030681024, -1544356.0915227546 273572.66874206875, -1544361.4560103745 273579.28737443837, -1544365.177099243 273585.2205712134, -1544371.1567933597 273597.16941393045, -1544372.492616901 273601.07024946617, -1544373.537249056 273606.3042884863, -1544373.2246610103 273610.58315826027, -1544369.1797162131 273617.7039809389, -1544359.9335582673 273630.06684409996, -1544356.4755150361 273633.60081090743, -1544346.9624729499 273640.5853803024, -1544331.5174143855 273646.79305992485, -1544315.457909033 273655.10699334135, -1544312.0637387787 273657.34349615616, -1544301.0881593076 273676.32192923327, -1544300.2371003947 273679.35722946504, -1544299.663940533 273683.7312243064, -1544299.6562724132 273690.54512243817, -1544300.6894368045 273694.0942809706, -1544310.940664312 273717.5775722904, -1544318.2898113842 273732.05392087036, -1544327.9404982082 273762.02190927067, -1544334.7984272921 273796.63382962433, -1544335.499911991 273804.36719048786, -1544335.4075988359 273811.4096473814, -1544332.9423835122 273831.0447864518, -1544330.7990811772 273840.8432857603, -1544329.7094823758 273842.97121362586, -1544327.9545949365 273844.99762700393, -1544309.8708121728 273861.6783132782, -1544306.0640900035 273865.6371341635, -1544300.1652678798 273873.35070709826, -1544297.179620497 273878.3613639453, -1544294.1658476952 273890.45342577924, -1544293.722746809 273895.3165089064, -1544293.9809496216 273899.01116321166, -1544300.3188093794 273909.8731649205, -1544303.6770097897 273916.80112429115, -1544305.4401545466 273919.60762965307, -1544311.0269942887 273935.8802188482, -1544315.439380196 273949.64151455415, -1544323.9773729066 273987.53657362255, -1544325.0872367874 273998.2813511022, -1544324.9447067264 274005.48495867196, -1544321.7526902691 274019.2124318654, -1544308.3373828996 274046.9817703394, -1544307.028911436 274052.7493154409, -1544306.155084148 274068.79041702196, -1544309.2894111003 274084.0102460956, -1544317.2233814371 274100.9964135183, -1544335.5921557785 274133.20202868927, -1544338.2464068271 274139.9078486401, -1544339.4259628498 274146.5108867461, -1544339.179003797 274150.0250452315, -1544337.2696604019 274157.043406263, -1544332.8403385081 274167.06364183954)",
				"LINESTRING (-1544116.8345428335 273881.35199667607, -1544098.7729565038 273890.25873768836)",
				"LINESTRING (-1543942.5400023174 272271.52718593925 539, -1543949.483640325 272269.7759766048 539, -1543971.7953864606 272264.0395676829 539, -1544002.4941756006 272261.25784436055 539, -1544011.102880447 272261.1009024 539, -1544028.7421003813 272265.30223654397 539, -1544055.1308609133 272274.7680940833 539, -1544084.6453113602 272296.081241766 539, -1544106.6429128374 272314.57771547604 539, -1544120.6791059922 272322.8811370786 539, -1544134.6153846579 272334.17184352037 539, -1544148.981302988 272368.11075481214 539, -1544155.5082903497 272379.98047598917 539, -1544160.7671356767 272382.8410420362 539, -1544165.9118394363 272392.2089344496 539, -1544171.7928456897 272414.4281580541 539, -1544179.499005972 272437.45795630105 539, -1544184.000203729 272445.42448898405 539, -1544196.5626719752 272460.5967902681 539, -1544214.6052177008 272475.516708144 539, -1544234.8037417247 272505.13219960313 539, -1544243.6717605242 272533.7771687787 539, -1544253.7499815414 272550.2557500703 539, -1544256.6375752685 272559.6679245904 539, -1544254.4138836171 272578.02341502253 539, -1544257.6120573485 272586.70635761786 539, -1544258.844290069 272589.1550720548 539, -1544260.932021519 272595.26272223797 539)",
				"LINESTRING (-1541626.1047551383 272164.703444886, -1541654.0360486822 272138.30774652865)",
				"LINESTRING (-1542898.5981300608 273755.2666593753, -1542927.1135561932 273747.90450060717)",
				"LINESTRING (-1542418.6664191703 272877.5399690143, -1542452.503669909 272893.8086447461, -1542469.9585834383 272899.73826046014, -1542499.5640224458 272911.20190396265, -1542524.4189237915 272923.06343225617, -1542543.948644251 272929.8175919732, -1542573.4155718056 272942.45477186574, -1542581.3766670516 272945.258761076, -1542607.7408349337 272953.3910984223, -1542639.515518292 272964.62087004504, -1542650.243599813 272967.0920947947)",
				"LINESTRING (-1541654.0360486822 272138.30774652865, -1541662.7039619142 272155.6427371636, -1541667.4061054531 272163.3289971933, -1541678.982246084 272177.8838205569, -1541688.907193572 272191.22007791745, -1541703.3734229144 272207.4508623838, -1541725.119642806 272238.96307491034, -1541738.040720592 272254.4089540098, -1541745.4451754037 272262.22761901194, -1541758.4372148176 272272.33023108594, -1541762.8865446707 272279.25516649283, -1541768.6161045805 272290.4086656607, -1541774.3836674958 272305.4854963656, -1541778.9294074818 272315.4875542245, -1541789.3288453985 272333.3565671468, -1541792.1994153003 272337.31396618986, -1541800.328076331 272345.94931608933, -1541805.4916979051 272350.6451675397, -1541813.5024599286 272356.9848665561, -1541823.7013428323 272371.3403759396, -1541835.1648938188 272392.3176112426, -1541840.6002598635 272400.8219172685, -1541860.765428096 272424.46217883384, -1541869.6369944531 272433.29765756853, -1541873.3994686909 272441.8113356609, -1541881.1142342312 272457.2849837511, -1541895.6986239532 272479.99050693284, -1541905.2543774424 272493.08169014746, -1541913.8969971903 272500.21731570736, -1541923.9219839862 272511.23424110666, -1541928.185883635 272514.85799677315, -1541938.0495369025 272521.91640878754, -1541947.2096056878 272525.40524767636, -1541970.35803491 272531.644959825, -1541997.3072430633 272544.39160943095, -1542006.2515296794 272548.0067022622, -1542038.600842883 272559.66960962565, -1542052.3868185354 272563.98182921414, -1542069.9996857727 272571.2437006543, -1542074.242630313 272573.5473757417, -1542093.181720004 272586.17427665286, -1542101.5178335174 272592.90527337743, -1542116.7149781333 272606.9486383095, -1542133.870500035 272625.4383027598, -1542159.1758966546 272656.79235571244, -1542173.0870992804 272673.325946934, -1542187.9383822454 272695.70439610403, -1542196.2384727383 272706.13620845135, -1542223.578804344 272746.3355578023, -1542234.096999668 272759.17757200234, -1542251.2424344304 272772.5122149311, -1542266.0515870973 272781.1313157011, -1542272.271948574 272785.6297435559, -1542302.8344124032 272813.68319056166, -1542319.075591483 272824.90612354776, -1542341.0077387292 272835.6940563515, -1542358.4406903614 272845.57018153847, -1542373.335547437 272849.7495535711, -1542379.351327687 272852.160046571, -1542393.1191929514 272862.7434463863, -1542404.8463615533 272870.1703924567, -1542418.6664191703 272877.5399690143)",
				"LINESTRING (-1544098.7729565038 273890.25873768836, -1544089.779495842 273876.4368602667, -1544080.3877460656 273863.9291136999, -1544068.3965694194 273845.4111316103, -1544050.817630973 273825.53841875744, -1544041.307940618 273818.10881275445, -1544020.1035719228 273804.4350211236, -1543985.2676459488 273784.57879288006, -1543939.6083557955 273765.764532074, -1543934.0510662186 273763.8606378662, -1543888.1375772555 273751.98011404945, -1543872.0271872443 273748.9007617192, -1543843.3174069824 273744.8318755088, -1543787.6581363657 273740.97700937546, -1543777.6342161791 273741.0953335262, -1543765.3363793923 273742.50284560845, -1543745.3638700033 273743.8475770441, -1543707.10351008 273747.4988183775, -1543689.2286611593 273748.1265374215, -1543656.2311281515 273755.23903451435, -1543652.4436179395 273756.37235459196, -1543616.2626108998 273773.3996913061, -1543609.4501785066 273776.2235305634, -1543594.6744365306 273784.26248586754, -1543588.3180353658 273788.42752369435, -1543574.1996271934 273802.7110924399, -1543566.1726690393 273809.2871526432, -1543561.246902817 273814.1009817791, -1543542.0616725595 273836.5240070681, -1543535.6512776678 273847.9709280539, -1543529.8678297468 273860.0349265944, -1543527.1932981904 273866.59745720634, -1543514.7482265295 273891.19949838944, -1543506.1460068473 273911.63597802236, -1543499.6215098484 273924.5232290101, -1543492.7978901193 273936.6308358189, -1543482.5078877867 273952.42435733456, -1543475.582515344 273960.3232597194, -1543466.7357453532 273964.61517648085, -1543461.0379013838 273966.4811227281, -1543433.4877682067 273969.94862670585, -1543419.2297290359 273969.15817681205, -1543397.1213907008 273960.82313799474, -1543393.3103007572 273958.08388068463, -1543386.3547102818 273951.8244771252, -1543381.4831796018 273948.371526637, -1543361.129683615 273936.41685600654, -1543325.487742683 273921.53950714995, -1543316.883878582 273919.0658754663, -1543306.5755445214 273917.37581058627, -1543299.5033549482 273917.553256622, -1543288.069463218 273917.0007088275, -1543253.7808642336 273909.0612413779, -1543220.9062887512 273899.5081773908, -1543213.0303123118 273896.63632619206, -1543197.2160677467 273891.71333262196)",
				"LINESTRING (-1544260.932021519 272595.26272223797, -1544260.0228780422 272602.56966489577, -1544260.514648872 272604.3090064725, -1544269.9669849686 272615.2687734274, -1544288.5868547906 272634.9410535533, -1544293.3309351201 272640.7299958137, -1544294.9686355896 272643.5206496824, -1544299.4628593065 272654.94700836745, -1544309.117787236 272676.83483913535, -1544317.924543883 272694.3118019255, -1544326.2883497514 272707.59338611306, -1544342.7002422991 272730.47181720403, -1544359.2492771079 272755.7858059929, -1544372.9373909284 272768.8887848065, -1544384.7401692383 272774.33333201933, -1544411.1477958197 272784.1584130205, -1544419.048588694 272789.37705691776, -1544428.3344091184 272796.86052518175, -1544441.0522086476 272811.10245521046, -1544446.6838727817 272820.5199066385, -1544452.6867016742 272834.42106279224, -1544462.7996960003 272868.33995084086, -1544467.6342333332 272877.7499641593, -1544474.2328040095 272892.38528730633, -1544476.2800988497 272895.5606395603, -1544499.9603309354 272903.4119104978, -1544510.622716483 272908.2578317479, -1544525.5853089606 272916.15766424226, -1544528.9840084973 272918.5183449153, -1544534.4651112324 272923.5013106765, -1544539.052493702 272933.5311006967, -1544539.3955407701 272938.06559405715, -1544538.8900096428 272941.88633052126, -1544525.278062893 272989.095577415, -1544510.2400678957 273036.04978644, -1544503.8791545993 273064.45626541047, -1544492.77164205 273102.087010961, -1544490.422373474 273116.84515079774, -1544490.2613174734 273126.1860875714, -1544489.219317727 273133.7099411238, -1544487.5964481877 273137.66594559053, -1544485.7948633516 273140.83445030806, -1544476.4870656568 273153.024573815, -1544473.7976779817 273155.7186484448, -1544468.1375629338 273158.9690748416, -1544453.5294699913 273164.67677928467, -1544449.737212234 273165.7597238089, -1544436.5529728949 273168.0092907021, -1544385.45639841 273168.2810391255, -1544380.7605475509 273168.6009651608, -1544365.320197255 273171.5365575108, -1544348.31080465 273178.86483178573)",
				"LINESTRING (-1544479.52227361 274227.62592039694, -1544482.7039805232 274233.6161038171, -1544485.7032567633 274238.14751065505, -1544487.551323244 274240.47230595216, -1544491.4072381402 274244.0536953482, -1544497.1762271894 274248.1459262394, -1544517.9574477975 274259.7574616938)",
				"LINESTRING (-1543227.738367172 272330.4359783529, -1543230.3811164796 272328.379988553)",
				"LINESTRING (-1544059.1019366144 273486.3854441056, -1544087.9470540525 273476.80976089434, -1544104.5762763123 273472.86727688316, -1544119.5508291079 273486.4119855208, -1544122.1072342698 273491.1744016592, -1544125.9835531062 273499.36756418785, -1544129.2280951825 273507.7428368992, -1544131.8408604888 273516.30021976744, -1544133.5968151751 273524.0836134334, -1544134.8670439457 273532.97141690383, -1544135.464398745 273541.00664466154, -1544135.3944668479 273564.5615581762, -1544134.115384101 273578.3434520811, -1544132.509762925 273586.72805428726, -1544130.1356010141 273596.26608446176, -1544124.4303247393 273613.49801428075, -1544116.2941741603 273632.4006068139, -1544127.0414093342 273643.127604568, -1544147.1596929224 273665.2503194032, -1544156.7431359305 273676.60432206, -1544163.3518161706 273685.46720748494, -1544168.635088512 273693.79759682354, -1544186.2412077298 273724.9794770945, -1544191.1288068432 273735.80160272535, -1544194.224577291 273745.65159257763, -1544196.2371824281 273756.41082801437, -1544197.2864085354 273768.4746836078, -1544196.9158072218 273784.03361781867, -1544194.6703073028 273800.1545555369, -1544196.1016285373 273802.88785234874, -1544196.476359367 273807.1767118646, -1544145.2440255096 273852.24970348086)",
				"LINESTRING (-1541409.659784422 271758.39271378337, -1541401.2036083967 271745.2923866301, -1541391.9512951146 271732.2364084006, -1541362.1341554688 271695.24803531176, -1541356.3690526737 271687.2917067382, -1541351.1170018457 271679.0820806537, -1541346.8715972134 271670.6733111962, -1541344.065219744 271662.6631150755, -1541336.4626373346 271638.0506536184, -1541333.298996404 271625.7978324488, -1541328.3588737734 271618.81258640846, -1541317.5359334324 271606.0929841453, -1541308.2393056315 271593.4088145787, -1541299.1735684741 271578.4475239745, -1541280.4740475519 271563.978537276, -1541267.8087082596 271551.42016368825, -1541258.9186989658 271541.3472212635, -1541236.1742084385 271510.32718858874, -1541215.1070612671 271478.64333300095, -1541204.6090792334 271465.9572546518, -1541192.066528182 271452.02947723714, -1541182.0048078098 271439.9818751137, -1541167.0055137337 271420.6732789237, -1541155.3162002089 271403.99081720697, -1541151.9727462698 271398.0984594026, -1541145.1362643524 271385.0753721275, -1541133.4721832897 271364.2692946214, -1541126.8929773285 271350.52652274474, -1541118.826389355 271335.2938089526)",
				"LINESTRING (-1544517.9574477975 274259.7574616938, -1544533.0540122418 274265.63624793984, -1544558.5926847255 274278.72171098914, -1544567.3749207356 274281.0642176739, -1544575.9508324626 274281.86353605974, -1544582.8225119242 274281.65782316163, -1544588.83684019 274280.9591803562, -1544602.9897342613 274277.735076934, -1544620.4502022048 274271.60720004136, -1544640.310114628 274262.969038813)",
				"LINESTRING (-1543227.738367172 272330.4359783529, -1543224.5534224 272326.1719571456, -1543216.7940066992 272317.9063755229, -1543204.4958044908 272308.6142497207, -1543189.8455927009 272295.72766626196, -1543183.765768382 272287.0482929621, -1543170.5738379718 272260.5436033385, -1543162.13063687 272248.35672312824, -1543157.4435604804 272245.8668122946, -1543150.9370074123 272246.0245617291, -1543148.5706563743 272246.50575167785, -1543141.6306825122 272249.3706376306, -1543139.418274883 272250.58414438163, -1543138.304258944 272251.7020327846, -1543125.9723961833 272268.4813838543, -1543106.709573201 272296.9333721959, -1543100.9417417394 272308.0112299715, -1543093.326810256 272320.50107009744, -1543073.5937355068 272337.6295621636, -1543071.77621364 272338.519107401, -1543064.706460947 272340.5126213284, -1543053.0499306144 272340.6387313034, -1543041.0634832205 272339.508857424, -1543025.9176318578 272335.70182668784, -1543019.8135945713 272333.47115140996, -1543010.204963925 272328.790636074, -1542997.5617390985 272319.71071738563, -1542994.7412874438 272319.02170641656, -1542983.7209912261 272321.1562702844, -1542976.2942355035 272326.1070718262, -1542974.5486347815 272327.92647500726, -1542973.1207575465 272330.47590944666, -1542969.401894727 272345.96193901595, -1542969.2787230392 272360.8975970626, -1542968.8430417727 272363.88012412627, -1542967.912831558 272366.3310112056, -1542962.7764845055 272372.68073937396, -1542961.280797253 272373.3924204712, -1542954.662107851 272374.35600125615, -1542940.170227989 272373.91744995926, -1542897.3983973335 272361.41786648164, -1542874.0053700916 272348.6110006775, -1542861.1920773787 272337.7643340933, -1542852.1928831183 272329.9444974514, -1542843.0120835742 272316.3711401421, -1542838.96911909 272309.586233632, -1542831.5275558145 272300.5079916138, -1542826.506111431 272292.6600245495, -1542815.6827597048 272269.8293780155, -1542811.0801673438 272263.2410594921, -1542788.045934659 272252.44473163015, -1542728.2714641716 272236.2081813901, -1542716.3385789974 272231.79603800504, -1542698.1953605975 272225.76223452605, -1542655.2706271939 272206.7764091098, -1542623.3455873472 272197.6258184818, -1542620.4652698676 272197.267110798, -1542611.882223754 272197.048407202, -1542598.722798731 272199.40504486306, -1542584.7859158947 272203.59459783864, -1542577.0557297515 272206.736191437, -1542555.2228359857 272219.40245601814, -1542539.8935064957 272229.8782681946, -1542525.3631152923 272238.86266799027, -1542513.1387684387 272245.8411231476, -1542489.2297019132 272254.8759266269, -1542463.254462354 272262.0731903027, -1542455.5942880497 272263.81930253434, -1542443.2057685254 272264.64281208586, -1542422.7844474385 272262.6651033628, -1542398.4690294762 272258.8505654232, -1542393.5478240133 272258.840838026, -1542388.5714434725 272259.6082883388)",
				"LINESTRING (-1543197.2160677467 273891.71333262196, -1543190.6175828427 273898.12851217086, -1543183.8738934603 273902.9661933338, -1543177.4265528196 273905.89533277263, -1543174.296903997 273906.7042502991, -1543170.221542678 273907.102871393, -1543167.2381495207 273906.8918855079, -1543145.7076921659 273903.02496187785, -1543128.2677354063 273901.40679780504, -1543117.0885989591 273901.05634194135, -1543094.1400638986 273896.88995809417, -1543072.6912143189 273893.6130616815, -1543037.4254851968 273891.99485307396, -1543032.3249662127 273893.61137927906, -1543020.8789418035 273898.5508568557, -1543008.9387389775 273906.0572093859, -1543000.4320012112 273909.85091070604, -1542985.8195045306 273917.60793083214)",
				"LINESTRING (-1544043.8548544277 272916.55811456207, -1544031.8289733904 272911.2258713022, -1544019.5425309031 272907.0437707103, -1543973.0370872987 272893.4027995802, -1543941.2428277773 272884.97103753546, -1543894.162428094 272871.08122515783, -1543856.0122556263 272861.1939134258, -1543821.8779560416 272851.07930514426, -1543791.5472800387 272843.2500318793, -1543775.1979321123 272840.03445680614, -1543632.634029087 272799.15584370116, -1543575.2881677719 272781.8153735682, -1543558.2956158577 272775.30171233625, -1543549.6822470175 272771.2486459905, -1543535.9387244114 272763.35896190256, -1543522.579216141 272748.20416655304, -1543507.608634285 272724.3384549911, -1543505.7818050294 272721.84493364504, -1543498.7980260295 272714.5930160765, -1543491.3564327348 272703.73057013267, -1543490.1188291893 272697.19169728813, -1543490.0373301974 272691.9649086476, -1543492.888289676 272677.1158704847, -1543493.2056226525 272665.75942592614, -1543492.931471842 272659.3543351903, -1543491.5114530644 272654.9875883558, -1543478.8600258378 272629.3313778189, -1543472.5476920938 272613.9840148087, -1543462.8627532544 272601.1296428265, -1543443.8585734796 272582.28657045966, -1543438.2000234053 272578.3475622128, -1543431.691507945 272574.59142692824, -1543424.5962329626 272571.20339873765, -1543423.1492774177 272568.3813061684, -1543420.4357775846 272560.65248153114, -1543420.5555419244 272557.1192111017, -1543424.1823023185 272543.26954124676, -1543432.4400431796 272516.89584582794, -1543434.8558633851 272500.34386677394, -1543436.7895815612 272492.350686718, -1543438.7830855097 272487.1734358204, -1543448.8247236044 272467.0263550263, -1543449.4736175262 272464.7849316068, -1543449.8440256405 272457.8623835278, -1543446.2404136679 272446.51378871285, -1543443.9130003348 272442.1933319486, -1543442.4613807197 272441.0601723873, -1543439.3829562005 272439.5895021556, -1543434.5691810362 272440.9858673324, -1543423.218565771 272446.89258109475, -1543403.7266677243 272459.71134034626, -1543393.9131569406 272464.6234920833, -1543388.170794275 272463.9894317772, -1543385.2765770624 272463.0229539153, -1543382.6891520885 272461.6315732907, -1543378.9826114255 272458.4735339559, -1543376.3720315548 272455.49450823467, -1543374.7246061964 272453.1376820455, -1543374.7624340584 272452.1898051839, -1543375.4911312908 272448.2817091771, -1543379.1252070593 272437.1180808814, -1543384.6170613642 272425.12598938175, -1543386.473476576 272418.62501179316, -1543386.8450234435 272415.1045323908, -1543382.5554823615 272400.928021421, -1543380.31019136 272399.05536513426, -1543377.8183154687 272397.66051505046, -1543369.4855840313 272395.1911435183, -1543364.9889276444 272395.1782575836, -1543356.0235951974 272399.6570410187, -1543338.9304858271 272411.549309187, -1543313.3975873326 272431.740171874, -1543304.803920137 272439.16366603295, -1543297.9897725668 272442.97034270794, -1543293.0225369239 272442.4967795669, -1543290.2405956045 272441.6407919943, -1543280.7373013955 272436.36496696144, -1543273.0373980093 272431.5221096358, -1543265.3288585006 272427.99025900126, -1543257.205214624 272426.55740451894, -1543254.3975013383 272425.52685225, -1543250.3849531352 272423.2635219274, -1543245.4092554832 272416.4561349091, -1543242.7574544419 272411.2766954088, -1543241.7952031638 272405.5599703031, -1543243.6751559738 272392.8066655848, -1543244.0567534924 272386.12913249125, -1543249.0458299487 272370.3509190764, -1543248.4943019603 272360.06453515834, -1543245.4557629388 272354.15535559255, -1543227.738367172 272330.4359783529)",
				"LINESTRING (-1543230.3811164796 272328.379988553 540, -1543238.0115065267 272324.68792172056 539, -1543253.9951616796 272321.923346377 539, -1543268.3574993617 272325.9745379137 539, -1543276.4900347034 272330.01407482196 539, -1543279.053567928 272331.92373496946 539, -1543297.4507028284 272342.76873344835 539, -1543315.3023840573 272349.2242613584 539, -1543331.0662026487 272349.5722084623 539, -1543361.2995452923 272345.61494665686 539, -1543371.774891431 272342.92544233426 539, -1543391.7860425492 272340.57313916646 539, -1543407.6907904278 272346.34248840064 539, -1543437.4005327264 272364.3624729328 539, -1543449.8934807612 272370.9448339315 539, -1543460.6606689922 272373.73028228804 539, -1543470.9444379439 272374.3307359377 539, -1543517.6271284872 272368.7834361596 539, -1543537.4978557362 272361.00891003106 539, -1543579.027157592 272339.71271438524 539, -1543588.2711561345 272334.5749974139 539, -1543595.4355001391 272329.71171078645 539, -1543617.3854764926 272321.6636397131 539, -1543639.4147824259 272316.8338244306 539, -1543659.5668912672 272319.90300537366 539, -1543676.42024442 272329.03049777914 539, -1543699.2051205756 272342.59773213975 539, -1543712.5256603663 272364.41383731365 539, -1543727.7932412939 272375.1653541317 539, -1543768.0772789882 272387.51067155786 539, -1543789.2495745227 272390.77326176874 539, -1543800.078762644 272395.7632855484 539, -1543810.2284802285 272397.32490010094 539, -1543823.69249653 272389.309998245 539, -1543838.0126619337 272373.2023080401 539, -1543842.1113350748 272370.4485282833 539, -1543860.9409013428 272368.68938639294 539, -1543864.3518232922 272367.8759562224 539, -1543874.64434741 272363.1090619704 539, -1543878.9346429638 272357.06532565877 539, -1543881.8006094883 272351.863722994 539, -1543884.2151442657 272341.9699270865 539, -1543893.8218883376 272327.391187313 539, -1543893.2072699876 272314.41552316863 539, -1543893.8435394173 272309.43523186445 539, -1543898.5166712361 272287.74575785454 539, -1543903.7971889416 272272.6503076479 539, -1543912.476623515 272269.3281779075 539, -1543923.3150245717 272268.94990003295 539, -1543929.2885695351 272270.0479576979 539, -1543931.0854713044 272270.68109849375 539, -1543938.1084031109 272272.14816328976 539, -1543942.5400023174 272271.52718593925 539)",
				"LINESTRING (-1544332.8403385081 274167.06364183954, -1544336.6795285216 274172.0532321613, -1544345.7429257946 274182.07447206875, -1544350.866168731 274186.950067982, -1544358.0647264922 274191.309101464, -1544371.9143792074 274197.06817966985, -1544375.8215504014 274198.3800549215, -1544408.1890819513 274206.2797494814, -1544417.202175953 274209.1662277966, -1544442.3192800952 274215.46471264376, -1544464.363602795 274222.22881727834, -1544479.52227361 274227.62592039694)",
				"LINESTRING (-1542655.6749010424 273745.5854451535 538, -1542659.207415284 273744.6477402821 538, -1542680.4688261424 273750.2882712502 538, -1542698.79327204 273752.54587602615 538, -1542729.0200598494 273748.5864309147 538, -1542794.5595530898 273755.0500833923 538, -1542804.4266201623 273757.5182056613 538, -1542844.5592855734 273769.8074568873 538, -1542855.0606930421 273767.29477074463 538, -1542888.4583817085 273760.08852975443 538, -1542898.5981300608 273755.2666593753 538)",
				"LINESTRING (-1541409.659784422 271758.39271378337, -1541434.9117976928 271758.9375752181, -1541442.5057018516 271759.49489980796, -1541449.5040509494 271760.70491466206, -1541471.3437381387 271765.86684528104, -1541499.8842218362 271787.7644799797, -1541531.9308037676 271811.61533082975, -1541548.9684946914 271823.3587892419, -1541559.29696594 271829.75929212983, -1541596.3059046494 271858.6132212277, -1541615.637478274 271869.6959517156, -1541633.53080712 271876.3766628537, -1541653.3040152169 271885.19201410445, -1541661.1357112692 271889.1879649602, -1541695.3425011362 271903.53381542524, -1541706.3961726956 271910.08915346983, -1541716.7489501163 271918.03146422753, -1541726.892196298 271926.64641794225, -1541741.547801533 271940.0894935167, -1541767.710554353 271967.0523500468, -1541796.2862031898 271990.120542128)",
				"LINESTRING (-1541156.3860765754 272357.328318079 546, -1541203.7647799782 272337.23392555676 544, -1541626.1047551383 272164.703444886 545)",
				"LINESTRING (-1542848.0253506422 272774.2697262183, -1542851.1910786394 272761.9150017339, -1542852.2199209486 272754.1225490094, -1542850.206341058 272748.33105557016, -1542848.2870436918 272744.8932782052, -1542843.406574165 272739.459355149, -1542831.635941551 272731.199522757, -1542830.01365177 272730.3284065756, -1542815.0720735772 272726.1744354399, -1542806.67897346 272726.178155599, -1542801.9620656294 272727.193013954, -1542799.8192574254 272728.1388277579, -1542787.0800625773 272736.11218015035, -1542781.6258104134 272742.52952608676, -1542774.2411249846 272752.6113671918, -1542769.902003882 272757.1114041447, -1542763.5870067074 272763.0185175013, -1542758.5250199896 272766.7635064556, -1542752.1661857595 272770.12178817735, -1542746.9622899222 272771.6506522925, -1542735.6214926068 272772.1539490394, -1542727.1756510385 272770.7821598542, -1542722.34770481 272769.468430381, -1542720.092032952 272768.53546490177, -1542716.3081161866 272766.164440255, -1542710.7913236606 272759.1607112139, -1542705.5685550617 272750.53233787825, -1542703.1267645264 272747.7219718707, -1542684.514597779 272736.1995505529, -1542678.0818911532 272733.8979131325, -1542666.7119099398 272730.85132483795, -1542646.955327487 272727.04219632974, -1542622.7764023107 272724.1514944944, -1542607.4556034806 272720.9332917167, -1542590.4171848334 272715.34467893397, -1542586.1304329564 272712.80736474297, -1542577.1445268325 272705.52113602636, -1542574.8007711163 272702.91375824844, -1542572.0548071582 272692.812970102, -1542564.5981960234 272656.6514884085, -1542562.5478583688 272650.1737348771, -1542560.19449629 272649.04290937755, -1542554.8723943771 272648.7900772261, -1542541.5171125357 272650.3959487954, -1542530.074595677 272652.83198174345, -1542521.5447926982 272653.0530837838, -1542510.0884041637 272650.2631683785, -1542495.0138081994 272641.63625198626, -1542483.7218590465 272630.03571950324, -1542470.264588761 272615.40184630477, -1542464.5584614282 272606.13287305855, -1542458.8442054372 272594.53676282254, -1542456.3169412808 272588.27364322403, -1542455.2438260384 272584.56311814405, -1542452.8455902585 272569.0326749674, -1542452.6116022132 272562.4191193593, -1542460.343277508 272540.0307856369, -1542461.7528526601 272537.44883663073, -1542466.0224696042 272532.01625535154, -1542468.1381185837 272529.69811656803, -1542492.4006924755 272513.183501488, -1542494.8476620326 272510.7245501367, -1542498.3901520208 272504.6989797092, -1542501.915543251 272494.6685717898, -1542503.307453229 272485.3809950961, -1542503.2460662494 272481.1370803915, -1542501.7571647293 272476.38304445706, -1542499.6955417844 272472.8539388208, -1542491.441836949 272467.93919158226, -1542487.9084101098 272466.3778260424, -1542482.071954265 272466.4201423796, -1542476.523957193 272467.5878936397, -1542453.9675981496 272470.13006704673, -1542448.990093787 272470.05566980573, -1542445.248404082 272468.66918381804, -1542436.499269766 272464.2710806952, -1542430.728096009 272459.3228213248, -1542423.701837213 272448.10204473283, -1542423.0090221565 272445.3692620799, -1542422.898128267 272440.0630372115, -1542424.3030680062 272435.52634616866, -1542428.6070130435 272428.2238846465, -1542437.6452859596 272414.352546168)",
				"LINESTRING (-1544098.7729565038 273890.25873768836, -1544104.7581149638 273918.94755767065, -1544106.9960158328 273932.4738727635, -1544107.7106941484 273941.41927293676, -1544109.6462858948 273952.2649599442, -1544112.21530019 273961.90428584703, -1544124.2013569158 273993.22094819427, -1544128.6447875476 274002.12561998965, -1544147.5941095415 274031.7088310954, -1544162.118972859 274050.5042323017, -1544177.5927521056 274065.36168239964, -1544197.3533162577 274079.3172285673, -1544223.6339876144 274095.5951963593, -1544253.2844365207 274114.8045775559, -1544275.0001768612 274131.88544230774, -1544299.2875496284 274148.5553231075, -1544312.2375649253 274159.098228177, -1544317.4954427835 274162.2419277643, -1544321.5661010565 274164.0039261496, -1544326.5582347019 274165.63991981273, -1544332.8403385081 274167.06364183954)", };

		directionalize(edges, new Coordinate(-1546568.7976514818, 274505.84466035326));
	}

	@Test
	public void testMultiSinks() throws Exception {
		String[] edges = new String[] { "LINESTRING (339 745, 329 605)", "LINESTRING (374 418, 260 419)",
				"LINESTRING (329 605, 226 574, 260 419)", "LINESTRING (520 518, 705 480)",
				"LINESTRING (520 518, 374 418)", "LINESTRING (329 605, 520 518)", "LINESTRING (260 419, 140 239)" };

		List<Coordinate> sinks = new ArrayList<>();
		sinks.add(new Coordinate(705, 480));
		sinks.add(new Coordinate(140, 239));

		DGraph graph = makeGraph(edges);
		Directionalizer dd = new Directionalizer();
		dd.directionalize(graph, sinks);

		printEdges(graph);
	}

	private DGraph makeGraph(String[] edges) throws ParseException {
		int i = 0;
		WKTReader reader = new WKTReader();
		List<EdgeInfo> gedges = new ArrayList<>();
		HashMap<FeatureId, LineString> flows = new HashMap<>();
		for (String e : edges) {
			LineString ls = (LineString) reader.read(e);
			ls = (LineString) ls.reverse();
			EdgeInfo info = new EdgeInfo(ls.getCoordinates()[0], ls.getCoordinateN(ls.getCoordinates().length - 1),
					EfType.SKELETON, new FeatureIdImpl(i + ""), ls.getLength(), DirectionType.UNKNOWN);
			i++;
			gedges.add(info);
			flows.put(info.getID(), ls);
		}

		DGraph graph = DGraph.buildGraphLines(gedges);
		return graph;
	}

	private void printEdges(DGraph g) {
		g.edges.forEach(e -> {
			if (e.getID() != null)
				e.print();
		});
	}

	private void directionalize(String[] edges, Coordinate sink) throws Exception {
		ArrayList<Coordinate> sinks = new ArrayList<>();
		sinks.add(sink);

		for (String s : edges)
			System.out.println(s);
		System.out.println("---");

		DGraph graph = makeGraph(edges);
		Directionalizer dd = new Directionalizer();
		dd.directionalize(graph, sinks);

		printEdges(graph);
	}
}
