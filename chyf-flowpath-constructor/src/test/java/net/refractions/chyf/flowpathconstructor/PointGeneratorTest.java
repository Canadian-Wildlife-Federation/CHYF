/*
 * Copyright 2019 Government of Canada
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); 
 * you may not use this file except in compliance with the License. 
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software 
 * distributed under the License is distributed on an "AS IS" BASIS, 
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
 * See the License for the specific language governing permissions and 
 * limitations under the License.
 */
package net.refractions.chyf.flowpathconstructor;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

import org.junit.Assert;
import org.junit.Test;
import org.locationtech.jts.geom.Coordinate;
import org.locationtech.jts.geom.GeometryFactory;
import org.locationtech.jts.geom.LineString;
import org.locationtech.jts.geom.Point;
import org.locationtech.jts.geom.Polygon;
import org.locationtech.jts.geom.PrecisionModel;
import org.locationtech.jts.io.WKTReader;

import net.refractions.chyf.datasource.DirectionType;
import net.refractions.chyf.datasource.FlowDirection;
import net.refractions.chyf.flowpathconstructor.ChyfProperties.Property;
import net.refractions.chyf.flowpathconstructor.datasource.IFlowpathDataSource.NodeType;
import net.refractions.chyf.flowpathconstructor.datasource.TerminalNode;
import net.refractions.chyf.flowpathconstructor.skeletonizer.points.BoundaryEdge;
import net.refractions.chyf.flowpathconstructor.skeletonizer.points.ConstructionPoint;
import net.refractions.chyf.flowpathconstructor.skeletonizer.points.PointGenerator;
import net.refractions.chyf.flowpathconstructor.skeletonizer.points.PolygonInfo;

/**
 * Test cases for testing the point generator.
 * 
 * @author Emily
 *
 */
public class PointGeneratorTest {

	private WKTReader reader = new WKTReader(new GeometryFactory(new PrecisionModel()));
	
	private PointGenerator createPointGenerator() {
		ChyfProperties prop = new ChyfProperties();
		prop.setProperty(Property.PNT_VERTEX_DISTANCE, 0.0001);
		return new PointGenerator(Collections.emptyList(), prop);
	}
	
	@Test
	public void testIsolatedWaterbodyWithAoiIntersection() throws Exception{
		String waterbody = "POLYGON((-134.20654679999998 68.303493,-134.2074862 68.30316189999999,-134.2084256 68.3028308,-134.2091222 68.302716,";
		waterbody += "-134.2098188 68.3026012,-134.21043709999998 68.3026369,-134.2110554 68.3026726,-134.21217249999998 68.30280929999999,";
		waterbody += "-134.21317779999998 68.3031109,-134.21367375 68.30335395,-134.21416969999999 68.303597,-134.21462279999997 68.30377775,";
		waterbody += "-134.2150759 68.3039585,-134.2153531 68.30405535,-134.2156303 68.30415219999999,-134.21580409999999 68.30416319999999,";
		waterbody += "-134.21591429999998 68.3041569,-134.2160448 68.30414529999999,-134.2161753 68.3041337,-134.2157288 68.3044429,-134.2152255 68.3046428,";
		waterbody += "-134.2150433 68.3046114,-134.2149246 68.3045973,-134.2148288 68.3046111,-134.2145449 68.30467425,-134.214261 68.3047374,-134.2136932 68.3048637,";
		waterbody += "-134.213151825 68.304918025,-134.21261045 68.30497235,-134.21152769999998 68.305081,-134.21044494999998 68.30518964999999,-134.2093622 68.30529829999999,";
		waterbody += "-134.20854 68.30521999999999,-134.2077127 68.3050751,-134.2070177 68.3050312,-134.206727 68.3051187,-134.20655159999998 68.3052665,";
		waterbody += "-134.2068763 68.3055318,-134.2075214 68.3059165,-134.20733669999998 68.3061232,-134.2070842 68.3064381,-134.2068333 68.3065943,";
		waterbody += "-134.2065172 68.3066206,-134.20623659999998 68.30656979999999,-134.20609579999999 68.3064485,-134.2055991 68.3062848,-134.2048294 68.30617,";
		waterbody += "-134.20414789999998 68.30594169999999,-134.2038351 68.3056507,-134.2033349 68.30553309999999,-134.2029535 68.3054296,-134.2026941 68.3052941,";
		waterbody += "-134.20316235 68.3049962,-134.2036306 68.3046983,-134.20428535 68.3044419,-134.2049401 68.3041855,-134.20574345 68.30383925000001,-134.20654679999998 68.303493))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "1"));
		
		TerminalNode tn = new TerminalNode( (Point)reader.read("POINT (-134.2157288 68.3044429)"), FlowDirection.OUTPUT);
		LineString bs = (LineString) reader.read("LINESTRING (-134.2161753 68.3041337, -134.2157288 68.3044429, -134.2152255 68.3046428)");
		BoundaryEdge be = new BoundaryEdge(bs, tn);
		
		ChyfProperties prop = new ChyfProperties();
		prop.setProperty(Property.PNT_VERTEX_DISTANCE, 0.0001);
		PointGenerator gen = new PointGenerator(Collections.singletonList(be), prop);
		
		gen.processPolygon(polygon, Collections.emptyList(), Collections.emptyList(), Collections.emptyMap());
		List<ConstructionPoint> pnts = gen.getPoints();
		
		//there should be three 
		Assert.assertEquals("invalid number of nodes", 3, pnts.size());
		
		//the terminal node must be one
		boolean foundtn = false;
		boolean foundhead = false;
		boolean foundbank = false;
		for (ConstructionPoint pnt : pnts) {
			if (pnt.getCoordinate().equals2D(tn.getPoint().getCoordinate())) {
				if (pnt.getDirection() != FlowDirection.OUTPUT) Assert.fail("Construction point flow direction is wrong");
				if (pnt.getType() != NodeType.WATER) Assert.fail("Construction point node type is wrong");
				foundtn = true;
			}
			if (pnt.getDirection() == FlowDirection.INPUT && pnt.getType() == NodeType.BANK) foundbank = true;
			if (pnt.getDirection() == FlowDirection.INPUT && pnt.getType() == NodeType.HEADWATER) foundhead = true;
			
		}
		
		if (!foundtn) Assert.fail("Construction point at terminal node not found");
		if (!foundhead) Assert.fail("Headwater construction point not found");
		if (!foundbank) Assert.fail("Bank construction point not found");
	}
	
	
	@Test
	public void testIsolatedSelfIntersecting() throws Exception{
		String waterbody = "Polygon ((-91.34740490000000079 47.64300370000000129 0, -91.34742690000000209 47.64268030000000209 0, -91.34745859999999595 47.64243820000000085 0, -91.3476272999999992 47.64222389999999763 0, -91.34780379999999411 47.64209900000000175 0, -91.34800429999999949 47.64200569999999857 0, -91.34822250000000565 47.64199380000000161 0, -91.34845669999999984 47.6420533000000006 0, -91.34862529999999481 47.64214659999999668 0, -91.34885149999999499 47.6422339000000008 0, -91.34917489999999418 47.64231920000000287 0, -91.34951420000000155 47.64245609999999687 0, -91.34970859999999959 47.64262070000000193 0, -91.34996850000000279 47.6428212000000002 0, -91.35015500000000088 47.64305130000000332 0, -91.35028599999999699 47.64345610000000164 0, -91.35047240000000102 47.64363660000000067 0, -91.35071449999999516 47.64381720000000087 0, -91.35082950000000324 47.6440076000000019 0, -91.35094259999999622 47.64409100000000308 0, -91.35124020000000655 47.64414450000000301 0, -91.35159529999999961 47.64426960000000122 0, -91.35173430000000394 47.64448780000000028 0, -91.35175220000000706 47.64478940000000051 0, -91.35191480000000297 47.64496400000000165 0, -91.35208339999999794 47.64510680000000065 0, -91.35219050000000607 47.64523179999999769 0, -91.35219850000000008 47.64532510000000087 0, -91.35218270000000018 47.64543019999999984 0, -91.35209340000000111 47.64544610000000091 0, -91.35189300000000401 47.6454956999999979 0, -91.35170050000000685 47.64559489999999897 0, -91.35162699999999347 47.64576950000000011 0, -91.3517242000000067 47.64587470000000025 0, -91.35194239999999866 47.6459501000000003 0, -91.3520476000000059 47.6460095999999993 0, -91.3520575000000008 47.64622390000000252 0, -91.35197019999999668 47.6464162999999985 0, -91.35168840000000046 47.64678930000000179 0, -91.35144040000000132 47.64699770000000001 0, -91.3512797000000063 47.64709679999999992 0, -91.3510454999999979 47.64708100000000002 0, -91.35102179999999805 47.64710879999999804 0, -91.35104560000000617 47.64726149999999905 0, -91.35095819999999378 47.64740429999999805 0, -91.35067650000000583 47.64742220000000117 0, -91.35034520000000668 47.64742220000000117 0, -91.35008729999999844 47.64736270000000218 0, -91.349747899999997 47.64742809999999906 0, -91.34937089999999671 47.64757300000000129 0, -91.34895819999999844 47.6476602999999983 0, -91.34839470000000006 47.64770000000000039 0, -91.34796810000000278 47.64774560000000037 0, -91.34750789999999654 47.64780700000000024 0, -91.34711299999999312 47.6478468000000035 0, -91.34677369999999996 47.6478188999999972 0, -91.34645820000000072 47.64774950000000331 0, -91.34601569999999526 47.64767210000000119 0, -91.34562689999999918 47.64754709999999704 0, -91.34539279999999906 47.64742220000000117 0, -91.34515860000000487 47.64729119999999796 0, -91.34495630000000688 47.6470729999999989 0, -91.34478369999999359 47.64672170000000051 0, -91.34465470000000664 47.64649359999999945 0, -91.34449999999999648 47.6462416000000033 0, -91.34445039999999949 47.64599549999999795 0, -91.34448209999999335 47.64572569999999985 0, -91.34458539999999971 47.64536470000000179 0, -91.34464690000000076 47.64509089999999958 0, -91.34465480000000071 47.64477939999999734 0, -91.34460520000000372 47.64454920000000016 0, -91.34453179999999861 47.64432500000000203 0, -91.34451400000000376 47.64417619999999687 0, -91.34453779999999767 47.64392420000000072 0, -91.34453589999999679 47.64365039999999851 0, -91.34451009999999371 47.64338860000000153 0, -91.3445497999999958 47.64307500000000317 0, -91.34470059999999592 47.64246800000000093 0, -91.34465899999999294 47.64212669999999861 0, -91.34460939999999596 47.64189259999999848 0, -91.34454200000000412 47.64164060000000234 0, -91.34458960000000616 47.64142040000000122 0, -91.34462929999999403 47.64123390000000313 0, -91.34453999999999496 47.64105330000000293 0, -91.34422460000000399 47.64083500000000271 0, -91.34411740000000179 47.64057309999999745 0, -91.34405200000000491 47.64026170000000349 0, -91.34381000000000483 47.64000370000000117 0, -91.34355800000000158 47.63980130000000202 0, -91.34348450000000241 47.63957709999999679 0, -91.34353219999999851 47.63931519999999864 0, -91.3434587999999934 47.63911689999999766 0, -91.34328019999999526 47.63902949999999947 0, -91.34301440000000127 47.6389204000000035 0, -91.34273860000000411 47.63875769999999932 0, -91.34251240000000394 47.63851760000000013 0, -91.34234179999999981 47.6383371000000011 0, -91.3419946000000067 47.63817240000000197 0, -91.34177630000000647 47.63809109999999691 0, -91.34156600000000026 47.63800969999999779 0, -91.34141920000000425 47.63792829999999867 0, -91.34144299999999816 47.63777950000000061 0, -91.34163560000000359 47.63760489999999947 0, -91.34186959999999544 47.63741250000000349 0, -91.34208599999999478 47.63726369999999832 0, -91.34239940000000502 47.63715260000000029 0, -91.34271490000000426 47.63707120000000117 0, -91.34301250000000039 47.63703749999999815 0, -91.34323879999999463 47.6370355000000032 0, -91.34327840000000265 47.63705730000000216 0, -91.34420699999999727 47.63702359999999913 0, -91.3447625999999957 47.6370773000000014 0, -91.34521499999999605 47.63720219999999728 0, -91.34549869999999316 47.63740860000000055 0, -91.34575859999999636 47.63774790000000081 0, -91.34596089999999435 47.63809899999999686 0, -91.34610770000000457 47.63833910000000316 0, -91.34610960000000546 47.63872800000000041 0, -91.34629019999999855 47.63929149999999879 0, -91.34654020000000685 47.63952760000000097 0, -91.34704209999999591 47.63975570000000204 0, -91.34751830000000439 47.64003350000000125 0, -91.34760959999999841 47.64033510000000149 0, -91.34753809999999419 47.64063670000000172 0, -91.34723259999999811 47.64088869999999787 0, -91.34695069999999362 47.64112080000000304 0, -91.34675230000000568 47.64143829999999724 0, -91.34671269999999765 47.64182710000000043 0, -91.3467959000000036 47.64224769999999864 0, -91.34692680000000564 47.64252749999999992 0, -91.34702409999999873 47.64270210000000105 0, -91.34712129999999775 47.64282910000000015 0, -91.3472026000000028 47.64292230000000217 0, -91.34733149999999569 47.64297590000000326 0, -91.34740490000000079 47.64300370000000129 0),(-91.34766299999999717 47.64296999999999827 0, -91.34740490000000079 47.64300370000000129 0, -91.347462500000006 47.64318420000000032 0, -91.34759139999999888 47.64337069999999841 0, -91.34774430000000223 47.64339650000000148 0, -91.34789109999999823 47.64340250000000054 0, -91.34805179999999325 47.64336870000000346 0, -91.34812320000000341 47.64334089999999833 0, -91.34848639999999875 47.64320409999999839 0, -91.34868679999999586 47.64304340000000337 0, -91.34871859999999799 47.64282510000000315 0, -91.34871660000000304 47.642567200000002 0, -91.34866689999999778 47.64231519999999875 0, -91.3486015000000009 47.6422339000000008 0, -91.34840900000000374 47.64226159999999766 0, -91.34816890000000456 47.64244810000000285 0, -91.34801620000000355 47.64274369999999692 0, -91.34792880000000537 47.64293030000000329 0, -91.34787120000000016 47.64301960000000236 0, -91.34766299999999717 47.64296999999999827 0))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "1"));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), Collections.emptyList(), Collections.emptyMap());
		List<ConstructionPoint> pnts = pg.getPoints();
	
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-91.3474269, 47.6426803),NodeType.HEADWATER,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-91.344514, 47.6441762),NodeType.TERMINAL,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-91.3487186, 47.6428251),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-91.3430125, 47.6370375),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}		
	
	@Test
	public void testSelfIntersecting() throws Exception{
		String waterbody = "POLYGON (( 505 391, 427 428, 371 526, 408 618, 495 677, 631 690, 830 672, 983 590, 1024 464, 770 318, 597 357, 505 391 ), ( 830 672, 677 608, 663 571, 677 498, 762 488, 876 534, 876 587, 830 672 ))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "1"));
		
		String ls1 = "LINESTRING ( 243 794, 408 618 )";
		String ls2 = "LINESTRING ( 770 318, 987 189 )";
		
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
	
		pnts.forEach(e->e.toText());
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(408.0, 618.0),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(770.0, 318.0),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(505.0, 391.0),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(677.0, 498.0),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(730.5, 681.0),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		
		Assert.assertEquals("invalid number of updated polygons", 1, pg.getUpdatedPolygons().size());
		Polygon expectedpg = (Polygon) reader.read("POLYGON ((505 391, 427 428, 371 526, 408 618, 495 677, 631 690, 730.5 681, 830 672, 983 590, 1024 464, 770 318, 597 357, 505 391), (830 672, 677 608, 663 571, 677 498, 762 488, 876 534, 876 587, 830 672))");
		Assert.assertTrue("Polygon coordinates not updated", equals(pg.getUpdatedPolygons().iterator().next(), expectedpg));

	}
	
	
	@Test
	public void wbTouchAtPoint() throws Exception{
		String waterbody = "POLYGON ((676.3 950, 923.1 983, 1125.2 865.4, 1154.6 715, 778.6 744.4, 615.2 888.9, 676.3 950))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "1"));

		String other = "POLYGON ((1376.7 750.3, 1154.6 715, 1139.3 629.2, 1181.7 474.1, 1350.9 417.7, 1464.9 410.7, 1576.5 519.9, 1517.7 712.7, 1376.7 750.3))";
		Polygon otherp = (Polygon)reader.read(other);
		otherp.setUserData(new PolygonInfo(null, "2"));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), Collections.emptyList());
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(1154.6, 715.0),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(615.2, 888.9),NodeType.HEADWATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(778.6, 744.4),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void wbTouchAtLineWithFlowpath() throws Exception{

		String waterbody = "POLYGON ((373.2 380.1, 46.5 571.7, -139.2 424.8, 275.6 207.4, 326.1409795038991 296.8306061508542, 373.2 380.1))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String other = "POLYGON ((-518.8 630.4, -449.0938715776263 709.594356266409, -389.5 777.3, 46.5 571.7, -139.2 424.8, -518.8 630.4))";
		Polygon otherp = (Polygon)reader.read(other);

		String[] items = new String[] {"LINESTRING (-643.3 870.1, -449.0938715776263 709.594356266409)",
		"LINESTRING (74.7 833.7, 98.2 670.4, 46.5 571.7)",
		"LINESTRING (326.1409795038991 296.8306061508542, 501.2 182.7)",};

		List<LineString> fps = new ArrayList<>();
		for (String i : items) {
			fps.add((LineString)reader.read(i));
		}
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), fps);
		List<ConstructionPoint> pnts = pg.getPoints();
	
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(46.5, 571.7),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(326.1409795038991, 296.8306061508542),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-46.349999999999994, 498.25),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(373.2, 380.1),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(275.6, 207.4),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		pg.processPolygon(otherp, Collections.singletonList(polygon), fps);
		pnts = pg.getPoints();
	
		expected.add(new ConstructionPoint(new Coordinate(46.5, 571.7),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate( -449.0938715776263, 709.594356266409),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-46.349999999999994, 498.25),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-389.5, 777.3),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-518.8, 630.4),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void wbTouchAtPointWithFlowth() throws Exception{
		String waterbody = "POLYGON ((676.3 950, 923.1 983, 1125.2 865.4, 1154.6 715, 778.6 744.4, 615.2 888.9, 676.3 950))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "1"));

		String other = "POLYGON ((1376.7 750.3, 1154.6 715, 1139.3 629.2, 1181.7 474.1, 1350.9 417.7, 1464.9 410.7, 1576.5 519.9, 1517.7 712.7, 1376.7 750.3))";
		Polygon otherp = (Polygon)reader.read(other);
		otherp.setUserData(new PolygonInfo(null, "2"));

		LineString ls = (LineString)reader.read("LINESTRING ( 1293.3 981.8, 1232.2 831.4, 1154.6 715 )");
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), Collections.singletonList(ls));
		List<ConstructionPoint> pnts = pg.getPoints();
	
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(1154.6, 715.0),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(615.2, 888.9),NodeType.TERMINAL,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(778.6, 744.4),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void wbMultiLineSamePoint() throws Exception{
		String waterbody = "POLYGON ((676.3 950, 923.1 983, 1125.2 865.4, 1154.6 715, 778.6 744.4, 615.2 888.9, 676.3 950))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		polygon.setUserData(new PolygonInfo(null, "2"));

		LineString ls1 = (LineString)reader.read("LINESTRING ( 355.5 994.7, 615.2 888.9 )");
		LineString ls2 = (LineString)reader.read("LINESTRING ( 379 783.2, 615.2 888.9 )");
		ArrayList<LineString> streams = new ArrayList<>();
		streams.add(ls1);
		streams.add(ls2);
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), streams);
		List<ConstructionPoint> pnts = pg.getPoints();
	
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(1125.2, 865.4),NodeType.TERMINAL,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(615.2, 888.9),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(923.1, 983.0),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testNs() throws Exception{
		String waterbody = "Polygon ((-63.65647649999999658 44.5014409999999998 0, -63.65811469999999872 44.50242709999999846 0, -63.6596964000000014 44.50337929999999886 0, -63.65971820000000037 44.50392850000000067 0, -63.66020209999999935 44.50464519999999879 0, -63.65957269999999824 44.50657259999999837 0, -63.65913119999999736 44.50791929999999752 0, -63.65871659999999821 44.50821069999999935 0, -63.65845960000000048 44.50788169999999866 0, -63.6582808 44.5078029000000015 0, -63.65789259999999672 44.50839489999999898 0, -63.6576110999999969 44.50839690000000104 0, -63.65730400000000344 44.50848919999999964 0, -63.65698309999999793 44.50837599999999838 0, -63.65671269999999993 44.50797159999999764 0, -63.65709989999999863 44.50780989999999804 0, -63.65724550000000193 44.50748529999999903 0, -63.65795789999999954 44.50746850000000165 0, -63.65793550000000067 44.50706929999999772 0, -63.65778720000000135 44.50678200000000118 0, -63.65746730000000042 44.50677929999999805 0, -63.65732650000000348 44.50644470000000297 0, -63.65727929999999901 44.5057054999999977 0, -63.65711960000000147 44.50556399999999968 0, -63.65689650000000199 44.50548830000000322 0, -63.65677339999999873 44.5052607000000009 0, -63.6561647999999991 44.50489670000000331 0, -63.65577960000000246 44.50473860000000315 0, -63.65529599999999988 44.50469300000000317 0, -63.65469650000000001 44.50424230000000136 0, -63.65444080000000326 44.50415399999999977 0, -63.65413470000000018 44.50435689999999767 0, -63.653593800000003 44.50449950000000143 0, -63.65331050000000346 44.5044107000000011 0, -63.65286340000000109 44.50414870000000178 0, -63.65261869999999789 44.50365409999999855 0, -63.65245579999999848 44.50359149999999886 0, -63.65229970000000037 44.50363159999999851 0, -63.65226590000000328 44.5039190999999974 0, -63.65187350000000066 44.50393849999999674 0, -63.6514205000000004 44.5036843000000033 0, -63.65066960000000051 44.50356599999999929 0, -63.65044610000000347 44.50322969999999856 0, -63.65015439999999813 44.5030775000000034 0, -63.64991789999999838 44.50238559999999666 0, -63.64960479999999876 44.501814600000003 0, -63.64953419999999795 44.50151699999999977 0, -63.64928220000000181 44.501069600000001 0, -63.6485422000000014 44.50041459999999915 0, -63.64793819999999869 44.50021240000000233 0, -63.64779300000000006 44.5 0, -63.64773249999999649 44.49998310000000146 0, -63.64772870000000182 44.49967110000000048 0, -63.64760420000000352 44.49961330000000004 0, -63.64729950000000258 44.49964630000000199 0, -63.64722619999999864 44.4998185000000035 0, -63.64711259999999982 44.49976480000000123 0, -63.64687450000000268 44.49965319999999736 0, -63.6467747000000017 44.49939450000000107 0, -63.64630830000000117 44.49906500000000165 0, -63.64557640000000305 44.49875360000000057 0, -63.64541289999999663 44.49884089999999759 0, -63.64509549999999649 44.49877899999999897 0, -63.64486910000000108 44.4986518999999987 0, -63.64472630000000208 44.49863700000000222 0, -63.64453470000000124 44.49833300000000236 0, -63.64459300000000042 44.49825529999999674 0, -63.64489189999999752 44.49822999999999951 0, -63.64556670000000338 44.49831910000000335 0, -63.64585389999999876 44.49830939999999657 0, -63.64592530000000181 44.49804639999999978 0, -63.64583950000000101 44.49758270000000238 0, -63.64611409999999836 44.49747789999999981 0, -63.64642140000000126 44.49751590000000334 0, -63.64690439999999683 44.49784189999999739 0, -63.64719250000000272 44.49781240000000082 0, -63.6473173999999986 44.49759000000000242 0, -63.64719029999999833 44.49746100000000126 0, -63.6468954999999994 44.49738769999999732 0, -63.64663699999999835 44.49709800000000115 0, -63.64666340000000133 44.49685780000000079 0, -63.64682690000000065 44.49677040000000261 0, -63.64734039999999737 44.49675750000000107 0, -63.64774080000000112 44.49708170000000251 0, -63.64803100000000313 44.49740359999999839 0, -63.64808409999999839 44.49772449999999679 0, -63.64854660000000308 44.49828289999999953 0, -63.64883569999999935 44.49836390000000108 0, -63.64895489999999967 44.49827959999999649 0, -63.64893800000000113 44.4981529000000009 0, -63.6486914999999982 44.49797800000000336 0, -63.64859109999999731 44.49786929999999785 0, -63.64858490000000302 44.49761649999999946 0, -63.64873839999999916 44.49750530000000026 0, -63.64855099999999766 44.4972329000000002 0, -63.64774349999999714 44.49661199999999894 0, -63.64760960000000267 44.49638019999999727 0, -63.64763270000000261 44.49621880000000118 0, -63.64783969999999869 44.49614820000000037 0, -63.64812450000000155 44.49619760000000213 0, -63.64870059999999796 44.49680970000000002 0, -63.64901119999999679 44.49676879999999812 0, -63.64920159999999782 44.49683199999999772 0, -63.64927420000000069 44.49680980000000119 0, -63.64931229999999829 44.49655400000000327 0, -63.64956670000000116 44.4964014999999975 0, -63.64962909999999852 44.49622509999999664 0, -63.64997900000000186 44.4962996000000004 0, -63.65020710000000292 44.49638720000000092 0, -63.65026139999999799 44.49640809999999647 0, -63.65139810000000153 44.4966647999999978 0, -63.65226859999999931 44.49695930000000033 0, -63.65264109999999675 44.49702239999999875 0, -63.65276939999999684 44.49739220000000017 0, -63.65250670000000355 44.49761170000000021 0, -63.65296769999999782 44.49820960000000269 0, -63.65395079999999695 44.49844720000000109 0, -63.65463729999999742 44.49906159999999744 0, -63.65455409999999858 44.49920989999999676 0, -63.65470549999999861 44.49941830000000209 0, -63.65455130000000139 44.4995492999999982 0, -63.65461400000000225 44.49963350000000162 0, -63.65519549999999782 44.49984700000000259 0, -63.65520089999999698 44.49957870000000071 0, -63.655796500000001 44.49971740000000153 0, -63.65595299999999668 44.5 0, -63.65592800000000295 44.5 0, -63.65590579999999932 44.50014999999999787 0, -63.65553549999999916 44.500438299999999 0, -63.65553309999999954 44.50049750000000159 0, -63.65598789999999951 44.50084259999999858 0, -63.65614620000000201 44.50115379999999732 0, -63.65647649999999658 44.5014409999999998 0),(-63.65477289999999755 44.50345039999999841 0, -63.6545810000000003 44.50301600000000235 0, -63.65412340000000313 44.50246959999999774 0, -63.65403789999999873 44.50226649999999751 0, -63.65360720000000327 44.50187059999999661 0, -63.65339540000000085 44.50151879999999949 0, -63.65298419999999879 44.50132070000000084 0, -63.65297199999999833 44.5009453999999991 0, -63.65261770000000041 44.50083930000000265 0, -63.65216219999999936 44.50051400000000257 0, -63.65184800000000109 44.5 0, -63.65125220000000184 44.49956329999999838 0, -63.65084209999999842 44.49947579999999903 0, -63.65053360000000282 44.49919690000000116 0, -63.65040549999999797 44.49895740000000188 0, -63.65023250000000132 44.49887079999999884 0, -63.65000640000000232 44.49900430000000284 0, -63.64996860000000112 44.4993904000000029 0, -63.65004059999999697 44.49951819999999714 0, -63.65047359999999799 44.49985490000000254 0, -63.65056500000000028 44.5 0, -63.65059769999999872 44.50019309999999706 0, -63.65055360000000206 44.50086720000000184 0, -63.65174129999999764 44.50163419999999803 0, -63.65208210000000122 44.50166500000000269 0, -63.65235539999999759 44.50186020000000298 0, -63.65238020000000319 44.50220029999999838 0, -63.65288509999999889 44.50253450000000299 0, -63.65294719999999984 44.50276879999999835 0, -63.65342979999999784 44.50324470000000332 0, -63.65360559999999879 44.50353259999999977 0, -63.65408800000000156 44.50387820000000261 0, -63.65462910000000107 44.50386579999999981 0, -63.65476670000000325 44.50373840000000314 0, -63.65477289999999755 44.50345039999999841 0))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String otherwb = "Polygon ((-63.65647649999999658 44.5014409999999998 0, -63.65660590000000241 44.50138050000000334 0, -63.65701669999999979 44.50090740000000267 0, -63.65712070000000011 44.50065690000000274 0, -63.65709449999999947 44.50048670000000328 0, -63.65659399999999835 44.5 0, -63.65645419999999888 44.49954950000000053 0, -63.65665779999999785 44.49942750000000302 0, -63.65690500000000185 44.49945230000000151 0, -63.65728500000000167 44.5 0, -63.65745679999999851 44.50039550000000332 0, -63.65782430000000147 44.50044659999999652 0, -63.65830100000000158 44.50038940000000309 0, -63.65874569999999721 44.50016970000000072 0, -63.65877600000000314 44.5 0, -63.65881379999999723 44.49944469999999797 0, -63.65889440000000121 44.49922540000000026 0, -63.65858029999999701 44.49867400000000117 0, -63.65827240000000131 44.4982451999999995 0, -63.65822610000000026 44.49802710000000161 0, -63.65753649999999908 44.49762189999999862 0, -63.65709259999999858 44.49728110000000214 0, -63.65682689999999866 44.49716899999999953 0, -63.65649710000000283 44.49714230000000015 0, -63.65636570000000205 44.49698169999999919 0, -63.65637459999999948 44.49676480000000112 0, -63.65662129999999763 44.4965290999999965 0, -63.65693290000000104 44.49659880000000101 0, -63.65723839999999711 44.49654590000000098 0, -63.65752410000000339 44.49616499999999775 0, -63.65756929999999869 44.49573170000000033 0, -63.6573254999999989 44.49521740000000136 0, -63.65734700000000146 44.49509549999999791 0, -63.65745379999999898 44.49504639999999966 0, -63.65791889999999853 44.49459420000000165 0, -63.65777990000000131 44.49435050000000302 0, -63.65770390000000134 44.49432130000000285 0, -63.65757179999999948 44.49418029999999646 0, -63.6574175000000011 44.49377049999999656 0, -63.65688930000000312 44.49346740000000011 0, -63.65666550000000257 44.49341139999999939 0, -63.65664269999999902 44.49329250000000258 0, -63.65677099999999911 44.49312150000000088 0, -63.65699709999999811 44.49298799999999687 0, -63.65713519999999903 44.49271060000000233 0, -63.65745110000000295 44.49240139999999855 0, -63.65758379999999761 44.49239229999999878 0, -63.65814000000000306 44.49295659999999941 0, -63.65885699999999758 44.49336230000000114 0, -63.65910120000000205 44.49359640000000127 0, -63.65890509999999836 44.49367130000000259 0, -63.65896209999999655 44.4943041000000008 0, -63.65947299999999842 44.49476080000000167 0, -63.65982110000000205 44.49474430000000069 0, -63.66007210000000072 44.49454029999999705 0, -63.66009360000000328 44.4944184000000007 0, -63.66069869999999753 44.49432050000000061 0, -63.66092419999999663 44.49433700000000158 0, -63.66143639999999948 44.49462400000000173 0, -63.66150900000000235 44.49460179999999809 0, -63.66155100000000289 44.494247399999999 0, -63.66173380000000037 44.49422750000000093 0, -63.66209969999999885 44.49431799999999981 0, -63.6626406999999972 44.49430559999999701 0, -63.66276880000000205 44.4945451000000034 0, -63.66260369999999824 44.49467190000000016 0, -63.66168069999999801 44.49485800000000069 0, -63.66188640000000021 44.49508730000000156 0, -63.66190019999999805 44.49529290000000259 0, -63.66154480000000149 44.49548680000000189 0, -63.66162949999999654 44.49570959999999786 0, -63.66148479999999665 44.4960146000000023 0, -63.66226410000000158 44.49665449999999822 0, -63.66253559999999823 44.49675880000000205 0, -63.6631393999999986 44.49683060000000268 0, -63.66344910000000112 44.49680939999999651 0, -63.6636911000000012 44.49669200000000302 0, -63.66403290000000226 44.49642279999999772 0, -63.66428989999999999 44.49634129999999743 0, -63.66439059999999728 44.49616970000000293 0, -63.66433479999999889 44.49577769999999788 0, -63.66390069999999923 44.49533050000000145 0, -63.66366899999999873 44.49465070000000111 0, -63.66371699999999834 44.4944186999999971 0, -63.66353800000000263 44.49420980000000014 0, -63.66358160000000055 44.49381590000000131 0, -63.66331559999999712 44.49357349999999656 0, -63.66336520000000121 44.49330220000000224 0, -63.66356210000000004 44.49320759999999808 0, -63.66380929999999694 44.49323239999999657 0, -63.66395649999999762 44.4934092000000021 0, -63.66411269999999689 44.49390979999999729 0, -63.66460779999999886 44.49435040000000186 0, -63.66479819999999989 44.49441360000000145 0, -63.66517369999999687 44.49426739999999825 0, -63.66520260000000064 44.49409829999999744 0, -63.66490619999999723 44.4936538999999982 0, -63.66477669999999733 44.49358409999999964 0, -63.66468249999999784 44.4931873999999965 0, -63.66500709999999685 44.49266120000000058 0, -63.66522570000000059 44.49257500000000221 0, -63.66550070000000261 44.49273070000000274 0, -63.66656340000000114 44.49358959999999996 0, -63.66701210000000088 44.49381209999999953 0, -63.66738800000000253 44.4939265000000006 0, -63.66768909999999693 44.49383100000000013 0, -63.66783430000000266 44.49378500000000258 0, -63.66803050000000042 44.49372269999999929 0, -63.66848089999999871 44.49367170000000016 0, -63.66850889999999907 44.49366849999999829 0, -63.66923830000000351 44.49358579999999819 0, -63.66917430000000167 44.49285030000000063 0, -63.66911050000000216 44.49265549999999791 0, -63.66912750000000187 44.49237169999999963 0, -63.6694535999999971 44.492216599999999 0, -63.66963940000000122 44.49198750000000047 0, -63.67000339999999881 44.4919871000000029 0, -63.67001760000000132 44.49245319999999992 0, -63.67010919999999885 44.49277880000000351 0, -63.67054159999999996 44.49313519999999755 0, -63.67100279999999657 44.4937328999999977 0, -63.6710630999999978 44.49428679999999758 0, -63.6708943000000005 44.49464259999999882 0, -63.67140239999999807 44.49530839999999898 0, -63.67155149999999963 44.49557589999999863 0, -63.67143469999999894 44.49560120000000296 0, -63.6711482999999987 44.49559130000000096 0, -63.67134649999999851 44.49573749999999706 0, -63.67165800000000075 44.49580710000000039 0, -63.67244490000000212 44.49639969999999778 0, -63.67349990000000304 44.49663470000000132 0, -63.67428859999999702 44.49690760000000012 0, -63.67474140000000205 44.49703139999999735 0, -63.67488949999999903 44.49718839999999886 0, -63.67539740000000137 44.49731340000000301 0, -63.67542100000000005 44.49741259999999698 0, -63.6752445999999992 44.49768530000000055 0, -63.67523419999999845 44.49794169999999838 0, -63.67561179999999865 44.4980165999999997 0, -63.67591199999999674 44.49823200000000156 0, -63.6761874999999975 44.4986481999999981 0, -63.67613140000000271 44.49894710000000231 0, -63.67622010000000188 44.49907129999999711 0, -63.67604769999999803 44.49924539999999951 0, -63.67591099999999926 44.5 0, -63.67583119999999752 44.50037389999999959 0, -63.67546029999999746 44.50068199999999763 0, -63.67501109999999898 44.50073989999999924 0, -63.67447750000000184 44.50070519999999874 0, -63.67361240000000322 44.50027279999999763 0, -63.67277800000000099 44.50017270000000025 0, -63.67279200000000117 44.5 0, -63.6731923999999978 44.49947060000000221 0, -63.67339830000000234 44.4992894000000021 0, -63.67335909999999899 44.49889379999999761 0, -63.67288539999999841 44.4983312999999967 0, -63.67289019999999766 44.49821299999999979 0, -63.67257330000000337 44.49800119999999737 0, -63.67230860000000092 44.49799959999999999 0, -63.67224159999999955 44.49829429999999775 0, -63.67198299999999733 44.49841529999999779 0, -63.67158309999999943 44.49848200000000276 0, -63.67158919999999966 44.49860449999999901 0, -63.67206079999999702 44.49935649999999754 0, -63.67233949999999965 44.49969380000000285 0, -63.67235910000000132 44.49989159999999799 0, -63.67218050000000318 44.49994319999999703 0, -63.67172719999999941 44.49996929999999651 0, -63.67137189999999691 44.49975280000000311 0, -63.67118740000000088 44.49981209999999976 0, -63.67073940000000221 44.49998049999999949 0, -63.67036759999999873 44.49989779999999939 0, -63.67020889999999866 44.49986690000000067 0, -63.67006719999999831 44.49996260000000348 0, -63.67007999999999868 44.5 0, -63.67009180000000157 44.50017239999999674 0, -63.6707737999999992 44.50049440000000089 0, -63.6709036000000026 44.5006945000000016 0, -63.67176839999999771 44.50099660000000057 0, -63.67224089999999848 44.50090769999999907 0, -63.67237200000000286 44.50093799999999788 0, -63.67247689999999949 44.50120859999999823 0, -63.67288529999999724 44.50161580000000328 0, -63.67335800000000035 44.50165710000000274 0, -63.67358660000000015 44.50200530000000043 0, -63.67415100000000194 44.50237229999999755 0, -63.67483070000000112 44.50275340000000313 0, -63.67512990000000173 44.50285829999999976 0, -63.67541260000000136 44.50309709999999797 0, -63.6755785000000003 44.50336099999999817 0, -63.67619669999999843 44.50348830000000078 0, -63.67632230000000249 44.50365670000000051 0, -63.6762473 44.50373799999999846 0, -63.67571970000000192 44.50382580000000132 0, -63.67560919999999669 44.50410380000000288 0, -63.67568030000000334 44.50453170000000114 0, -63.6753366000000014 44.50471009999999694 0, -63.67532909999999902 44.50475730000000141 0, -63.67549050000000221 44.50485940000000085 0, -63.67561239999999856 44.50525669999999678 0, -63.67685079999999687 44.50601249999999709 0, -63.67671140000000207 44.50645970000000062 0, -63.67681189999999702 44.50656839999999903 0, -63.67727159999999742 44.50679499999999678 0, -63.67758169999999751 44.50731460000000084 0, -63.67795540000000187 44.50748810000000333 0, -63.67790829999999858 44.50811089999999837 0, -63.67766610000000327 44.50850859999999898 0, -63.67806470000000019 44.50861150000000066 0, -63.6781897999999984 44.50892989999999827 0, -63.67860170000000153 44.50938850000000002 0, -63.67893269999999717 44.50952560000000346 0, -63.67947300000000155 44.50953280000000234 0, -63.67938980000000271 44.50968110000000166 0, -63.67920879999999784 44.50979180000000213 0, -63.67908589999999691 44.51051569999999913 0, -63.67892030000000148 44.51079260000000204 0, -63.67845710000000281 44.51092520000000263 0, -63.67818139999999971 44.51091949999999997 0, -63.67795110000000136 44.51061080000000203 0, -63.67787239999999827 44.51051040000000114 0, -63.67792349999999857 44.51019959999999998 0, -63.67770620000000292 44.5101161999999988 0, -63.67725120000000061 44.51018179999999802 0, -63.67708259999999854 44.51025729999999925 0, -63.6765806000000012 44.51025479999999845 0, -63.67645129999999654 44.51031530000000203 0, -63.67602459999999809 44.50995120000000327 0, -63.67561620000000033 44.50995460000000037 0, -63.67542120000000239 44.51014010000000098 0, -63.67531590000000108 44.51014980000000065 0, -63.67493460000000027 44.50989320000000049 0, -63.67490829999999846 44.50931229999999772 0, -63.67450130000000286 44.50873539999999906 0, -63.67450180000000159 44.50817479999999904 0, -63.67421269999999822 44.50809389999999865 0, -63.67358200000000323 44.50800189999999645 0, -63.67292679999999905 44.50824099999999817 0, -63.67265259999999927 44.50806560000000189 0, -63.67257990000000234 44.50808779999999842 0, -63.67250440000000111 44.50831910000000136 0, -63.67276280000000099 44.50847840000000133 0, -63.67272570000000087 44.50871450000000351 0, -63.67329409999999967 44.50898289999999946 0, -63.67331639999999737 44.50925180000000125 0, -63.67342339999999723 44.50933299999999804 0, -63.67348570000000052 44.50956719999999933 0, -63.67373320000000092 44.50972229999999996 0, -63.67433160000000214 44.51034270000000248 0, -63.67439389999999833 44.51057689999999667 0, -63.67427760000000347 44.51086269999999701 0, -63.67382169999999775 44.51094799999999907 0, -63.67323230000000223 44.51065160000000276 0, -63.67276350000000207 44.51051160000000095 0, -63.67249209999999948 44.51053759999999926 0, -63.67237550000000113 44.51069309999999746 0, -63.67204259999999749 44.51087569999999971 0, -63.67203489999999988 44.51120319999999708 0, -63.67210860000000139 44.51129159999999985 0, -63.67193280000000044 44.51154460000000057 0, -63.67127339999999691 44.51175200000000132 0, -63.67072799999999688 44.51173279999999721 0, -63.67047809999999686 44.51163689999999917 0, -63.67000199999999666 44.51167439999999687 0, -63.66970570000000151 44.51177090000000192 0, -63.66932570000000169 44.51175510000000202 0, -63.66886319999999699 44.51145739999999762 0, -63.66808410000000151 44.5110779999999977 0, -63.66772079999999789 44.51064809999999738 0, -63.66751860000000107 44.51060050000000246 0, -63.66742479999999915 44.51046430000000242 0, -63.66724750000000199 44.51034609999999958 0, -63.66676420000000292 44.50960969999999861 0, -63.66654510000000045 44.50943540000000098 0, -63.66567289999999701 44.50931070000000034 0, -63.66529109999999747 44.50920409999999805 0, -63.66518119999999925 44.50892149999999958 0, -63.66523159999999848 44.50863040000000126 0, -63.66458099999999831 44.50862089999999682 0, -63.66402769999999833 44.50838830000000002 0, -63.66388289999999728 44.50869320000000329 0, -63.6636501999999993 44.50885420000000181 0, -63.66350810000000138 44.50881969999999654 0, -63.66324180000000155 44.50885759999999891 0, -63.66305429999999888 44.50912610000000313 0, -63.66271969999999669 44.50880719999999968 0, -63.66247409999999718 44.50874290000000144 0, -63.66153260000000103 44.50815089999999685 0, -63.66122759999999658 44.508053799999999 0, -63.66079330000000169 44.50801710000000355 0, -63.66037380000000212 44.50788599999999917 0, -63.65913119999999736 44.50791929999999752 0, -63.65957269999999824 44.50657259999999837 0, -63.66020209999999935 44.50464519999999879 0, -63.66157679999999885 44.50570419999999672 0, -63.66209049999999792 44.50623199999999713 0, -63.66257190000000321 44.50646700000000067 0, -63.66345170000000309 44.50667479999999898 0, -63.66383299999999679 44.50693139999999914 0, -63.66441619999999801 44.50710540000000037 0, -63.66431229999999886 44.5073559000000003 0, -63.6643453000000008 44.50762900000000144 0, -63.66482359999999829 44.50794290000000331 0, -63.66488160000000107 44.5081454999999977 0, -63.66507980000000089 44.5082917000000009 0, -63.66571290000000261 44.50832460000000168 0, -63.66590819999999695 44.5082694000000032 0, -63.66647379999999856 44.50792580000000243 0, -63.66648130000000094 44.50746800000000292 0, -63.66600820000000027 44.50675549999999703 0, -63.66596609999999856 44.50656910000000011 0, -63.66558799999999962 44.50623360000000162 0, -63.6655124999999984 44.50605439999999646 0, -63.66522400000000204 44.50541280000000199 0, -63.66474240000000151 44.50504750000000342 0, -63.66435969999999855 44.50496059999999687 0, -63.66382720000000006 44.50462579999999946 0, -63.6634594000000007 44.50444449999999819 0, -63.66322300000000212 44.50442379999999787 0, -63.66308839999999947 44.50434200000000118 0, -63.66274039999999701 44.5039479 0, -63.66203219999999874 44.50345550000000117 0, -63.661524 44.50320020000000198 0, -63.66131980000000112 44.50293140000000136 0, -63.6607371999999998 44.50260740000000226 0, -63.66017070000000189 44.50242980000000159 0, -63.66004910000000194 44.50257340000000283 0, -63.66003909999999877 44.50309029999999666 0, -63.6596964000000014 44.50337929999999886 0, -63.65811469999999872 44.50242709999999846 0, -63.65647649999999658 44.5014409999999998 0),(-63.67446819999999974 44.4977877000000035 0, -63.67439029999999889 44.49807820000000191 0, -63.67482460000000088 44.49852529999999717 0, -63.67500499999999874 44.49856460000000169 0, -63.67513350000000116 44.49852380000000096 0, -63.67523130000000009 44.49815079999999767 0, -63.67513170000000144 44.49802240000000353 0, -63.67476979999999998 44.49783339999999754 0, -63.67446819999999974 44.4977877000000035 0),(-63.66976100000000116 44.49679410000000246 0, -63.66949360000000269 44.49645699999999948 0, -63.6691868999999997 44.49596679999999793 0, -63.66885969999999872 44.49560679999999735 0, -63.66881049999999931 44.49513290000000154 0, -63.66840530000000342 44.49482549999999748 0, -63.66789130000000085 44.49476589999999732 0, -63.66744659999999811 44.49487090000000222 0, -63.66718469999999996 44.49496330000000199 0, -63.66681109999999677 44.49499899999999997 0, -63.66643650000000321 44.49506190000000316 0, -63.66653600000000068 44.49541729999999973 0, -63.66685110000000236 44.49607610000000335 0, -63.66723700000000008 44.49648630000000082 0, -63.66756159999999909 44.49672129999999726 0, -63.66756999999999778 44.4968900000000005 0, -63.66740140000000281 44.49711479999999852 0, -63.6674962000000022 44.49739939999999905 0, -63.66798870000000221 44.49761620000000306 0, -63.66835640000000041 44.49753679999999889 0, -63.66893900000000173 44.49740210000000218 0, -63.66932390000000197 44.49727419999999967 0, -63.66956030000000055 44.49706170000000327 0, -63.66976100000000116 44.49679410000000246 0),(-63.67029039999999895 44.49880660000000177 0, -63.67009089999999816 44.49883009999999928 0, -63.66993159999999818 44.49894919999999843 0, -63.67020099999999871 44.49924299999999988 0, -63.67056960000000032 44.49940459999999831 0, -63.67089579999999671 44.49924949999999768 0, -63.6709171999999981 44.49912750000000017 0, -63.67084249999999912 44.49892859999999928 0, -63.6706152000000003 44.49882130000000302 0, -63.67040399999999778 44.49886029999999693 0, -63.67029039999999895 44.49880660000000177 0))";
		Polygon otherp = (Polygon)reader.read(otherwb);

		String ls1 = "LineString (-63.65711509999999862 44.50892749999999864 0, -63.65761640000000199 44.5085392000000013 0, -63.6576110999999969 44.50839690000000104 0)";
		String ls2 = "LineString (-63.64969930000000176 44.49572129999999959 0, -63.6500204000000025 44.49609509999999801 0, -63.65020710000000292 44.49638720000000092 0)";
		String ls3 = "LineString (-63.64583950000000101 44.49758270000000238 0, -63.64554969999999656 44.4975213000000025 0, -63.64496059999999744 44.49722469999999674 0, -63.64454789999999917 44.49706609999999785 0, -63.64436169999999748 44.49703449999999805 0, -63.6441695999999979 44.4970107999999982 0, -63.64402069999999867 44.49674310000000332 0, -63.64392780000000016 44.49658720000000045 0)";
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		items.add((LineString)reader.read(ls3));
	
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), items);
		List<ConstructionPoint> pnts = pg.getPoints();

		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-63.6539508,44.4984472),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6581147,44.5024271),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6597182,44.5039285),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6576111,44.5083969),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6458395,44.4975827),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6582808,44.5078029),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.659667431432965,44.50628250568177),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6489549,44.4982796),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6514205,44.5036843),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6500406,44.4995182),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6502071,44.4963872),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		waterbody = "POLYGON (( -63.6564765 44.501441, -63.6581147 44.5024271, -63.6596964 44.5033793, -63.6602021 44.5046452, -63.6595727 44.5065726, -63.6591312 44.5079193, -63.6587166 44.5082107, -63.6584596 44.5078817, -63.6582808 44.5078029, -63.6578926 44.5083949, -63.6576111 44.5083969, -63.657304 44.5084892, -63.6569831 44.508376, -63.6567127 44.5079716, -63.6570999 44.5078099, -63.6572455 44.5074853, -63.6579579 44.5074685, -63.6579355 44.5070693, -63.6577872 44.506782, -63.6574673 44.5067793, -63.6573265 44.5064447, -63.6572793 44.5057055, -63.6571196 44.505564, -63.6568965 44.5054883, -63.6567734 44.5052607, -63.6561648 44.5048967, -63.6557796 44.5047386, -63.655296 44.504693, -63.6546965 44.5042423, -63.6544408 44.504154, -63.6541347 44.5043569, -63.6535938 44.5044995, -63.6533105 44.5044107, -63.6528634 44.5041487, -63.6526187 44.5036541, -63.6524558 44.5035915, -63.6522997 44.5036316, -63.6522659 44.5039191, -63.6518735 44.5039385, -63.6514205 44.5036843, -63.6506696 44.503566, -63.6504461 44.5032297, -63.6501544 44.5030775, -63.6499179 44.5023856, -63.6496048 44.5018146, -63.6495342 44.501517, -63.6492822 44.5010696, -63.6485422 44.5004146, -63.6479382 44.5002124, -63.647793 44.5, -63.6477325 44.4999831, -63.6477287 44.4996711, -63.6476042 44.4996133, -63.6472995 44.4996463, -63.6472262 44.4998185, -63.6471126 44.4997648, -63.6468745 44.4996532, -63.6467747 44.4993945, -63.6463083 44.499065, -63.6455764 44.4987536, -63.6454129 44.4988409, -63.6450955 44.498779, -63.6448691 44.4986519, -63.6447263 44.498637, -63.6445347 44.498333, -63.644593 44.4982553, -63.6448919 44.49823, -63.6455667 44.4983191, -63.6458539 44.4983094, -63.6459253 44.4980464, -63.6458395 44.4975827, -63.6461141 44.4974779, -63.6464214 44.4975159, -63.6469044 44.4978419, -63.6471925 44.4978124, -63.6473174 44.49759, -63.6471903 44.497461, -63.6468955 44.4973877, -63.646637 44.497098, -63.6466634 44.4968578, -63.6468269 44.4967704, -63.6473404 44.4967575, -63.6477408 44.4970817, -63.648031 44.4974036, -63.6480841 44.4977245, -63.6485466 44.4982829, -63.6488357 44.4983639, -63.6489549 44.4982796, -63.648938 44.4981529, -63.6486915 44.497978, -63.6485911 44.4978693, -63.6485849 44.4976165, -63.6487384 44.4975053, -63.648551 44.4972329, -63.6477435 44.496612, -63.6476096 44.4963802, -63.6476327 44.4962188, -63.6478397 44.4961482, -63.6481245 44.4961976, -63.6487006 44.4968097, -63.6490112 44.4967688, -63.6492016 44.496832, -63.6492742 44.4968098, -63.6493123 44.496554, -63.6495667 44.4964015, -63.6496291 44.4962251, -63.649979 44.4962996, -63.6502071 44.4963872, -63.6502614 44.4964081, -63.6513981 44.4966648, -63.6522686 44.4969593, -63.6526411 44.4970224, -63.6527694 44.4973922, -63.6525067 44.4976117, -63.6529677 44.4982096, -63.6539508 44.4984472, -63.6546373 44.4990616, -63.6545541 44.4992099, -63.6547055 44.4994183, -63.6545513 44.4995493, -63.654614 44.4996335, -63.6551955 44.499847, -63.6552009 44.4995787, -63.6557965 44.4997174, -63.655953 44.5, -63.655928 44.5, -63.6559058 44.50015, -63.6555355 44.5004383, -63.6555331 44.5004975, -63.6559879 44.5008426, -63.6561462 44.5011538, -63.6564765 44.501441 ), ( -63.6547729 44.5034504, -63.654581 44.503016, -63.6541234 44.5024696, -63.6540379 44.5022665, -63.6536072 44.5018706, -63.6533954 44.5015188, -63.6529842 44.5013207, -63.652972 44.5009454, -63.6526177 44.5008393, -63.6521622 44.500514, -63.651848 44.5, -63.6512522 44.4995633, -63.6508421 44.4994758, -63.6505336 44.4991969, -63.6504055 44.4989574, -63.6502325 44.4988708, -63.6500064 44.4990043, -63.6499686 44.4993904, -63.6500406 44.4995182, -63.6504736 44.4998549, -63.650565 44.5, -63.6505977 44.5001931, -63.6505536 44.5008672, -63.6517413 44.5016342, -63.6520821 44.501665, -63.6523554 44.5018602, -63.6523802 44.5022003, -63.6528851 44.5025345, -63.6529472 44.5027688, -63.6534298 44.5032447, -63.6536056 44.5035326, -63.654088 44.5038782, -63.6546291 44.5038658, -63.6547667 44.5037384, -63.6547729 44.5034504 ))";
		polygon = (Polygon)reader.read(waterbody);
		pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), items);
		pnts = pg.getPoints();

		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-63.65994925,44.50401225),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6539508,44.4984472),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6458395,44.4975827),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6581147,44.5024271),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6582808,44.5078029),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.659667431432965,44.50628250568177),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6502071,44.4963872),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6500406,44.4995182),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6576111,44.5083969),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6514205,44.5036843),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-63.6489549,44.4982796),NodeType.BANK,FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testNs2() throws Exception{
		String waterbody = "Polygon((-63.71880370000000227 44.48568920000000304 0, -63.71911680000000189 44.4851586999999995 0, -63.71938070000000209 44.48517979999999739 0, -63.71953039999999646 44.48529729999999915 0, -63.71977989999999892 44.48526290000000216 0, -63.72015319999999861 44.48530590000000018 0, -63.72057300000000168 44.48528670000000318 0, -63.72080270000000013 44.48533479999999685 0, -63.72106070000000244 44.48564389999999946 0, -63.72138939999999963 44.48584000000000316 0, -63.72201679999999868 44.48629079999999902 0, -63.72119789999999995 44.48676489999999717 0, -63.72115360000000095 44.48679049999999791 0, -63.72050829999999877 44.48735380000000106 0, -63.72040400000000204 44.4876240999999979 0, -63.72053400000000067 44.48782409999999743 0, -63.72033569999999969 44.48795820000000134 0, -63.72014399999999767 44.48778459999999768 0, -63.72028910000000224 44.48717969999999866 0, -63.72004189999999824 44.48659440000000131 0, -63.72010470000000026 44.48639829999999762 0, -63.72033869999999922 44.48619779999999935 0, -63.71955799999999925 44.48613859999999676 0, -63.71942260000000147 44.48579639999999813 0, -63.71930460000000096 44.48571119999999723 0, -63.71880370000000227 44.48568920000000304 0))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String otherwb = "Polygon((-63.72429569999999899 44.48414189999999735 0, -63.72474470000000224 44.48492459999999937 0, -63.72534929999999775 44.48553669999999727 0, -63.72551659999999885 44.4859111000000027 0, -63.72552439999999763 44.48627439999999922 0, -63.72607899999999859 44.48689739999999659 0, -63.72634020000000277 44.48712760000000088 0, -63.72659289999999999 44.48785509999999732 0, -63.72720770000000101 44.4884910999999974 0, -63.72723959999999721 44.48880359999999712 0, -63.72785120000000347 44.48951850000000263 0, -63.72794249999999749 44.48986370000000079 0, -63.72910650000000032 44.49098049999999915 0, -63.72935569999999927 44.49137629999999888 0, -63.73017080000000334 44.49196890000000337 0, -63.73063810000000018 44.49214800000000025 0, -63.73086789999999979 44.49247629999999987 0, -63.73088419999999843 44.4926226999999983 0, -63.73088700000000273 44.49269379999999785 0, -63.73122120000000024 44.49303210000000064 0, -63.73149870000000305 44.49312840000000335 0, -63.73188019999999909 44.49338480000000118 0, -63.73212010000000305 44.49345670000000297 0, -63.73211779999999749 44.49351579999999728 0, -63.73101330000000075 44.49355289999999741 0, -63.73076540000000278 44.49354799999999699 0, -63.7306941000000009 44.49396099999999876 0, -63.73082949999999869 44.49402299999999855 0, -63.73159369999999768 44.49408559999999824 0, -63.73199290000000161 44.49487919999999974 0, -63.73224629999999991 44.49502629999999925 0, -63.73269009999999923 44.49566680000000218 0, -63.73273249999999734 44.49585319999999911 0, -63.73263860000000136 44.49599740000000025 0, -63.7330960000000033 44.49671310000000091 0, -63.73335629999999696 44.49739329999999882 0, -63.73331799999999703 44.49794920000000076 0, -63.73357740000000149 44.49836890000000267 0, -63.73377640000000355 44.49920579999999859 0, -63.73414499999999805 44.5 0, -63.73430270000000064 44.50027819999999679 0, -63.73452530000000138 44.50065370000000087 0, -63.73455680000000001 44.50083589999999845 0, -63.73494980000000254 44.50150699999999659 0, -63.73495960000000338 44.50168080000000259 0, -63.73525930000000272 44.50191579999999902 0, -63.73592299999999966 44.50286069999999938 0, -63.73591919999999789 44.50295930000000055 0, -63.73612190000000055 44.50313700000000239 0, -63.73615379999999675 44.5034495000000021 0, -63.73651379999999733 44.50397780000000125 0, -63.73652189999999962 44.50462139999999778 0, -63.73686260000000203 44.50536249999999683 0, -63.73670789999999897 44.50579359999999696 0, -63.73665859999999839 44.5057848000000007 0, -63.73650489999999991 44.5057659000000001 0, -63.73595530000000053 44.50500490000000298 0, -63.73555879999999974 44.50456270000000103 0, -63.7353392999999997 44.50410829999999862 0, -63.734660599999998 44.50340789999999913 0, -63.73425660000000192 44.50273270000000281 0, -63.73407999999999873 44.50259489999999829 0, -63.73377760000000336 44.50256910000000232 0, -63.7333753999999999 44.50241499999999917 0, -63.73335480000000075 44.50223700000000093 0, -63.73360590000000059 44.50216300000000302 0, -63.73377080000000205 44.50203609999999799 0, -63.73358209999999957 44.5017836000000031 0, -63.73291720000000282 44.50171900000000136 0, -63.73310099999999778 44.50124900000000139 0, -63.73286259999999714 44.50085729999999984 0, -63.73271770000000203 44.50047150000000329 0, -63.73227299999999929 44.5 0, -63.73225790000000046 44.49981489999999695 0, -63.7323789000000005 44.49954100000000068 0, -63.732334299999998 44.49941379999999924 0, -63.73214670000000126 44.49927189999999655 0, -63.73165300000000144 44.49920279999999906 0, -63.73097680000000054 44.49872340000000293 0, -63.73043839999999705 44.49824689999999805 0, -63.73025350000000344 44.497895800000002 0, -63.72974239999999924 44.49784999999999968 0, -63.72943029999999709 44.49765029999999655 0, -63.72947800000000029 44.49741840000000082 0, -63.72930250000000285 44.49711090000000269 0, -63.72932610000000153 44.49692979999999665 0, -63.73013100000000009 44.4969380000000001 0, -63.73051130000000342 44.49680349999999862 0, -63.73058230000000179 44.49654050000000183 0, -63.73040439999999762 44.49629209999999802 0, -63.73017699999999763 44.49618499999999699 0, -63.73007170000000343 44.49591439999999665 0, -63.7295076999999992 44.49552810000000136 0, -63.72943080000000293 44.49523839999999808 0, -63.72899770000000075 44.49503239999999948 0, -63.72832830000000115 44.49508600000000058 0, -63.7276859999999985 44.49529030000000063 0, -63.72739380000000153 44.49528839999999974 0, -63.72729139999999859 44.49564949999999897 0, -63.72712800000000044 44.49573699999999832 0, -63.72684319999999758 44.49568790000000007 0, -63.72645109999999846 44.49527739999999909 0, -63.72620189999999951 44.4948814999999982 0, -63.72547999999999746 44.4941644000000025 0, -63.72524589999999733 44.49380440000000192 0, -63.72523410000000155 44.49297920000000062 0, -63.72510679999999894 44.49285030000000063 0, -63.72482149999999734 44.49239060000000023 0, -63.7247439 44.4921205999999998 0, -63.72441469999999697 44.49179430000000224 0, -63.72415469999999971 44.49167460000000318 0, -63.72396379999999994 44.49148129999999668 0, -63.72357060000000217 44.49124050000000352 0, -63.72312279999999873 44.49112879999999848 0, -63.72304050000000331 44.49097720000000322 0, -63.72288530000000151 44.4909977000000012 0, -63.72271810000000158 44.49090360000000288 0, -63.7227164999999971 44.49066280000000262 0, -63.72303620000000279 44.4903850000000034 0, -63.72302729999999826 44.4901914000000005 0, -63.72252619999999723 44.48960890000000035 0, -63.72195459999999656 44.48885930000000144 0, -63.72140009999999677 44.48851650000000291 0, -63.72041519999999792 44.48803879999999822 0, -63.72033569999999969 44.48795820000000134 0, -63.72053400000000067 44.48782409999999743 0, -63.72040400000000204 44.4876240999999979 0, -63.72050829999999877 44.48735380000000106 0, -63.72115360000000095 44.48679049999999791 0, -63.72119789999999995 44.48676489999999717 0, -63.72201679999999868 44.48629079999999902 0, -63.72264460000000241 44.486311299999997 0, -63.72309280000000342 44.48655320000000302 0, -63.7231482999999983 44.48668459999999669 0, -63.72337139999999778 44.48676009999999792 0, -63.72346610000000311 44.48687650000000104 0, -63.72334239999999994 44.48707929999999777 0, -63.72379910000000081 44.48738449999999744 0, -63.72419140000000226 44.48736480000000171 0, -63.72424449999999752 44.48727499999999679 0, -63.72411799999999715 44.48712640000000107 0, -63.72375519999999938 44.48695730000000026 0, -63.72372649999999794 44.48684620000000223 0, -63.72394409999999709 44.48677949999999726 0, -63.72457779999999872 44.48679229999999762 0, -63.72461489999999884 44.48612589999999756 0, -63.72412829999999673 44.48559900000000056 0, -63.72387359999999745 44.48450050000000289 0, -63.72408140000000287 44.48431920000000162 0, -63.72429569999999899 44.48414189999999735 0),(-63.72373970000000298 44.49002409999999941 0, -63.72343430000000097 44.49007720000000177 0, -63.72340799999999916 44.4904674 0, -63.72357749999999754 44.4905023999999969 0, -63.72391129999999748 44.49043019999999871 0, -63.72393919999999667 44.49028069999999957 0, -63.72373970000000298 44.49002409999999941 0))";
		Polygon otherp = (Polygon)reader.read(otherwb);

		String ls1 = "LineString(-63.71686249999999774 44.48611590000000149 0, -63.71762499999999818 44.4862181000000021 0, -63.71806300000000078 44.48615589999999997 0, -63.71854840000000308 44.48573149999999998 0, -63.71880370000000227 44.48568920000000304 0)";
		String ls2 = "LineString(-63.73895890000000009 44.51003889999999785 0, -63.73900880000000058 44.50875690000000162 0, -63.73843289999999939 44.50838610000000273 0, -63.73802189999999968 44.50760819999999995 0, -63.7374781999999982 44.50711960000000289 0, -63.7372595000000004 44.50664549999999764 0, -63.73665859999999839 44.5057848000000007 0)";
		String ls3 = "LineString(-63.72068639999999817 44.49376800000000287 0, -63.72066780000000108 44.49340049999999991 0, -63.72032509999999661 44.49299890000000346 0, -63.72005029999999692 44.49241310000000027 0, -63.71996839999999906 44.49155090000000001 0, -63.7199939999999998 44.49146060000000347 0, -63.72050620000000265 44.49133669999999796 0, -63.72158689999999837 44.4912005999999991 0, -63.72203280000000092 44.49094110000000057 0, -63.72271810000000158 44.49090360000000288 0)";
		String ls4 = "LineString(-63.73653290000000027 44.49088429999999761 0, -63.73655689999999652 44.49154399999999754 0, -63.73677899999999852 44.49178919999999948 0, -63.73662889999999948 44.4921020000000027 0, -63.73621109999999845 44.4924923000000021 0, -63.73623599999999811 44.49270200000000131 0, -63.7364721000000003 44.49287249999999716 0, -63.7363490999999982 44.49305559999999815 0, -63.73606850000000179 44.49303820000000087 0, -63.73598090000000127 44.49330489999999827 0, -63.73574659999999881 44.49337520000000268 0, -63.73528319999999781 44.49337779999999753 0, -63.73499069999999733 44.49352590000000163 0, -63.73375149999999678 44.49348140000000029 0, -63.73268130000000298 44.4934915999999987 0, -63.7323157000000009 44.49353159999999718 0, -63.73211779999999749 44.49351579999999728 0)";
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		items.add((LineString)reader.read(ls3));
		items.add((LineString)reader.read(ls4));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.singletonList(otherp), items);
		List<ConstructionPoint> pnts = pg.getPoints();
//		pnts.forEach(e->e.toText());
		
		Collection<Polygon> newpolys = pg.getUpdatedPolygons();
		ArrayList<Polygon> all = new ArrayList<>(newpolys);
		
		Polygon p1 = all.get(0);
		Polygon p2 = all.get(1);
		
		if (p1.getArea() > p2.getArea()) {
			polygon = p1;
			otherp = p2;
		}else {
			polygon = p2;
			otherp = p1;
		}
		
		String other2 = "PolygonZ ((-63.72429569999999899 44.48414189999999735 0, -63.72408140000000287 44.48431920000000162 0, -63.72387359999999745 44.48450050000000289 0, -63.72353679999999798 44.48409110000000055 0, -63.722939199999999 44.48302120000000315 0, -63.72273160000000303 44.48283150000000319 0, -63.72258879999999692 44.48253660000000309 0, -63.72233539999999863 44.48238940000000241 0, -63.72212160000000125 44.48235739999999794 0, -63.72190239999999761 44.48218330000000265 0, -63.72152059999999807 44.48179669999999675 0, -63.72159429999999958 44.48160469999999833 0, -63.72151939999999826 44.48140589999999861 0, -63.72136110000000286 44.48122500000000201 0, -63.72132189999999952 44.48095980000000083 0, -63.72104920000000305 44.48074510000000004 0, -63.72052659999999946 44.48071480000000122 0, -63.71988759999999985 44.48027960000000292 0, -63.71975640000000141 44.48024929999999699 0, -63.71992910000000165 44.48020549999999673 0, -63.71994269999999716 44.48000050000000272 0, -63.71968119999999658 44.4796400000000034 0, -63.71978279999999728 44.47957879999999875 0, -63.71965130000000244 44.47941829999999896 0, -63.71970360000000255 44.47934829999999806 0, -63.71947939999999733 44.47916219999999754 0, -63.7191849000000019 44.47865889999999922 0, -63.7187911999999983 44.47871810000000181 0, -63.71881559999999922 44.47851730000000003 0, -63.71887689999999793 44.47836060000000202 0, -63.71908289999999653 44.47830950000000172 0, -63.71877489999999966 44.47745069999999856 0, -63.71866349999999812 44.47705770000000314 0, -63.71881640000000147 44.47681610000000063 0, -63.71833300000000122 44.47649049999999704 0, -63.71818480000000307 44.4766138999999967 0, -63.71780619999999828 44.47642859999999843 0, -63.7171157000000008 44.47604359999999701 0, -63.71704859999999826 44.4759278000000009 0, -63.71709090000000231 44.47583389999999781 0, -63.71687010000000129 44.4756992000000011 0, -63.7167158000000029 44.47541979999999739 0, -63.71655669999999816 44.4752586999999977 0, -63.71657809999999955 44.47513680000000136 0, -63.71638260000000287 44.47506179999999887 0, -63.71634300000000195 44.47494650000000149 0, -63.71640390000000309 44.47493990000000252 0, -63.71658349999999871 44.4747185000000016 0, -63.7166495000000026 44.47472379999999958 0, -63.7168526999999969 44.47488179999999858 0, -63.71702839999999668 44.47475909999999999 0, -63.71708470000000091 44.47459049999999792 0, -63.71680460000000323 44.47442300000000159 0, -63.71644539999999779 44.47458550000000344 0, -63.71616730000000217 44.4745088000000024 0, -63.71610830000000192 44.4743259999999978 0, -63.71591399999999794 44.4740813000000017 0, -63.71582279999999798 44.47401639999999645 0, -63.71572940000000074 44.47401049999999856 0, -63.71541710000000336 44.4739608000000004 0, -63.71543590000000279 44.47380890000000164 0, -63.71572470000000266 44.47348399999999913 0, -63.71608580000000188 44.47325529999999816 0, -63.71684400000000181 44.47288220000000081 0, -63.71788420000000031 44.47234490000000307 0, -63.71782369999999673 44.47248179999999707 0, -63.7177184999999966 44.4733323000000027 0, -63.71818400000000082 44.47411139999999818 0, -63.71896019999999794 44.47525980000000345 0, -63.71953359999999833 44.47582009999999997 0, -63.7198921000000027 44.47651799999999866 0, -63.71985130000000197 44.47685270000000202 0, -63.72017530000000107 44.47716710000000262 0, -63.72081430000000069 44.47816279999999978 0, -63.72117630000000332 44.47863190000000344 0, -63.72133529999999979 44.47907330000000314 0, -63.72164529999999871 44.47946240000000273 0, -63.72192390000000017 44.47966929999999763 0, -63.72258320000000253 44.48099309999999917 0, -63.72292199999999696 44.48177350000000274 0, -63.72339850000000183 44.48255679999999757 0, -63.72388509999999684 44.48364420000000052 0, -63.72429569999999899 44.48414189999999735 0),(-63.71614790000000283 44.47416110000000344 0, -63.7163449999999969 44.47419659999999908 0, -63.71662740000000014 44.47430489999999992 0, -63.71670220000000029 44.47422360000000197 0, -63.71631510000000276 44.47369470000000291 0, -63.71623249999999672 44.47341279999999841 0, -63.71613130000000069 44.47332389999999691 0, -63.71574569999999937 44.47359639999999814 0, -63.7157576999999975 44.47371110000000272 0, -63.71614950000000022 44.47384139999999775 0, -63.71614790000000283 44.47416110000000344 0),(-63.71798499999999876 44.47622700000000151 0, -63.71785700000000219 44.47583759999999842 0, -63.717518400000003 44.47561759999999964 0, -63.71739660000000072 44.47563089999999875 0, -63.71727280000000349 44.47583370000000258 0, -63.71757269999999806 44.47619889999999998 0, -63.71789580000000086 44.47625279999999748 0, -63.71798499999999876 44.47622700000000151 0))";
		Polygon otherp2 = (Polygon) reader.read(other2);
		
		List<Polygon> touchesp = new ArrayList<>();
		touchesp.add(otherp2);
		touchesp.add(otherp);
		
		pg.processPolygon(polygon, touchesp, items);
		pnts = pg.getPoints();
		pnts.forEach(e->e.toText());
		
//		Set<SkeletonPoint> expected = new HashSet<>();
//		expected.add(new SkeletonPoint(new Coordinate(-63.6539508,44.4984472),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6581147,44.5024271),NodeType.WATER,FlowFlowDirection.UNKNOWN, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6597182,44.5039285),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6576111,44.5083969),NodeType.FLOWPATH,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6458395,44.4975827),NodeType.FLOWPATH,FlowFlowDirection.OUTPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6582808,44.5078029),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.659667431432965,44.50628250568177),NodeType.WATER,FlowFlowDirection.UNKNOWN, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6489549,44.4982796),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6514205,44.5036843),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6500406,44.4995182),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6502071,44.4963872),NodeType.FLOWPATH,FlowFlowDirection.INPUT, null));
//		
//		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
//		setEquals(expected, pnts);
//		
//		waterbody = "POLYGON (( -63.6564765 44.501441, -63.6581147 44.5024271, -63.6596964 44.5033793, -63.6602021 44.5046452, -63.6595727 44.5065726, -63.6591312 44.5079193, -63.6587166 44.5082107, -63.6584596 44.5078817, -63.6582808 44.5078029, -63.6578926 44.5083949, -63.6576111 44.5083969, -63.657304 44.5084892, -63.6569831 44.508376, -63.6567127 44.5079716, -63.6570999 44.5078099, -63.6572455 44.5074853, -63.6579579 44.5074685, -63.6579355 44.5070693, -63.6577872 44.506782, -63.6574673 44.5067793, -63.6573265 44.5064447, -63.6572793 44.5057055, -63.6571196 44.505564, -63.6568965 44.5054883, -63.6567734 44.5052607, -63.6561648 44.5048967, -63.6557796 44.5047386, -63.655296 44.504693, -63.6546965 44.5042423, -63.6544408 44.504154, -63.6541347 44.5043569, -63.6535938 44.5044995, -63.6533105 44.5044107, -63.6528634 44.5041487, -63.6526187 44.5036541, -63.6524558 44.5035915, -63.6522997 44.5036316, -63.6522659 44.5039191, -63.6518735 44.5039385, -63.6514205 44.5036843, -63.6506696 44.503566, -63.6504461 44.5032297, -63.6501544 44.5030775, -63.6499179 44.5023856, -63.6496048 44.5018146, -63.6495342 44.501517, -63.6492822 44.5010696, -63.6485422 44.5004146, -63.6479382 44.5002124, -63.647793 44.5, -63.6477325 44.4999831, -63.6477287 44.4996711, -63.6476042 44.4996133, -63.6472995 44.4996463, -63.6472262 44.4998185, -63.6471126 44.4997648, -63.6468745 44.4996532, -63.6467747 44.4993945, -63.6463083 44.499065, -63.6455764 44.4987536, -63.6454129 44.4988409, -63.6450955 44.498779, -63.6448691 44.4986519, -63.6447263 44.498637, -63.6445347 44.498333, -63.644593 44.4982553, -63.6448919 44.49823, -63.6455667 44.4983191, -63.6458539 44.4983094, -63.6459253 44.4980464, -63.6458395 44.4975827, -63.6461141 44.4974779, -63.6464214 44.4975159, -63.6469044 44.4978419, -63.6471925 44.4978124, -63.6473174 44.49759, -63.6471903 44.497461, -63.6468955 44.4973877, -63.646637 44.497098, -63.6466634 44.4968578, -63.6468269 44.4967704, -63.6473404 44.4967575, -63.6477408 44.4970817, -63.648031 44.4974036, -63.6480841 44.4977245, -63.6485466 44.4982829, -63.6488357 44.4983639, -63.6489549 44.4982796, -63.648938 44.4981529, -63.6486915 44.497978, -63.6485911 44.4978693, -63.6485849 44.4976165, -63.6487384 44.4975053, -63.648551 44.4972329, -63.6477435 44.496612, -63.6476096 44.4963802, -63.6476327 44.4962188, -63.6478397 44.4961482, -63.6481245 44.4961976, -63.6487006 44.4968097, -63.6490112 44.4967688, -63.6492016 44.496832, -63.6492742 44.4968098, -63.6493123 44.496554, -63.6495667 44.4964015, -63.6496291 44.4962251, -63.649979 44.4962996, -63.6502071 44.4963872, -63.6502614 44.4964081, -63.6513981 44.4966648, -63.6522686 44.4969593, -63.6526411 44.4970224, -63.6527694 44.4973922, -63.6525067 44.4976117, -63.6529677 44.4982096, -63.6539508 44.4984472, -63.6546373 44.4990616, -63.6545541 44.4992099, -63.6547055 44.4994183, -63.6545513 44.4995493, -63.654614 44.4996335, -63.6551955 44.499847, -63.6552009 44.4995787, -63.6557965 44.4997174, -63.655953 44.5, -63.655928 44.5, -63.6559058 44.50015, -63.6555355 44.5004383, -63.6555331 44.5004975, -63.6559879 44.5008426, -63.6561462 44.5011538, -63.6564765 44.501441 ), ( -63.6547729 44.5034504, -63.654581 44.503016, -63.6541234 44.5024696, -63.6540379 44.5022665, -63.6536072 44.5018706, -63.6533954 44.5015188, -63.6529842 44.5013207, -63.652972 44.5009454, -63.6526177 44.5008393, -63.6521622 44.500514, -63.651848 44.5, -63.6512522 44.4995633, -63.6508421 44.4994758, -63.6505336 44.4991969, -63.6504055 44.4989574, -63.6502325 44.4988708, -63.6500064 44.4990043, -63.6499686 44.4993904, -63.6500406 44.4995182, -63.6504736 44.4998549, -63.650565 44.5, -63.6505977 44.5001931, -63.6505536 44.5008672, -63.6517413 44.5016342, -63.6520821 44.501665, -63.6523554 44.5018602, -63.6523802 44.5022003, -63.6528851 44.5025345, -63.6529472 44.5027688, -63.6534298 44.5032447, -63.6536056 44.5035326, -63.654088 44.5038782, -63.6546291 44.5038658, -63.6547667 44.5037384, -63.6547729 44.5034504 ))";
//		polygon = (Polygon)reader.read(waterbody);
//		pg = createPointGenerator();
//		pg.processPolygon(polygon, Collections.singletonList(otherp), items);
//		pnts = pg.getPoints();
//
//		expected = new HashSet<>();
//		expected.add(new SkeletonPoint(new Coordinate(-63.65994925,44.50401225),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6539508,44.4984472),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6458395,44.4975827),NodeType.FLOWPATH,FlowFlowDirection.OUTPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6581147,44.5024271),NodeType.WATER,FlowFlowDirection.UNKNOWN, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6582808,44.5078029),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.659667431432965,44.50628250568177),NodeType.WATER,FlowFlowDirection.UNKNOWN, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6502071,44.4963872),NodeType.FLOWPATH,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6500406,44.4995182),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6576111,44.5083969),NodeType.FLOWPATH,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6514205,44.5036843),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-63.6489549,44.4982796),NodeType.BANK,FlowFlowDirection.INPUT, null));
//		
//		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
//		setEquals(expected, pnts);
	}
	@Test
	public void testAddVertex() throws Exception{
		
		String waterbody = "POLYGON (( -73.1431832 45.6745887,-73.1432731 45.674589,-73.1433372 45.6745982,-73.1434013 45.6746163,-73.1434654 45.6746346,-73.1435293 45.6746798,-73.143619 45.6747071,-73.1436959 45.6747253,-73.1437212 45.6747704,-73.1437723 45.6748245,-73.1438362 45.6748517,-73.143913 45.6748879,-73.1439641 45.6749241,-73.1440023 45.6749872,-73.1440532 45.6750503,-73.144117 45.6750955,-73.1441811 45.6751317,-73.1442579 45.6751589,-73.1443476 45.6751772,-73.1444116 45.6752045,-73.1444627 45.6752406,-73.1445394 45.6752858,-73.1446033 45.67534,-73.1446671 45.6753852,-73.144744 45.6754124,-73.1447951 45.6754485,-73.1448462 45.6755027,-73.1448842 45.6755748,-73.1449222 45.6756559,-73.1449474 45.675728,-73.1449726 45.6758001,-73.1449979 45.6758541,-73.1450232 45.6759082,-73.1450229 45.6759711,-73.1450354 45.6760162,-73.1450477 45.6761062,-73.1450603 45.6761512,-73.1450857 45.6761963,-73.1450982 45.6762413,-73.1451236 45.6762864,-73.1451484 45.6764125,-73.1451608 45.6764935,-73.1451603 45.6765565,-73.1451472 45.6766104,-73.1451082 45.6766823,-73.1450693 45.6767542,-73.1450561 45.6767991,-73.1450044 45.6768619,-73.1449398 45.6769247,-73.1448881 45.6769876,-73.1448492 45.6770504,-73.1447846 45.6771042,-73.144733 45.677149,-73.1446812 45.6772118,-73.1446295 45.6772747,-73.1445778 45.6773465,-73.1445131 45.6774183,-73.1444872 45.6774632,-73.1444483 45.677508,-73.1444223 45.6775619,-73.1443836 45.6776069,-73.1443576 45.6776517,-73.1443058 45.6777236,-73.1442411 45.6777954,-73.144125 45.677894,-73.1440605 45.6779568,-73.1439958 45.6780195,-73.1439312 45.6780823,-73.1438667 45.6781361,-73.1438023 45.6781899,-73.1437121 45.6782256,-73.143635 45.6782434,-73.1435323 45.678252,-73.1434425 45.6782428,-73.1433528 45.6782155,-73.1432631 45.6781792,-73.1431991 45.6781611,-73.1430967 45.6781157,-73.1430071 45.6780704,-73.1429304 45.6780253,-73.1428408 45.677971,-73.1427643 45.6779078,-73.1427003 45.6778626,-73.1426366 45.6777993,-73.1425729 45.6777272,-73.142509 45.677664,-73.1424454 45.6775918,-73.1423687 45.6775285,-73.142305 45.6774564,-73.1422539 45.6774202,-73.1421645 45.677357,-73.1420878 45.6772937,-73.1420112 45.6772395,-73.1419474 45.6771763,-73.141858 45.6771131,-73.1417813 45.6770498,-73.1416919 45.6769866,-73.1416024 45.6769323,-73.1415001 45.676869,-73.1414106 45.6768057,-73.1413724 45.6767606,-73.1413213 45.6767245,-73.1412446 45.6766702,-73.141155 45.6766249,-73.141104 45.6765798,-73.1410658 45.6765346,-73.141079 45.6764807,-73.1411049 45.6764268,-73.1411694 45.676391,-73.1412339 45.6763463,-73.1412726 45.6763014,-73.1412859 45.6762474,-73.1413374 45.6762116,-73.1414017 45.6761938,-73.1414791 45.676149,-73.1415307 45.6761042,-73.1415823 45.6760504,-73.1416213 45.6759875,-73.1416729 45.6759337,-73.1417119 45.6758708,-73.1417635 45.675808,-73.1418152 45.6757542,-73.1418541 45.6756914,-73.141893 45.6756285,-73.1419319 45.6755836,-73.1419708 45.6755207,-73.1420353 45.6754579,-73.1420999 45.6753952,-73.1421516 45.6753414,-73.1422035 45.6752695,-73.1422424 45.6752067,-73.1422813 45.6751437,-73.1423458 45.67509,-73.142423 45.6750453,-73.1425004 45.6749915,-73.1425776 45.6749647,-73.142642 45.674929,-73.1427065 45.6748932,-73.1427709 45.6748573,-73.1428481 45.6748127,-73.1429253 45.6747859,-73.1430025 45.6747591,-73.1430541 45.6747233,-73.1430672 45.6746693,-73.1431062 45.6746155,-73.1431832 45.6745887 ),( -73.143398 45.6751473,-73.1433468 45.6751111,-73.1432186 45.6751017,-73.1431416 45.6751015,-73.1430516 45.6751192,-73.1429745 45.6751189,-73.1428974 45.6751367,-73.1428074 45.6751545,-73.1427302 45.6751812,-73.1426658 45.675226,-73.1426014 45.6752708,-73.1425625 45.6753246,-73.1425237 45.6753785,-73.142472 45.6754323,-73.1424075 45.6754771,-73.1423687 45.675522,-73.1423426 45.6755759,-73.1423938 45.675612,-73.1424708 45.6756123,-73.1425478 45.6756215,-73.1426247 45.6756308,-73.1426372 45.6756758,-73.1427014 45.6756939,-73.1427654 45.6757122,-73.142855 45.6757485,-73.1429191 45.6757576,-73.1430089 45.6757669,-73.1430729 45.6758121,-73.1431367 45.6758483,-73.1432008 45.6758665,-73.1432778 45.6758757,-73.1433676 45.6758761,-73.1434575 45.6758673,-73.1435473 45.6758855,-73.1436368 45.6759308,-73.1437263 45.6759761,-73.1438031 45.6760304,-73.1438797 45.6760846,-73.1439693 45.6761389,-73.144046 45.676184,-73.14411 45.6762113,-73.1441742 45.6762025,-73.1442002 45.6761575,-73.144162 45.6761124,-73.1441109 45.6760583,-73.1440472 45.6760041,-73.1439704 45.6759589,-73.1438937 45.6759136,-73.1438041 45.6758683,-73.1437017 45.6758321,-73.1436121 45.6757868,-73.1435353 45.6757506,-73.1435099 45.6757055,-73.1435231 45.6756606,-73.1435234 45.6755976,-73.1435109 45.6755435,-73.1434727 45.6754894,-73.1434474 45.6754444,-73.1434478 45.6753814,-73.1434225 45.6753273,-73.1433844 45.6752642,-73.1433975 45.6752103,-73.143398 45.6751473 ),( -73.1428634 45.6764413,-73.1428381 45.6763873,-73.1427612 45.6763691,-73.1426971 45.6763508,-73.1426331 45.6763326,-73.1425562 45.6763144,-73.142505 45.6762783,-73.1424412 45.6762331,-73.1424158 45.676188,-73.1423776 45.6761429,-73.1423137 45.6761067,-73.1422883 45.6760616,-73.1422244 45.6760074,-73.1421731 45.6760072,-73.1421088 45.676025,-73.1420956 45.67607,-73.1420312 45.6761058,-73.1419668 45.6761416,-73.141928 45.6761954,-73.1419277 45.6762494,-73.1419402 45.6763035,-73.1419783 45.6763576,-73.1420552 45.6763758,-73.1421321 45.676394,-73.1422088 45.6764303,-73.1422599 45.6764844,-73.1423238 45.6765116,-73.142388 45.6765299,-73.142465 45.67653,-73.142542 45.6765303,-73.142619 45.6765305,-73.1427089 45.6765308,-73.1427859 45.6765311,-73.1428503 45.6764863,-73.1428634 45.6764413 ),( -73.1446218 45.6764738,-73.1446092 45.6764198,-73.1445711 45.6763746,-73.1444943 45.6763295,-73.1444176 45.6762842,-73.1443409 45.676239,-73.1442511 45.6762297,-73.1441996 45.6762655,-73.1442247 45.6763376,-73.1442501 45.6763827,-73.1443011 45.6764458,-73.1443391 45.6764999,-73.1443774 45.676545,-73.1444543 45.6765543,-73.1445186 45.6765454,-73.1445958 45.6765188,-73.1446218 45.6764738 ),( -73.1443622 45.676914,-73.1443112 45.6768777,-73.1442472 45.6768415,-73.1441961 45.6767965,-73.1441707 45.6767513,-73.1441198 45.6766972,-73.144043 45.676652,-73.1439791 45.6766068,-73.1439024 45.6765705,-73.1437998 45.6765522,-73.1437354 45.676579,-73.1437864 45.6766242,-73.1438504 45.6766694,-73.1439143 45.6766966,-73.1439784 45.6767328,-73.1440421 45.676787,-73.1440931 45.6768411,-73.1441443 45.6768772,-73.144221 45.6769225,-73.1442849 45.6769587,-73.144362 45.6769679,-73.1443622 45.676914 ))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		Set<PointGenerator.InsertPoint> insertPoints = new HashSet<>();
		insertPoints.add(new PointGenerator.InsertPoint(
				new Coordinate(-73.1432731, 45.674589),
				new Coordinate(-73.1433372, 45.6745982),
				new Coordinate(-73.14330515, 45.674593599999994)
		));
		insertPoints.add(new PointGenerator.InsertPoint(
				new Coordinate(-73.1437121, 45.6782256),
				new Coordinate(-73.143635, 45.6782434),
				new Coordinate(-73.1436792233908, 45.67828465542142)
		));
		Polygon out = PointGenerator.addVertex(polygon, insertPoints);
		Polygon expected = (Polygon) reader.read("POLYGON ((-73.1431832 45.6745887, -73.1432731 45.674589, -73.14330515 45.674593599999994, -73.1433372 45.6745982, -73.1434013 45.6746163, -73.1434654 45.6746346, -73.1435293 45.6746798, -73.143619 45.6747071, -73.1436959 45.6747253, -73.1437212 45.6747704, -73.1437723 45.6748245, -73.1438362 45.6748517, -73.143913 45.6748879, -73.1439641 45.6749241, -73.1440023 45.6749872, -73.1440532 45.6750503, -73.144117 45.6750955, -73.1441811 45.6751317, -73.1442579 45.6751589, -73.1443476 45.6751772, -73.1444116 45.6752045, -73.1444627 45.6752406, -73.1445394 45.6752858, -73.1446033 45.67534, -73.1446671 45.6753852, -73.144744 45.6754124, -73.1447951 45.6754485, -73.1448462 45.6755027, -73.1448842 45.6755748, -73.1449222 45.6756559, -73.1449474 45.675728, -73.1449726 45.6758001, -73.1449979 45.6758541, -73.1450232 45.6759082, -73.1450229 45.6759711, -73.1450354 45.6760162, -73.1450477 45.6761062, -73.1450603 45.6761512, -73.1450857 45.6761963, -73.1450982 45.6762413, -73.1451236 45.6762864, -73.1451484 45.6764125, -73.1451608 45.6764935, -73.1451603 45.6765565, -73.1451472 45.6766104, -73.1451082 45.6766823, -73.1450693 45.6767542, -73.1450561 45.6767991, -73.1450044 45.6768619, -73.1449398 45.6769247, -73.1448881 45.6769876, -73.1448492 45.6770504, -73.1447846 45.6771042, -73.144733 45.677149, -73.1446812 45.6772118, -73.1446295 45.6772747, -73.1445778 45.6773465, -73.1445131 45.6774183, -73.1444872 45.6774632, -73.1444483 45.677508, -73.1444223 45.6775619, -73.1443836 45.6776069, -73.1443576 45.6776517, -73.1443058 45.6777236, -73.1442411 45.6777954, -73.144125 45.677894, -73.1440605 45.6779568, -73.1439958 45.6780195, -73.1439312 45.6780823, -73.1438667 45.6781361, -73.1438023 45.6781899, -73.1437121 45.6782256, -73.1436792233908 45.67828465542142, -73.143635 45.6782434, -73.1435323 45.678252, -73.1434425 45.6782428, -73.1433528 45.6782155, -73.1432631 45.6781792, -73.1431991 45.6781611, -73.1430967 45.6781157, -73.1430071 45.6780704, -73.1429304 45.6780253, -73.1428408 45.677971, -73.1427643 45.6779078, -73.1427003 45.6778626, -73.1426366 45.6777993, -73.1425729 45.6777272, -73.142509 45.677664, -73.1424454 45.6775918, -73.1423687 45.6775285, -73.142305 45.6774564, -73.1422539 45.6774202, -73.1421645 45.677357, -73.1420878 45.6772937, -73.1420112 45.6772395, -73.1419474 45.6771763, -73.141858 45.6771131, -73.1417813 45.6770498, -73.1416919 45.6769866, -73.1416024 45.6769323, -73.1415001 45.676869, -73.1414106 45.6768057, -73.1413724 45.6767606, -73.1413213 45.6767245, -73.1412446 45.6766702, -73.141155 45.6766249, -73.141104 45.6765798, -73.1410658 45.6765346, -73.141079 45.6764807, -73.1411049 45.6764268, -73.1411694 45.676391, -73.1412339 45.6763463, -73.1412726 45.6763014, -73.1412859 45.6762474, -73.1413374 45.6762116, -73.1414017 45.6761938, -73.1414791 45.676149, -73.1415307 45.6761042, -73.1415823 45.6760504, -73.1416213 45.6759875, -73.1416729 45.6759337, -73.1417119 45.6758708, -73.1417635 45.675808, -73.1418152 45.6757542, -73.1418541 45.6756914, -73.141893 45.6756285, -73.1419319 45.6755836, -73.1419708 45.6755207, -73.1420353 45.6754579, -73.1420999 45.6753952, -73.1421516 45.6753414, -73.1422035 45.6752695, -73.1422424 45.6752067, -73.1422813 45.6751437, -73.1423458 45.67509, -73.142423 45.6750453, -73.1425004 45.6749915, -73.1425776 45.6749647, -73.142642 45.674929, -73.1427065 45.6748932, -73.1427709 45.6748573, -73.1428481 45.6748127, -73.1429253 45.6747859, -73.1430025 45.6747591, -73.1430541 45.6747233, -73.1430672 45.6746693, -73.1431062 45.6746155, -73.1431832 45.6745887), (-73.143398 45.6751473, -73.1433468 45.6751111, -73.1432186 45.6751017, -73.1431416 45.6751015, -73.1430516 45.6751192, -73.1429745 45.6751189, -73.1428974 45.6751367, -73.1428074 45.6751545, -73.1427302 45.6751812, -73.1426658 45.675226, -73.1426014 45.6752708, -73.1425625 45.6753246, -73.1425237 45.6753785, -73.142472 45.6754323, -73.1424075 45.6754771, -73.1423687 45.675522, -73.1423426 45.6755759, -73.1423938 45.675612, -73.1424708 45.6756123, -73.1425478 45.6756215, -73.1426247 45.6756308, -73.1426372 45.6756758, -73.1427014 45.6756939, -73.1427654 45.6757122, -73.142855 45.6757485, -73.1429191 45.6757576, -73.1430089 45.6757669, -73.1430729 45.6758121, -73.1431367 45.6758483, -73.1432008 45.6758665, -73.1432778 45.6758757, -73.1433676 45.6758761, -73.1434575 45.6758673, -73.1435473 45.6758855, -73.1436368 45.6759308, -73.1437263 45.6759761, -73.1438031 45.6760304, -73.1438797 45.6760846, -73.1439693 45.6761389, -73.144046 45.676184, -73.14411 45.6762113, -73.1441742 45.6762025, -73.1442002 45.6761575, -73.144162 45.6761124, -73.1441109 45.6760583, -73.1440472 45.6760041, -73.1439704 45.6759589, -73.1438937 45.6759136, -73.1438041 45.6758683, -73.1437017 45.6758321, -73.1436121 45.6757868, -73.1435353 45.6757506, -73.1435099 45.6757055, -73.1435231 45.6756606, -73.1435234 45.6755976, -73.1435109 45.6755435, -73.1434727 45.6754894, -73.1434474 45.6754444, -73.1434478 45.6753814, -73.1434225 45.6753273, -73.1433844 45.6752642, -73.1433975 45.6752103, -73.143398 45.6751473), (-73.1428634 45.6764413, -73.1428381 45.6763873, -73.1427612 45.6763691, -73.1426971 45.6763508, -73.1426331 45.6763326, -73.1425562 45.6763144, -73.142505 45.6762783, -73.1424412 45.6762331, -73.1424158 45.676188, -73.1423776 45.6761429, -73.1423137 45.6761067, -73.1422883 45.6760616, -73.1422244 45.6760074, -73.1421731 45.6760072, -73.1421088 45.676025, -73.1420956 45.67607, -73.1420312 45.6761058, -73.1419668 45.6761416, -73.141928 45.6761954, -73.1419277 45.6762494, -73.1419402 45.6763035, -73.1419783 45.6763576, -73.1420552 45.6763758, -73.1421321 45.676394, -73.1422088 45.6764303, -73.1422599 45.6764844, -73.1423238 45.6765116, -73.142388 45.6765299, -73.142465 45.67653, -73.142542 45.6765303, -73.142619 45.6765305, -73.1427089 45.6765308, -73.1427859 45.6765311, -73.1428503 45.6764863, -73.1428634 45.6764413), (-73.1446218 45.6764738, -73.1446092 45.6764198, -73.1445711 45.6763746, -73.1444943 45.6763295, -73.1444176 45.6762842, -73.1443409 45.676239, -73.1442511 45.6762297, -73.1441996 45.6762655, -73.1442247 45.6763376, -73.1442501 45.6763827, -73.1443011 45.6764458, -73.1443391 45.6764999, -73.1443774 45.676545, -73.1444543 45.6765543, -73.1445186 45.6765454, -73.1445958 45.6765188, -73.1446218 45.6764738), (-73.1443622 45.676914, -73.1443112 45.6768777, -73.1442472 45.6768415, -73.1441961 45.6767965, -73.1441707 45.6767513, -73.1441198 45.6766972, -73.144043 45.676652, -73.1439791 45.6766068, -73.1439024 45.6765705, -73.1437998 45.6765522, -73.1437354 45.676579, -73.1437864 45.6766242, -73.1438504 45.6766694, -73.1439143 45.6766966, -73.1439784 45.6767328, -73.1440421 45.676787, -73.1440931 45.6768411, -73.1441443 45.6768772, -73.144221 45.6769225, -73.1442849 45.6769587, -73.144362 45.6769679, -73.1443622 45.676914))");
		if (!out.equalsExact(expected)) Assert.fail("inserting verticies into polygons failed");
	}
	
	@Test
	public void testAddVertex2() throws Exception{
		
		String waterbody = "POLYGON (( -1476975.768834597 254458.79883857816, -1476975.6562530333 254465.10631726775, -1476973.8077800188 254473.00344426, -1476966.5131646597 254478.90474462602, -1476959.4605345314 254477.5392407775, -1476952.3638810036 254470.64779263362, -1476950.6714924262 254463.73312665056, -1476949.2850184224 254452.5802165158, -1476963.5111487831 254448.1702455664, -1476970.7861149963 254451.781457657, -1476975.768834597 254458.79883857816 ))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String ls1  = "LINESTRING ( -1476975.768834597 254458.79883857816 1224, -1476996.4232884517 254454.54364634864 1224, -1477007.5382961475 254446.75118244998 1224, -1477011.8446005557 254440.84933797456 1224, -1477015.3760393632 254433.68477412686 1224, -1477017.4463976969 254428.0342344148 1224, -1477019.172416558 254420.26336416416 1224, -1477020.0223615754 254408.85822055396 1224, -1477020.1358395824 254402.55117617827 1224, -1477020.6504143127 254395.20870070532 1224, -1477022.096913525 254388.34651883412 1224, -1477022.8910104292 254380.09533818346 1224, -1477023.2840106476 254372.87958506308 1224, -1477025.1311545945 254364.98285708204 1223, -1477028.3844236191 254358.7265288215 1223, -1477031.357281931 254353.3784470791 1223, -1477036.165450405 254348.8135922309 1223, -1477045.6969452838 254342.66139148083 1223, -1477054.9855538919 254343.77559146378 1222, -1477062.820017353 254345.5707661528 1222, -1477071.2774521858 254348.57712378725 1222, -1477077.4989322233 254351.8347928282 1222, -1477084.3442724426 254356.30409750156 1222, -1477091.2186058543 254360.9498759564 1221, -1477097.534344691 254367.41216662992 1221, -1477102.3950467524 254374.55497504864 1221, -1477105.6427643306 254383.16027130745 1221, -1477109.0129459412 254391.63928902708 1221, -1477112.9139508114 254401.63403253444 1221, -1477115.258735114 254409.93549670652 1221, -1477119.4102666287 254418.84506260138 1221, -1477121.8770604762 254427.02113810647 1221, -1477124.222731514 254435.32304879744 1221, -1477128.8038986688 254443.37454496603 1221, -1477133.6355940579 254450.34086901695 1221, -1477139.5506695886 254457.8376870975 1221, -1477145.7149300901 254464.24977316987 1220, -1477155.8496963726 254468.82134734187 1220, -1477165.0889127264 254472.257385307 1219, -1477173.9478585871 254474.22968012094 1219, -1477180.8793726945 254475.72105222289 1219, -1477189.114008091 254476.48260942567 1218, -1477198.2805828867 254477.72223046608 1218, -1477207.697672057 254477.87892005965 1218, -1477215.932761927 254478.63958980422 1217, -1477222.2109732195 254478.7437541457 1217, -1477228.6406439047 254478.8981160242 1217, -1477235.1983817958 254478.09358389303 1216, -1477242.5300914596 254478.55132199265 1216, -1477251.266572456 254480.64990724716 1216, -1477257.8613504868 254486.20440250542 1216 )";
		String ls2 = "LINESTRING ( -1476846.8207517161 254144.30887477845 1225, -1476840.9300085853 254151.85068617854 1224, -1476832.869048899 254162.6710901726 1224, -1476828.7124108202 254168.6245459374 1224, -1476825.3094985785 254174.82940126676 1224, -1476822.0852461213 254181.26225408446 1224, -1476819.7362765803 254187.82201200444 1224, -1476818.9695094812 254192.74188109022 1224, -1476823.7735423865 254203.03821944632 1224, -1476831.1583327372 254215.20267823618 1224, -1476832.8512024956 254222.11650386732 1224, -1476833.6696803593 254228.9038732536 1224, -1476832.3733249465 254235.81672567222 1224, -1476830.5262139954 254243.7134853024 1224, -1476825.8265002 254256.8320547957 1224, -1476823.1984700076 254264.29960148782 1224, -1476821.070954796 254273.1046005357 1224, -1476817.3603524151 254283.5490212515 1224, -1476816.0648911765 254290.46230872162 1224, -1476814.8974879452 254296.41669612937 1224, -1476819.7015099793 254306.71299540438 1224, -1476825.0200711598 254309.66680753417 1224, -1476831.960165048 254317.33979091793 1224, -1476837.8894508309 254330.18562139943 1224, -1476840.635815733 254337.452979045 1224, -1476848.0205789995 254349.61738769244 1224, -1476852.2293432944 254355.37250624876 1224, -1476856.811013774 254363.42307968065 1224, -1476863.1830669248 254366.7304565711 1224, -1476868.4453278575 254372.839137014 1224, -1476873.2770634918 254379.80542917643 1224, -1476877.8587281602 254387.85599995404 1224, -1476882.7194559558 254394.99876252655 1224, -1476886.7983739078 254401.7118659867 1224, -1476892.0610817242 254407.81965230126 1224, -1476897.6023996107 254413.02052411158 1224, -1476902.8637616732 254419.12874901854 1224, -1476907.6959413667 254426.09414509125 1224, -1476912.3343268076 254430.99119580165 1224, -1476919.553455459 254437.75636647362 1224, -1476924.8715441448 254440.71107754018 1224, -1476931.0934680724 254443.96782691404 1224, -1476935.5090632748 254446.62006267346 1224, -1476937.3149377962 254447.22546900995 1224, -1476945.5218280419 254451.316970109 1224, -1476949.2850184224 254452.5802165158 1224 )";
		
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
	
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-1476959.4605345314, 254477.5392407775), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1476963.5111487831, 254448.1702455664), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1476975.768834597, 254458.79883857816), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1476949.2850184224, 254452.5802165158), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	@Test
	public void testIslandWithFlow() throws Exception {
		String waterbody = "POLYGON (( -73.1431832 45.6745887,-73.1432731 45.674589,-73.1433372 45.6745982,-73.1434013 45.6746163,-73.1434654 45.6746346,-73.1435293 45.6746798,-73.143619 45.6747071,-73.1436959 45.6747253,-73.1437212 45.6747704,-73.1437723 45.6748245,-73.1438362 45.6748517,-73.143913 45.6748879,-73.1439641 45.6749241,-73.1440023 45.6749872,-73.1440532 45.6750503,-73.144117 45.6750955,-73.1441811 45.6751317,-73.1442579 45.6751589,-73.1443476 45.6751772,-73.1444116 45.6752045,-73.1444627 45.6752406,-73.1445394 45.6752858,-73.1446033 45.67534,-73.1446671 45.6753852,-73.144744 45.6754124,-73.1447951 45.6754485,-73.1448462 45.6755027,-73.1448842 45.6755748,-73.1449222 45.6756559,-73.1449474 45.675728,-73.1449726 45.6758001,-73.1449979 45.6758541,-73.1450232 45.6759082,-73.1450229 45.6759711,-73.1450354 45.6760162,-73.1450477 45.6761062,-73.1450603 45.6761512,-73.1450857 45.6761963,-73.1450982 45.6762413,-73.1451236 45.6762864,-73.1451484 45.6764125,-73.1451608 45.6764935,-73.1451603 45.6765565,-73.1451472 45.6766104,-73.1451082 45.6766823,-73.1450693 45.6767542,-73.1450561 45.6767991,-73.1450044 45.6768619,-73.1449398 45.6769247,-73.1448881 45.6769876,-73.1448492 45.6770504,-73.1447846 45.6771042,-73.144733 45.677149,-73.1446812 45.6772118,-73.1446295 45.6772747,-73.1445778 45.6773465,-73.1445131 45.6774183,-73.1444872 45.6774632,-73.1444483 45.677508,-73.1444223 45.6775619,-73.1443836 45.6776069,-73.1443576 45.6776517,-73.1443058 45.6777236,-73.1442411 45.6777954,-73.144125 45.677894,-73.1440605 45.6779568,-73.1439958 45.6780195,-73.1439312 45.6780823,-73.1438667 45.6781361,-73.1438023 45.6781899,-73.1437121 45.6782256,-73.143635 45.6782434,-73.1435323 45.678252,-73.1434425 45.6782428,-73.1433528 45.6782155,-73.1432631 45.6781792,-73.1431991 45.6781611,-73.1430967 45.6781157,-73.1430071 45.6780704,-73.1429304 45.6780253,-73.1428408 45.677971,-73.1427643 45.6779078,-73.1427003 45.6778626,-73.1426366 45.6777993,-73.1425729 45.6777272,-73.142509 45.677664,-73.1424454 45.6775918,-73.1423687 45.6775285,-73.142305 45.6774564,-73.1422539 45.6774202,-73.1421645 45.677357,-73.1420878 45.6772937,-73.1420112 45.6772395,-73.1419474 45.6771763,-73.141858 45.6771131,-73.1417813 45.6770498,-73.1416919 45.6769866,-73.1416024 45.6769323,-73.1415001 45.676869,-73.1414106 45.6768057,-73.1413724 45.6767606,-73.1413213 45.6767245,-73.1412446 45.6766702,-73.141155 45.6766249,-73.141104 45.6765798,-73.1410658 45.6765346,-73.141079 45.6764807,-73.1411049 45.6764268,-73.1411694 45.676391,-73.1412339 45.6763463,-73.1412726 45.6763014,-73.1412859 45.6762474,-73.1413374 45.6762116,-73.1414017 45.6761938,-73.1414791 45.676149,-73.1415307 45.6761042,-73.1415823 45.6760504,-73.1416213 45.6759875,-73.1416729 45.6759337,-73.1417119 45.6758708,-73.1417635 45.675808,-73.1418152 45.6757542,-73.1418541 45.6756914,-73.141893 45.6756285,-73.1419319 45.6755836,-73.1419708 45.6755207,-73.1420353 45.6754579,-73.1420999 45.6753952,-73.1421516 45.6753414,-73.1422035 45.6752695,-73.1422424 45.6752067,-73.1422813 45.6751437,-73.1423458 45.67509,-73.142423 45.6750453,-73.1425004 45.6749915,-73.1425776 45.6749647,-73.142642 45.674929,-73.1427065 45.6748932,-73.1427709 45.6748573,-73.1428481 45.6748127,-73.1429253 45.6747859,-73.1430025 45.6747591,-73.1430541 45.6747233,-73.1430672 45.6746693,-73.1431062 45.6746155,-73.1431832 45.6745887 ),( -73.143398 45.6751473,-73.1433468 45.6751111,-73.1432186 45.6751017,-73.1431416 45.6751015,-73.1430516 45.6751192,-73.1429745 45.6751189,-73.1428974 45.6751367,-73.1428074 45.6751545,-73.1427302 45.6751812,-73.1426658 45.675226,-73.1426014 45.6752708,-73.1425625 45.6753246,-73.1425237 45.6753785,-73.142472 45.6754323,-73.1424075 45.6754771,-73.1423687 45.675522,-73.1423426 45.6755759,-73.1423938 45.675612,-73.1424708 45.6756123,-73.1425478 45.6756215,-73.1426247 45.6756308,-73.1426372 45.6756758,-73.1427014 45.6756939,-73.1427654 45.6757122,-73.142855 45.6757485,-73.1429191 45.6757576,-73.1430089 45.6757669,-73.1430729 45.6758121,-73.1431367 45.6758483,-73.1432008 45.6758665,-73.1432778 45.6758757,-73.1433676 45.6758761,-73.1434575 45.6758673,-73.1435473 45.6758855,-73.1436368 45.6759308,-73.1437263 45.6759761,-73.1438031 45.6760304,-73.1438797 45.6760846,-73.1439693 45.6761389,-73.144046 45.676184,-73.14411 45.6762113,-73.1441742 45.6762025,-73.1442002 45.6761575,-73.144162 45.6761124,-73.1441109 45.6760583,-73.1440472 45.6760041,-73.1439704 45.6759589,-73.1438937 45.6759136,-73.1438041 45.6758683,-73.1437017 45.6758321,-73.1436121 45.6757868,-73.1435353 45.6757506,-73.1435099 45.6757055,-73.1435231 45.6756606,-73.1435234 45.6755976,-73.1435109 45.6755435,-73.1434727 45.6754894,-73.1434474 45.6754444,-73.1434478 45.6753814,-73.1434225 45.6753273,-73.1433844 45.6752642,-73.1433975 45.6752103,-73.143398 45.6751473 ),( -73.1428634 45.6764413,-73.1428381 45.6763873,-73.1427612 45.6763691,-73.1426971 45.6763508,-73.1426331 45.6763326,-73.1425562 45.6763144,-73.142505 45.6762783,-73.1424412 45.6762331,-73.1424158 45.676188,-73.1423776 45.6761429,-73.1423137 45.6761067,-73.1422883 45.6760616,-73.1422244 45.6760074,-73.1421731 45.6760072,-73.1421088 45.676025,-73.1420956 45.67607,-73.1420312 45.6761058,-73.1419668 45.6761416,-73.141928 45.6761954,-73.1419277 45.6762494,-73.1419402 45.6763035,-73.1419783 45.6763576,-73.1420552 45.6763758,-73.1421321 45.676394,-73.1422088 45.6764303,-73.1422599 45.6764844,-73.1423238 45.6765116,-73.142388 45.6765299,-73.142465 45.67653,-73.142542 45.6765303,-73.142619 45.6765305,-73.1427089 45.6765308,-73.1427859 45.6765311,-73.1428503 45.6764863,-73.1428634 45.6764413 ),( -73.1446218 45.6764738,-73.1446092 45.6764198,-73.1445711 45.6763746,-73.1444943 45.6763295,-73.1444176 45.6762842,-73.1443409 45.676239,-73.1442511 45.6762297,-73.1441996 45.6762655,-73.1442247 45.6763376,-73.1442501 45.6763827,-73.1443011 45.6764458,-73.1443391 45.6764999,-73.1443774 45.676545,-73.1444543 45.6765543,-73.1445186 45.6765454,-73.1445958 45.6765188,-73.1446218 45.6764738 ),( -73.1443622 45.676914,-73.1443112 45.6768777,-73.1442472 45.6768415,-73.1441961 45.6767965,-73.1441707 45.6767513,-73.1441198 45.6766972,-73.144043 45.676652,-73.1439791 45.6766068,-73.1439024 45.6765705,-73.1437998 45.6765522,-73.1437354 45.676579,-73.1437864 45.6766242,-73.1438504 45.6766694,-73.1439143 45.6766966,-73.1439784 45.6767328,-73.1440421 45.676787,-73.1440931 45.6768411,-73.1441443 45.6768772,-73.144221 45.6769225,-73.1442849 45.6769587,-73.144362 45.6769679,-73.1443622 45.676914 ))";

		String lsin  = "LINESTRING ( -73.14743091402767 45.67742811665025, -73.14688299284026 45.67754658609617, -73.14663124526766 45.67735407324654, -73.14633507165284 45.67704309095099, -73.14608332408025 45.67679134337839, -73.14589081123063 45.67665806525172, -73.14563906365802 45.67658402184802, -73.14540212476618 45.676569213167284, -73.1451472 45.6766104)";
		String lsout = "LINESTRING ( -73.1410658 45.6765346,-73.14067815560986 45.676613639209506,-73.14026351254913 45.67658402184802,-73.14002657365727 45.6765395958058,-73.13970078268098 45.67646555240209,-73.13956750455431 45.676435935040615,-73.13943422642764 45.67642112635987,-73.1390195833669 45.67642112635987)";
		String lsin2 = "LINESTRING ( -73.14322344919614 45.67545271038419,-73.14308112635489 45.67556218949286,-73.14292785560276 45.67563882486892, -73.142855 45.6757485)";

		Polygon polygon = (Polygon)reader.read(waterbody);
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(lsin));
		items.add((LineString)reader.read(lsout));
		items.add((LineString)reader.read(lsin2));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.1451472, 45.6766104), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.142855, 45.6757485), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1410658, 45.6765346), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		
		expected.add(new ConstructionPoint(new Coordinate(-73.1431991, 45.6781611), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1432731, 45.674589), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1441996, 45.6762655), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.141928, 45.6761954), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1437354, 45.676579), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1435231, 45.6756606), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
	
		//-- multiple inputs on island
		String lsin3 = "LINESTRING (-73.14329344745352 45.67568321563133, -73.14338602180557 45.675645344305494, -73.1434238931314 45.675599057129475, -73.14347018030743 45.67559484920438, -73.1435234 45.6755976)";
		items.add((LineString)reader.read(lsin3));
		
		pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		pnts = pg.getPoints();
		
		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.1451472, 45.6766104), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.142855, 45.6757485), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1435234, 45.6755976), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1410658, 45.6765346), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1431991, 45.6781611), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1437354, 45.676579) , NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1432731, 45.674589) , NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1427302, 45.6751812), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1439693, 45.6761389), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.141928, 45.6761954) , NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint( new Coordinate(-73.1441996, 45.6762655), NodeType.BANK, FlowDirection.INPUT, null));

		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testSingleInSingleOut() throws Exception {
		String waterbody = "POLYGON (( -73.1431832 45.6745887,-73.1432731 45.674589,-73.1433372 45.6745982,-73.1434013 45.6746163,-73.1434654 45.6746346,-73.1435293 45.6746798,-73.143619 45.6747071,-73.1436959 45.6747253,-73.1437212 45.6747704,-73.1437723 45.6748245,-73.1438362 45.6748517,-73.143913 45.6748879,-73.1439641 45.6749241,-73.1440023 45.6749872,-73.1440532 45.6750503,-73.144117 45.6750955,-73.1441811 45.6751317,-73.1442579 45.6751589,-73.1443476 45.6751772,-73.1444116 45.6752045,-73.1444627 45.6752406,-73.1445394 45.6752858,-73.1446033 45.67534,-73.1446671 45.6753852,-73.144744 45.6754124,-73.1447951 45.6754485,-73.1448462 45.6755027,-73.1448842 45.6755748,-73.1449222 45.6756559,-73.1449474 45.675728,-73.1449726 45.6758001,-73.1449979 45.6758541,-73.1450232 45.6759082,-73.1450229 45.6759711,-73.1450354 45.6760162,-73.1450477 45.6761062,-73.1450603 45.6761512,-73.1450857 45.6761963,-73.1450982 45.6762413,-73.1451236 45.6762864,-73.1451484 45.6764125,-73.1451608 45.6764935,-73.1451603 45.6765565,-73.1451472 45.6766104,-73.1451082 45.6766823,-73.1450693 45.6767542,-73.1450561 45.6767991,-73.1450044 45.6768619,-73.1449398 45.6769247,-73.1448881 45.6769876,-73.1448492 45.6770504,-73.1447846 45.6771042,-73.144733 45.677149,-73.1446812 45.6772118,-73.1446295 45.6772747,-73.1445778 45.6773465,-73.1445131 45.6774183,-73.1444872 45.6774632,-73.1444483 45.677508,-73.1444223 45.6775619,-73.1443836 45.6776069,-73.1443576 45.6776517,-73.1443058 45.6777236,-73.1442411 45.6777954,-73.144125 45.677894,-73.1440605 45.6779568,-73.1439958 45.6780195,-73.1439312 45.6780823,-73.1438667 45.6781361,-73.1438023 45.6781899,-73.1437121 45.6782256,-73.143635 45.6782434,-73.1435323 45.678252,-73.1434425 45.6782428,-73.1433528 45.6782155,-73.1432631 45.6781792,-73.1431991 45.6781611,-73.1430967 45.6781157,-73.1430071 45.6780704,-73.1429304 45.6780253,-73.1428408 45.677971,-73.1427643 45.6779078,-73.1427003 45.6778626,-73.1426366 45.6777993,-73.1425729 45.6777272,-73.142509 45.677664,-73.1424454 45.6775918,-73.1423687 45.6775285,-73.142305 45.6774564,-73.1422539 45.6774202,-73.1421645 45.677357,-73.1420878 45.6772937,-73.1420112 45.6772395,-73.1419474 45.6771763,-73.141858 45.6771131,-73.1417813 45.6770498,-73.1416919 45.6769866,-73.1416024 45.6769323,-73.1415001 45.676869,-73.1414106 45.6768057,-73.1413724 45.6767606,-73.1413213 45.6767245,-73.1412446 45.6766702,-73.141155 45.6766249,-73.141104 45.6765798,-73.1410658 45.6765346,-73.141079 45.6764807,-73.1411049 45.6764268,-73.1411694 45.676391,-73.1412339 45.6763463,-73.1412726 45.6763014,-73.1412859 45.6762474,-73.1413374 45.6762116,-73.1414017 45.6761938,-73.1414791 45.676149,-73.1415307 45.6761042,-73.1415823 45.6760504,-73.1416213 45.6759875,-73.1416729 45.6759337,-73.1417119 45.6758708,-73.1417635 45.675808,-73.1418152 45.6757542,-73.1418541 45.6756914,-73.141893 45.6756285,-73.1419319 45.6755836,-73.1419708 45.6755207,-73.1420353 45.6754579,-73.1420999 45.6753952,-73.1421516 45.6753414,-73.1422035 45.6752695,-73.1422424 45.6752067,-73.1422813 45.6751437,-73.1423458 45.67509,-73.142423 45.6750453,-73.1425004 45.6749915,-73.1425776 45.6749647,-73.142642 45.674929,-73.1427065 45.6748932,-73.1427709 45.6748573,-73.1428481 45.6748127,-73.1429253 45.6747859,-73.1430025 45.6747591,-73.1430541 45.6747233,-73.1430672 45.6746693,-73.1431062 45.6746155,-73.1431832 45.6745887 ),( -73.143398 45.6751473,-73.1433468 45.6751111,-73.1432186 45.6751017,-73.1431416 45.6751015,-73.1430516 45.6751192,-73.1429745 45.6751189,-73.1428974 45.6751367,-73.1428074 45.6751545,-73.1427302 45.6751812,-73.1426658 45.675226,-73.1426014 45.6752708,-73.1425625 45.6753246,-73.1425237 45.6753785,-73.142472 45.6754323,-73.1424075 45.6754771,-73.1423687 45.675522,-73.1423426 45.6755759,-73.1423938 45.675612,-73.1424708 45.6756123,-73.1425478 45.6756215,-73.1426247 45.6756308,-73.1426372 45.6756758,-73.1427014 45.6756939,-73.1427654 45.6757122,-73.142855 45.6757485,-73.1429191 45.6757576,-73.1430089 45.6757669,-73.1430729 45.6758121,-73.1431367 45.6758483,-73.1432008 45.6758665,-73.1432778 45.6758757,-73.1433676 45.6758761,-73.1434575 45.6758673,-73.1435473 45.6758855,-73.1436368 45.6759308,-73.1437263 45.6759761,-73.1438031 45.6760304,-73.1438797 45.6760846,-73.1439693 45.6761389,-73.144046 45.676184,-73.14411 45.6762113,-73.1441742 45.6762025,-73.1442002 45.6761575,-73.144162 45.6761124,-73.1441109 45.6760583,-73.1440472 45.6760041,-73.1439704 45.6759589,-73.1438937 45.6759136,-73.1438041 45.6758683,-73.1437017 45.6758321,-73.1436121 45.6757868,-73.1435353 45.6757506,-73.1435099 45.6757055,-73.1435231 45.6756606,-73.1435234 45.6755976,-73.1435109 45.6755435,-73.1434727 45.6754894,-73.1434474 45.6754444,-73.1434478 45.6753814,-73.1434225 45.6753273,-73.1433844 45.6752642,-73.1433975 45.6752103,-73.143398 45.6751473 ),( -73.1428634 45.6764413,-73.1428381 45.6763873,-73.1427612 45.6763691,-73.1426971 45.6763508,-73.1426331 45.6763326,-73.1425562 45.6763144,-73.142505 45.6762783,-73.1424412 45.6762331,-73.1424158 45.676188,-73.1423776 45.6761429,-73.1423137 45.6761067,-73.1422883 45.6760616,-73.1422244 45.6760074,-73.1421731 45.6760072,-73.1421088 45.676025,-73.1420956 45.67607,-73.1420312 45.6761058,-73.1419668 45.6761416,-73.141928 45.6761954,-73.1419277 45.6762494,-73.1419402 45.6763035,-73.1419783 45.6763576,-73.1420552 45.6763758,-73.1421321 45.676394,-73.1422088 45.6764303,-73.1422599 45.6764844,-73.1423238 45.6765116,-73.142388 45.6765299,-73.142465 45.67653,-73.142542 45.6765303,-73.142619 45.6765305,-73.1427089 45.6765308,-73.1427859 45.6765311,-73.1428503 45.6764863,-73.1428634 45.6764413 ),( -73.1446218 45.6764738,-73.1446092 45.6764198,-73.1445711 45.6763746,-73.1444943 45.6763295,-73.1444176 45.6762842,-73.1443409 45.676239,-73.1442511 45.6762297,-73.1441996 45.6762655,-73.1442247 45.6763376,-73.1442501 45.6763827,-73.1443011 45.6764458,-73.1443391 45.6764999,-73.1443774 45.676545,-73.1444543 45.6765543,-73.1445186 45.6765454,-73.1445958 45.6765188,-73.1446218 45.6764738 ),( -73.1443622 45.676914,-73.1443112 45.6768777,-73.1442472 45.6768415,-73.1441961 45.6767965,-73.1441707 45.6767513,-73.1441198 45.6766972,-73.144043 45.676652,-73.1439791 45.6766068,-73.1439024 45.6765705,-73.1437998 45.6765522,-73.1437354 45.676579,-73.1437864 45.6766242,-73.1438504 45.6766694,-73.1439143 45.6766966,-73.1439784 45.6767328,-73.1440421 45.676787,-73.1440931 45.6768411,-73.1441443 45.6768772,-73.144221 45.6769225,-73.1442849 45.6769587,-73.144362 45.6769679,-73.1443622 45.676914 ))";

		String lsin  = "LINESTRING ( -73.14743091402767 45.67742811665025, -73.14688299284026 45.67754658609617, -73.14663124526766 45.67735407324654, -73.14633507165284 45.67704309095099, -73.14608332408025 45.67679134337839, -73.14589081123063 45.67665806525172, -73.14563906365802 45.67658402184802, -73.14540212476618 45.676569213167284, -73.1451472 45.6766104)";
		String lsout = "LINESTRING ( -73.1410658 45.6765346,-73.14067815560986 45.676613639209506,-73.14026351254913 45.67658402184802,-73.14002657365727 45.6765395958058,-73.13970078268098 45.67646555240209,-73.13956750455431 45.676435935040615,-73.13943422642764 45.67642112635987,-73.1390195833669 45.67642112635987)";
		
		Polygon polygon = (Polygon)reader.read(waterbody);
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(lsin));
		items.add((LineString)reader.read(lsout));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.1451472, 45.6766104), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1410658, 45.6765346), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1432731, 45.674589) , NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1437354, 45.676579) , NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1433676, 45.6758761), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1441996, 45.6762655), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1431991, 45.6781611), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.141928, 45.6761954) , NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testSingleIn() throws Exception {
		String waterbody = "POLYGON((-73.3162237 45.551731,-73.3161594 45.5518028,-73.3160821 45.5519557,-73.3160691 45.5520097,-73.3160562 45.5520637,-73.3160176 45.5521086,-73.3160047 45.5521535,-73.3159661 45.5521985,-73.3159147 45.5522434,-73.3158507 45.5522523,-73.3157737 45.5522791,-73.3157097 45.5522701,-73.3156328 45.55227,-73.3155689 45.5522518,-73.3155049 45.5522157,-73.3154283 45.5521706,-73.3153644 45.5521075,-73.3153389 45.5520625,-73.3153008 45.5520085,-73.3152626 45.5519364,-73.3152115 45.5518643,-73.3151476 45.5518102,-73.3150838 45.5517651,-73.3150198 45.55172,-73.314956 45.551675,-73.314892 45.5516299,-73.3148282 45.5515938,-73.3147642 45.5515486,-73.3146747 45.5515125,-73.3145981 45.5514674,-73.3145214 45.5514313,-73.3144573 45.5514132,-73.3143167 45.551368,-73.3142016 45.5513228,-73.3141247 45.5513047,-73.3140479 45.5513045,-73.3139584 45.5512594,-73.3139072 45.5512233,-73.3138562 45.5511783,-73.3138307 45.5511332,-73.3138181 45.5510882,-73.3137799 45.5510162,-73.3137672 45.5509711,-73.3137418 45.5509081,-73.313742 45.5508541,-73.3137421 45.5508001,-73.3137551 45.5507732,-73.3138064 45.5507192,-73.3138834 45.5506833,-73.3139475 45.5506565,-73.3140373 45.5506116,-73.314127 45.5505938,-73.3142039 45.5505849,-73.3142681 45.550576,-73.3143833 45.5505673,-73.3144729 45.5505584,-73.3145371 45.5505495,-73.3146908 45.5505317,-73.3148061 45.5505319,-73.3148958 45.5505321,-73.3150238 45.5505143,-73.3151006 45.5505144,-73.3152416 45.5505236,-73.3153439 45.5505508,-73.3154335 45.550569,-73.315523 45.5506051,-73.3155998 45.5506502,-73.3156637 45.5506773,-73.3157787 45.5507405,-73.3158426 45.5507765,-73.3159066 45.5508036,-73.3159578 45.5508397,-73.3160472 45.5508939,-73.3161238 45.550948,-73.3161878 45.5509931,-73.3162388 45.5510291,-73.3163028 45.5510652,-73.3163923 45.5511013,-73.3164435 45.5511465,-73.3164816 45.5511915,-73.316507 45.5512546,-73.3165069 45.5513175,-73.3164939 45.5513715,-73.3164424 45.5514434,-73.3164039 45.5514973,-73.3163652 45.5515513,-73.3163009 45.5516232,-73.3162367 45.551686,-73.3162237 45.551731))";

		String lsin  = "LINESTRING (-73.31722538613438 45.55270391405227, -73.31693567728001 45.552672499839154, -73.3167646443419 45.552553823922906, -73.3166669112344 45.55241420519791, -73.31653427344565 45.552299019749796, -73.31635975003942 45.55227458647292, -73.31615730288817 45.552246662727924, -73.31603513650381 45.55221873898292, -73.3159661 45.5521985)";
		Polygon polygon = (Polygon)reader.read(waterbody);
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(lsin));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.3159661, 45.5521985), NodeType.FLOWPATH, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3142681, 45.550576), NodeType.TERMINAL, FlowDirection.OUTPUT, null));
//		expected.add(new SkeletonPoint(new Coordinate(-73.3159578, 45.5508397), NodeType.BANK, FlowFlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3145214, 45.5514313), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testWaterbodyOnIsland() throws Exception{
		String waterbody = "POLYGON (( -73.2787552059845 45.455281852799466, -73.2774032486515 45.45613653846975, -73.2755074004374 45.45596560133569, -73.27372033039953 45.45607437951191, -73.27201095905895 45.4558102039411, -73.27062792224703 45.45532847201785, -73.26831250106753 45.454753501657834, -73.26678960660047 45.454644723481614, -73.265422109528 45.45315290849347, -73.26439648672365 45.451288139758304, -73.26425662906853 45.44959430815719, -73.26587276197233 45.448164652126884, -73.26849897794104 45.44721672801984, -73.27190218088273 45.447185648540916, -73.27454393659089 45.44822681108472, -73.27791606005367 45.44920581467069, -73.27915923921044 45.45203404725237, -73.27824239458232 45.45352586224051, -73.2779005203142 45.45408529286106, -73.2787552059845 45.455281852799466 ), ( -73.27718569229906 45.45170771272372, -73.27381356883629 45.449765245291246, -73.26825034210968 45.44844436743716, -73.26658758998748 45.45057331174315, -73.26720917956588 45.45223606386535, -73.26907394830106 45.45330830588807, -73.27025088565607 45.453675630285495, -73.27060309198386 45.453785554553406, -73.2709181385147 45.45388388117768, -73.27151368739624 45.4540697531216, -73.27530538382442 45.454318388952956, -73.27668842063635 45.45288873292266, -73.27718569229906 45.45170771272372 ))";
		
		String w1 = "POLYGON (( -73.27072116068379 45.4527177957886, -73.27109411443082 45.453230607190775, -73.27104749521244 45.45358802119835, -73.2709181385147 45.45388388117768, -73.27060309198386 45.453785554553406, -73.27025088565607 45.453675630285495, -73.27019280954215 45.45319952771185, -73.27006849162647 45.4529508918805, -73.26969553787944 45.45277995474644, -73.269477981527 45.452267143344265, -73.27042590563406 45.45234484204157, -73.27072116068379 45.4527177957886 ))";

		String fp1 = "LINESTRING ( -73.26054263133763 45.44717010880146, -73.26145947596576 45.4483511290004, -73.26265603590416 45.4487396224869, -73.26361949975067 45.44929905310745, -73.26425662906853 45.44959430815719 )";
		String fp2 = "LINESTRING ( -73.2774032486515 45.45613653846975, -73.27824239458232 45.4567736677876, -73.28032471966993 45.457985767465466 )";
		String fp3 = "LINESTRING ( -73.26863883559618 45.45082194757451, -73.26868545481456 45.451614474286956, -73.269477981527 45.452267143344265 )";
		
		Polygon polygon = (Polygon)reader.read(waterbody);
		
		ArrayList<LineString> items = new ArrayList<>();
		for (String fp : new String[] {fp1, fp2, fp3}) items.add((LineString)reader.read(fp));
		
		ArrayList<Polygon> wbitems = new ArrayList<>();
		for (String fp : new String[] {w1}) wbitems.add((Polygon)reader.read(fp));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, wbitems, items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		for (ConstructionPoint p : pnts) {
			System.out.println("expected.add(new ConstructionPoint(new Coordinate("
		+ p.getCoordinate().x + ", " + p.getCoordinate().getY() + "), NodeType." 
					+ p.getType().name() +", FlowDirection." + p.getDirection().name() + ",null));");
		}
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.2774032486515, 45.45613653846975), NodeType.FLOWPATH, FlowDirection.OUTPUT,null));
		expected.add(new ConstructionPoint(new Coordinate(-73.26425662906853, 45.44959430815719), NodeType.FLOWPATH, FlowDirection.INPUT,null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27060309198386, 45.453785554553406), NodeType.WATER, FlowDirection.UNKNOWN,null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27454393659089, 45.44822681108472), NodeType.BANK, FlowDirection.INPUT,null));
		expected.add(new ConstructionPoint(new Coordinate(-73.26831250106753, 45.454753501657834), NodeType.BANK, FlowDirection.INPUT,null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27381356883629, 45.449765245291246), NodeType.BANK, FlowDirection.INPUT,null));

		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testWaterbody() throws Exception{
		List<ConstructionPoint> pnts = null;
				
		String waterbody = "POLYGON (( -73.3265125 45.0738334, -73.3264997 45.0738604, -73.3264232 45.0739323, -73.3263849 45.0739773, -73.3263593 45.0740671, -73.3263465 45.0741121, -73.3262699 45.074238, -73.3262444 45.074274, -73.3261933 45.0743639, -73.3261804 45.0744089, -73.3261677 45.0744538, -73.3261548 45.0744988, -73.326142 45.0745438, -73.3260527 45.0746607, -73.3260272 45.0746966, -73.3260144 45.0747326, -73.3260142 45.0747866, -73.3259759 45.0748675, -73.3259504 45.0749034, -73.3259247 45.0749754, -73.3258482 45.0750923, -73.3258227 45.0751283, -73.3242534 45.0746328, -73.3231938 45.0742982, -73.3218652 45.0738787, -73.3203353 45.0733956, -73.3196588 45.0731819, -73.317918 45.0726322, -73.3179436 45.0725962, -73.3179567 45.0724883, -73.3179573 45.0722902, -73.3179578 45.0721013, -73.3179837 45.0719753, -73.3180221 45.0718674, -73.3179844 45.0717504, -73.3179595 45.0715884, -73.3179852 45.0714894, -73.3181508 45.0713457, -73.3182017 45.0712737, -73.3182526 45.0712468, -73.3182655 45.0712018, -73.3182784 45.0711569, -73.3182658 45.0711209, -73.318266 45.0710759, -73.3182787 45.0710399, -73.3183169 45.071004, -73.3183424 45.070968, -73.3183809 45.0708511, -73.3184064 45.0708151, -73.3184192 45.0707792, -73.3184448 45.0707432, -73.3184576 45.0707073, -73.3184451 45.0706622, -73.3183943 45.0706531, -73.3183181 45.070653, -73.3182546 45.0706439, -73.3181911 45.0706258, -73.3181277 45.0706077, -73.3181279 45.0705537, -73.31842 45.0705362, -73.3184835 45.0705453, -73.3185597 45.0705454, -73.3186105 45.0705365, -73.3186488 45.0705096, -73.3186361 45.0704645, -73.3185854 45.0704374, -73.3185855 45.0703924, -73.3186111 45.0703475, -73.3186114 45.0702575, -73.3185862 45.0702125, -73.3185484 45.0700955, -73.3185237 45.0698884, -73.318524 45.0697894, -73.3185368 45.0697445, -73.3185751 45.0697085, -73.3186767 45.0696727, -73.318842 45.0696369, -73.3188802 45.06961, -73.3188929 45.0695651, -73.3188803 45.069529, -73.3188424 45.069484, -73.3188553 45.06943, -73.3188935 45.069394, -73.3189319 45.0692951, -73.3189577 45.0691872, -73.3190214 45.0691063, -73.3190596 45.0690794, -73.319085 45.0690614, -73.3191614 45.0690345, -73.3192503 45.0690346, -73.3193137 45.0690257, -73.3193646 45.0689988, -73.3194411 45.0689179, -73.3194795 45.0688101, -73.319556 45.0687382, -73.3195815 45.0687022, -73.3195436 45.0686211, -73.3194676 45.0685491, -73.3194424 45.068504, -73.3194298 45.068459, -73.3194045 45.0684229, -73.3193031 45.0683688, -73.3192651 45.0683327, -73.3192272 45.0682787, -73.3191639 45.0682246, -73.3191514 45.0681796, -73.3191261 45.0681435, -73.3191008 45.0680715, -73.3190755 45.0680354, -73.3190377 45.0679544, -73.3190252 45.0679094, -73.3190001 45.0678283, -73.3189623 45.0677113, -73.3189625 45.0676573, -73.3189499 45.0676213, -73.3189502 45.0675313, -73.3189631 45.0674864, -73.3189758 45.0674414, -73.319027 45.0673425, -73.3190399 45.0672885, -73.3191166 45.0671266, -73.3191677 45.0670457, -73.3191804 45.0670008, -73.3191553 45.0669287, -73.3191173 45.0668926, -73.3190665 45.0668835, -73.3190283 45.0669105, -73.3189649 45.0669194, -73.3188251 45.0669192, -73.3187744 45.0669011, -73.3187618 45.0668651, -73.3187747 45.0668291, -73.3188889 45.0668113, -73.3189524 45.0668114, -73.3190667 45.0668296, -73.3191809 45.0668567, -73.3192444 45.0668568, -73.3192825 45.0668299, -73.3192573 45.0667849, -73.3192065 45.0667668, -73.3191559 45.0667578, -73.3190797 45.0667576, -73.3190162 45.0667485, -73.3189527 45.0667394, -73.3189147 45.0667123, -73.3189404 45.0666404, -73.3189911 45.0666135, -73.319042 45.0666045, -73.3191056 45.0665776, -73.3191184 45.0665326, -73.3191566 45.0664788, -73.3191949 45.0664338, -73.3192716 45.06629, -73.3193227 45.066173, -73.3193483 45.0661371, -73.3193611 45.0660921, -73.3194123 45.0659662, -73.3194507 45.0658853, -73.3195145 45.0657684, -73.31954 45.0657324, -73.3195656 45.0656605, -73.3195911 45.0656245, -73.3196039 45.0655885, -73.319655 45.0655167, -73.3196678 45.0654807, -73.3196679 45.0654267, -73.3196807 45.0653907, -73.3196809 45.0653367, -73.3196429 45.0653096, -73.3195921 45.0653005, -73.3195414 45.0652825, -73.3195034 45.0652554, -73.3194781 45.0652194, -73.3194656 45.0651653, -73.3195165 45.0651474, -73.31958 45.0651475, -73.3196307 45.0651386, -73.3196942 45.0651388, -73.319999 45.0651482, -73.3201259 45.0651484, -73.3201768 45.0651305, -73.3203421 45.0650587, -73.320393 45.0650318, -73.3204694 45.0649599, -73.3204951 45.0648701, -73.3204952 45.064834, -73.3204699 45.064789, -73.3204319 45.0647619, -73.3203685 45.0647348, -73.3203305 45.0646988, -73.3203053 45.0646628, -73.3203055 45.0646087, -73.3202929 45.0645727, -73.320293 45.0645277, -73.3202805 45.0644917, -73.3202805 45.0644468, -73.3202679 45.0644107, -73.3202808 45.0643657, -73.320281 45.0643207, -73.3202815 45.0641318, -73.320282 45.0639878, -73.3202948 45.0639428, -73.3203332 45.0638618, -73.3203843 45.063781, -73.3204606 45.0637091, -73.3204861 45.0636732, -73.320537 45.0636552, -73.3205752 45.0636283, -73.3205626 45.0636103, -73.320588 45.0635833, -73.3207155 45.0634305, -73.3205761 45.0633043, -73.3204748 45.0632141, -73.3204243 45.0631421, -73.3204117 45.0631061, -73.3204246 45.0630611, -73.3204501 45.0630161, -73.3204757 45.0629712, -73.3205905 45.0628093, -73.3206159 45.0627644, -73.320667 45.0626835, -73.3207052 45.0626476, -73.3207308 45.0626116, -73.3207689 45.0625847, -73.3208199 45.0625128, -73.3208837 45.0624319, -73.3208965 45.0623869, -73.3209093 45.0623419, -73.3209222 45.0622969, -73.3209479 45.062216, -73.3209863 45.0620901, -73.3209865 45.0620451, -73.3210122 45.0619641, -73.3210249 45.0619191, -73.321025 45.0618741, -73.3210507 45.0617931, -73.3210509 45.0617482, -73.3210638 45.0617032, -73.3210765 45.0616583, -73.321102 45.0616223, -73.3211658 45.0615414, -73.321204 45.0615145, -73.3212422 45.0614695, -73.321255 45.0614335, -73.3212805 45.0613976, -73.3212934 45.0613616, -73.3213443 45.0612807, -73.3213825 45.0612537, -73.3214334 45.0612358, -73.3214842 45.0612269, -73.3215477 45.061227, -73.3218143 45.0612274, -73.3219541 45.0612276, -73.3220176 45.0612098, -73.3220431 45.0611468, -73.3220688 45.0610838, -73.3220307 45.0610568, -73.32198 45.0610478, -73.3219038 45.0610476, -73.3218403 45.0610385, -73.3217768 45.0610294, -73.3217007 45.0610292, -73.3216373 45.0610202, -73.3215738 45.0610201, -73.321523 45.061011, -73.3214088 45.0609658, -73.3213456 45.0608848, -73.3213331 45.0608397, -73.3213586 45.0607588, -73.3214735 45.0605609, -73.3214864 45.060516, -73.3214996 45.060363, -73.3215002 45.0601651, -73.3215004 45.0601201, -73.3215513 45.0600391, -73.321577 45.0599582, -73.3215518 45.0599131, -73.321425 45.059868, -73.3213107 45.0598408, -73.3212728 45.0597957, -73.3212732 45.0596968, -73.3213245 45.0594988, -73.3213627 45.0594719, -73.3214264 45.059391, -73.3214266 45.0593371, -73.3214394 45.0593011, -73.3214777 45.0592651, -73.3215919 45.0592472, -73.3216428 45.0592293, -73.3217571 45.0592115, -73.32177 45.0591755, -73.3216813 45.0591125, -73.3214913 45.0589592, -73.3214787 45.0589142, -73.3214661 45.0588691, -73.3214663 45.0588241, -73.321441 45.0587881, -73.3214284 45.058752, -73.3214413 45.0587071, -73.3215557 45.0586532, -73.3215685 45.0586173, -73.3215433 45.0585723, -73.3214929 45.0584552, -73.3214931 45.0584012, -73.3215313 45.0583203, -73.3215442 45.0582753, -73.3215699 45.0581944, -73.3216462 45.0581315, -73.3217987 45.0581047, -73.3219131 45.0580509, -73.3220659 45.0578892, -73.3221041 45.0578532, -73.3220916 45.0578172, -73.3220536 45.0577901, -73.3219901 45.057772, -73.3219266 45.0577719, -73.3218631 45.0577629, -73.3217998 45.0577538, -73.3217236 45.0577536, -73.3216728 45.0577445, -73.3216348 45.0577175, -73.321635 45.0576635, -73.3216351 45.0576185, -73.3216733 45.0575736, -73.3217115 45.0575467, -73.3217751 45.0575198, -73.3218768 45.0574569, -73.3219533 45.0573761, -73.3219661 45.0573401, -73.3220425 45.0572502, -73.3222969 45.0571246, -73.3223859 45.0570707, -73.3224242 45.0570257, -73.3224369 45.0569809, -73.3224244 45.0569358, -73.3223612 45.0568547, -73.3223359 45.0568186, -73.322387 45.0567108, -73.3223365 45.0566117, -73.3222606 45.0565305, -73.3222099 45.0565035, -73.3221719 45.0564675, -73.3220705 45.0564133, -73.3220579 45.0563772, -73.3220581 45.0563323, -73.3221344 45.0562604, -73.3221854 45.0562245, -73.3222109 45.0561796, -73.3222874 45.0561077, -73.3223637 45.0560448, -73.3225545 45.0559101, -73.3226438 45.0558203, -73.3227456 45.0557214, -73.3228477 45.0555416, -73.322734 45.0553704, -73.3226075 45.0551813, -73.322595 45.0551362, -73.322583 45.0549383, -73.3226085 45.0548843, -73.3226087 45.0548213, -73.3226472 45.0547043, -73.32266 45.0546684, -73.3227237 45.0545875, -73.3228636 45.0544887, -73.3229147 45.0544168, -73.322953 45.0543629, -73.3230039 45.054327, -73.3230166 45.054291, -73.3230421 45.054255, -73.3230803 45.0542281, -73.3231058 45.0541921, -73.3231187 45.0541562, -73.3231568 45.0540932, -73.3231449 45.0538682, -73.3231712 45.0535982, -73.3229553 45.0535799, -73.3229937 45.053499, -73.3230827 45.0534452, -73.3231971 45.0534093, -73.3232353 45.0533824, -73.3232481 45.0533464, -73.3232354 45.0533104, -73.3231722 45.0532294, -73.3231724 45.0531844, -73.3232742 45.0531215, -73.3233123 45.0530856, -73.3233378 45.0530496, -73.3233506 45.0530136, -73.3233508 45.0529686, -73.3233255 45.0529326, -73.3232368 45.0528784, -73.3232751 45.0528425, -73.3233385 45.0528336, -73.3235037 45.0527799, -73.3235419 45.0527529, -73.3235929 45.052681, -73.3236184 45.052645, -73.3260042 45.0532248, -73.3292829 45.0540216, -73.331727 45.0546154, -73.3323185 45.0547591, -73.3349478 45.0553978, -73.3349604 45.0554338, -73.3349857 45.0554697, -73.3350236 45.0555058, -73.3350489 45.0555509, -73.3350233 45.0555958, -73.3349851 45.0556318, -73.3348961 45.0556946, -73.3348706 45.0557396, -73.3348578 45.0557846, -73.3348957 45.0558297, -73.3349717 45.0558927, -73.3349842 45.0559377, -73.3349587 45.0560097, -73.334933 45.0560997, -73.3348948 45.0561536, -73.3348184 45.0562254, -73.3347419 45.0563153, -73.3346911 45.0563422, -73.3346403 45.0563602, -73.3345386 45.0563961, -73.3345004 45.056441, -73.3345002 45.0564859, -73.3344746 45.0565759, -73.3344364 45.0566029, -73.3343856 45.0566208, -73.3342839 45.0566566, -73.3341948 45.0567285, -73.3341565 45.0568094, -73.3341563 45.0568544, -73.3341589 45.0568591, -73.3342196 45.0569716, -73.3342321 45.0570165, -73.3342447 45.0570615, -73.3342699 45.0571066, -73.3342824 45.0571786, -73.3342823 45.0572056, -73.3342695 45.0572416, -73.334206 45.0572685, -73.3341425 45.0572684, -73.3340916 45.0572953, -73.3341042 45.0573314, -73.3341549 45.0573584, -73.3342184 45.0573765, -73.3342818 45.0573856, -73.3343453 45.0574037, -73.334396 45.0574128, -73.3344595 45.0574219, -73.3344975 45.0574579, -73.3345227 45.0575029, -73.3345223 45.0576379, -73.3345474 45.0577369, -73.3346359 45.0578811, -73.3346611 45.057935, -73.334737 45.0580342, -73.3347496 45.0580792, -73.3347492 45.0581782, -73.3347236 45.0582771, -73.3347362 45.0583132, -73.3347742 45.0583402, -73.3348629 45.0584033, -73.3349261 45.0584934, -73.3349891 45.0586465, -73.3350145 45.0586915, -73.3350398 45.0587366, -73.3350776 45.0588176, -73.3350774 45.0588716, -73.3350518 45.0589525, -73.335077 45.0590336, -73.3351403 45.0591146, -73.3351909 45.0591597, -73.3352035 45.0591957, -73.3351907 45.0592317, -73.3351905 45.0592857, -73.3352158 45.0593218, -73.3352283 45.0593667, -73.3352536 45.0594118, -73.3352407 45.0595108, -73.3352151 45.0595557, -73.3351642 45.0595917, -73.3351514 45.0596277, -73.3351387 45.0596726, -73.3351132 45.0597086, -73.3350113 45.0597895, -73.334833 45.0599511, -73.3347947 45.0600501, -73.3347946 45.0600951, -73.3347817 45.06014, -73.3347689 45.060185, -73.3347434 45.060221, -73.3346926 45.0602569, -73.3346417 45.0602748, -73.3345655 45.0602747, -73.334464 45.0602565, -73.3343497 45.0602924, -73.3342862 45.0602923, -73.334172 45.0602561, -73.3341212 45.0602471, -73.3340703 45.060265, -73.3340447 45.060346, -73.3340446 45.060391, -73.3340318 45.0604359, -73.3340314 45.0605349, -73.3340059 45.0605708, -73.3339296 45.0606337, -73.3339041 45.0606697, -73.3339421 45.0606968, -73.3340691 45.060697, -73.3341198 45.0607061, -73.3342977 45.0606883, -73.3342972 45.0608323, -73.3346655 45.0608418, -73.3346653 45.0608868, -73.3350716 45.0608964, -73.3351732 45.0608965, -73.3354652 45.060915, -73.3356176 45.0609151, -73.335681 45.0609062, -73.3357572 45.0609064, -73.3359477 45.0609067, -73.3360113 45.0608977, -73.3361636 45.0608979, -73.336227 45.0609071, -73.3363032 45.0609072, -73.3364557 45.0609073, -73.3365064 45.0609164, -73.3365698 45.0609165, -73.3366841 45.0609347, -73.3367476 45.0609348, -73.3367983 45.0609528, -73.3367217 45.0611057, -73.3367089 45.0611417, -73.3366835 45.0611507, -73.336658 45.0611596, -73.3366326 45.0611596, -73.3348806 45.0610941, -73.3347154 45.0611119, -73.334652 45.0611118, -73.3345885 45.0611026, -73.3345251 45.0610935, -73.3344871 45.0610666, -73.334449 45.0610395, -73.334411 45.0610124, -73.334373 45.0609854, -73.334208 45.0609582, -73.3341445 45.0609581, -73.3340809 45.060967, -73.3339667 45.0609848, -73.3339158 45.0610027, -73.333865 45.0610206, -73.333814 45.0610565, -73.3337886 45.0610925, -73.3336738 45.0612543, -73.3336483 45.0613173, -73.3336355 45.0613623, -73.3336099 45.0613983, -73.3335591 45.0614162, -73.3335082 45.0614251, -73.3334701 45.061461, -73.3335081 45.061506, -73.3336729 45.0615963, -73.3337742 45.0616504, -73.3337996 45.0616955, -73.3338122 45.0617405, -73.3338374 45.0617765, -73.33385 45.0618126, -73.3338753 45.0618485, -73.3339381 45.0620557, -73.3339634 45.0621366, -73.3339506 45.0621726, -73.3339502 45.0622806, -73.3339628 45.0623257, -73.3339626 45.0623706, -73.3339499 45.0624156, -73.3339495 45.0625146, -73.3339367 45.0625596, -73.3339111 45.0626046, -73.3338349 45.0626674, -73.3337838 45.0627484, -73.3337582 45.0627933, -73.333593 45.0628651, -73.333339 45.0629007, -73.3331992 45.0629005, -73.3331484 45.0629094, -73.3330975 45.0629274, -73.3330468 45.0629363, -73.3329324 45.0629631, -73.3328942 45.062999, -73.3328813 45.063044, -73.3328939 45.06308, -73.3330588 45.0631432, -73.3331096 45.0631523, -73.3332746 45.0631795, -73.3333254 45.0631976, -73.3333634 45.0632247, -73.3333887 45.0632607, -73.3333885 45.0633057, -73.3333882 45.0633957, -73.3333502 45.0634226, -73.3332993 45.0634316, -73.3332358 45.0634315, -73.3332229 45.0634944, -73.3332482 45.0635305, -73.3333114 45.0636116, -73.3333622 45.0636387, -73.3334129 45.0636567, -73.3335651 45.0637109, -73.3337301 45.0637471, -73.3338824 45.0638014, -73.333933 45.0638105, -73.3339838 45.0638286, -73.3340346 45.0638376, -73.3340726 45.0638646, -73.3340852 45.0639007, -73.3340724 45.0639456, -73.3340469 45.0639816, -73.3340214 45.0640176, -73.3339832 45.0640445, -73.3338688 45.0640623, -73.3337927 45.0640622, -73.333742 45.0640531, -73.3335769 45.0640259, -73.3335262 45.0640078, -73.3333865 45.0639896, -73.333323 45.0639806, -73.3331454 45.0639443, -73.333082 45.0639352, -73.3330311 45.0639531, -73.3330183 45.0639891, -73.3330181 45.0640341, -73.3330688 45.0641152, -73.3330814 45.0641512, -73.3330812 45.0642051, -73.3329282 45.0644029, -73.3328772 45.0644748, -73.3327501 45.0645376, -73.3326864 45.0645735, -73.3326609 45.0646095, -73.33261 45.0646904, -73.3325079 45.0648343, -73.3324444 45.0648612, -73.3323809 45.0648701, -73.3323173 45.064879, -73.3322411 45.0648789, -73.3321268 45.0649057, -73.3320886 45.0649326, -73.3320504 45.0649596, -73.3320376 45.0649955, -73.3320501 45.0650406, -73.3320246 45.0651305, -73.3320244 45.0651756, -73.332037 45.0652206, -73.3320368 45.0652655, -73.3320113 45.0653015, -73.3319604 45.0653374, -73.331935 45.0653734, -73.3318967 45.0654093, -73.331871 45.0654903, -73.3318836 45.0655263, -73.3319342 45.0656073, -73.3320229 45.0656615, -73.3321371 45.0656977, -73.3321879 45.0657067, -73.3322514 45.0657068, -73.3323655 45.065761, -73.3323781 45.065806, -73.3323653 45.065842, -73.3322763 45.0658959, -73.33206 45.0659945, -73.3320219 45.0660215, -73.3319583 45.0660484, -73.3318948 45.0660573, -73.3318313 45.0660571, -73.3317678 45.066048, -73.331552 45.0660388, -73.331387 45.0660115, -73.3313235 45.0660025, -73.3312093 45.0659663, -73.3311585 45.0659572, -73.3310189 45.0659569, -73.3309554 45.0659569, -73.3309045 45.0659838, -73.330879 45.0660198, -73.3308663 45.0660558, -73.3308788 45.0661097, -73.3309168 45.0661458, -73.3310056 45.0661729, -73.331031 45.066182, -73.3311959 45.0662092, -73.3313609 45.0662365, -73.3314244 45.0662545, -73.3315641 45.0662727, -73.3316274 45.0662728, -73.3316782 45.0662819, -73.331729 45.0663, -73.331894 45.0663272, -73.3320083 45.0663454, -73.3321606 45.0663456, -73.3322368 45.0663457, -73.3323003 45.0663548, -73.3323638 45.0663549, -73.3325288 45.0663821, -73.3327065 45.0664094, -73.332808 45.0664276, -73.3328842 45.0664366, -73.332935 45.0664547, -73.3330492 45.0664819, -73.3331127 45.066491, -73.3332267 45.0665271, -73.3332647 45.0665632, -73.3332647 45.0666082, -73.3332392 45.0666442, -73.3331883 45.0666531, -73.3330486 45.0666439, -73.3329851 45.0666438, -73.3329217 45.0666347, -73.3327185 45.0666344, -73.332655 45.0666253, -73.3325026 45.0666251, -73.3321852 45.0666156, -73.3321217 45.0666066, -73.3320582 45.0665975, -73.3319569 45.0665613, -73.3318299 45.0665431, -73.3317792 45.0665251, -73.3316649 45.0665069, -73.3316014 45.0664888, -73.331538 45.0664796, -73.3314745 45.0664616, -73.3313476 45.0664614, -73.3312968 45.0664703, -73.3312459 45.0664882, -73.3312203 45.0665332, -73.3312203 45.0665512, -73.3310804 45.0665708, -73.3309404 45.0665904, -73.3307821 45.0666126, -73.3305851 45.0666402, -73.3305343 45.0666312, -73.3304834 45.0666491, -73.3304327 45.0666581, -73.3303436 45.0667119, -73.3303054 45.0667389, -73.3302038 45.0667747, -73.3301656 45.0668016, -73.3300765 45.0668555, -73.3300509 45.0669005, -73.3300255 45.0669454, -73.3300251 45.0670534, -73.330025 45.0671074, -73.3299867 45.0671883, -73.3299739 45.0672243, -73.3299737 45.0672693, -73.3299863 45.0673143, -73.3299988 45.0673593, -73.3299731 45.0674403, -73.329935 45.0674762, -73.3299222 45.0675212, -73.329833 45.0675841, -73.3298076 45.067629, -73.3298073 45.067728, -73.3296671 45.0678898, -73.3296035 45.0679077, -73.3295147 45.0678806, -73.3294893 45.0678715, -73.3294259 45.0678624, -73.3291973 45.067871, -73.3290955 45.0679069, -73.3290573 45.0679338, -73.3290193 45.0679608, -73.3289174 45.0680237, -73.3288792 45.0680685, -73.3288665 45.0681045, -73.3288409 45.0681405, -73.3288279 45.0682395, -73.3287897 45.0682664, -73.3287261 45.0682843, -73.3286244 45.0683472, -73.3285608 45.0683651, -73.3284973 45.0683649, -73.3284465 45.0683739, -73.3283196 45.0683737, -73.3282179 45.0683916, -73.328167 45.0684095, -73.3280654 45.0684273, -73.3280146 45.0684452, -73.3279636 45.0684811, -73.3279254 45.0685081, -73.3277982 45.0686069, -73.3276963 45.0687237, -73.327658 45.0687597, -73.3275562 45.0688225, -73.3274546 45.0688583, -73.3274164 45.0688853, -73.3273019 45.0689391, -73.3272511 45.068957, -73.3272002 45.0689839, -73.3270728 45.0690917, -73.3269711 45.0691456, -73.3268184 45.0692533, -73.3265893 45.0694149, -73.3265511 45.0694419, -73.3265129 45.0694688, -73.3263601 45.0696126, -73.3262582 45.0697384, -73.3262199 45.0697834, -73.3260927 45.0698372, -73.3259272 45.0699809, -73.3259017 45.0700169, -73.3258253 45.0700798, -73.3257998 45.0701157, -73.3257869 45.0701517, -73.3257995 45.0701877, -73.3257741 45.0702327, -73.3256974 45.0703675, -73.325672 45.0703945, -73.32557 45.0705113, -73.325519 45.0705832, -73.3254808 45.0706192, -73.3254679 45.0706642, -73.3254424 45.0707001, -73.3254168 45.0707901, -73.3254167 45.070835, -73.3254292 45.0708801, -73.3254672 45.0709071, -73.325518 45.0709252, -73.3255688 45.0709343, -73.3256703 45.0709164, -73.325772 45.0708986, -73.3258229 45.0708807, -73.3258864 45.0708808, -73.3259373 45.0708629, -73.3259881 45.0708359, -73.3260263 45.070791, -73.3260771 45.0708001, -73.3261786 45.0708542, -73.326407 45.0709356, -73.3264703 45.0709356, -73.3265846 45.0709538, -73.3266226 45.0709809, -73.3266986 45.071044, -73.3267239 45.07108, -73.3267619 45.0711071, -73.3268 45.0711342, -73.3268125 45.0711792, -73.3267742 45.0712781, -73.326736 45.071305, -73.3267104 45.071341, -73.3266849 45.0714219, -73.3266972 45.071521, -73.3267225 45.0715659, -73.326735 45.071611, -73.3267221 45.071728, -73.326696 45.0719169, -73.326721 45.072061, -73.3267336 45.072097, -73.3267716 45.072142, -73.3267841 45.072187, -73.3267838 45.072313, -73.3267704 45.072511, -73.3267066 45.0726279, -73.3267065 45.0726729, -73.3267317 45.0727088, -73.3267316 45.0727539, -73.3266679 45.0728438, -73.326655 45.0728798, -73.3266547 45.0729878, -73.3266164 45.0730686, -73.3266162 45.0731136, -73.3265778 45.0731946, -73.3265392 45.0733925, -73.3265386 45.0735815, -73.3265258 45.0736265, -73.3265129 45.0736714, -73.3265253 45.0737705, -73.3265125 45.0738334 ), ( -73.3276807 45.0649003, -73.3277458 45.0648902, -73.3277967 45.0648722, -73.3278475 45.0648633, -73.3278983 45.0648454, -73.3279493 45.0648005, -73.3279239 45.0647735, -73.3278732 45.0647554, -73.3278606 45.0647193, -73.3278226 45.0646923, -73.3277718 45.0646833, -73.3276196 45.064665, -73.3275816 45.0646379, -73.3275562 45.064602, -73.3275817 45.064566, -73.3276199 45.0645301, -73.3277217 45.0644762, -73.3278233 45.0644404, -73.3278742 45.0644314, -73.3279251 45.0644045, -73.3279633 45.0643595, -73.328027 45.0642697, -73.3281544 45.0641799, -73.3281924 45.064153, -73.3282306 45.064126, -73.3283197 45.0640722, -73.3284217 45.0639283, -73.3284602 45.0637754, -73.3284858 45.0637394, -73.3284986 45.0636944, -73.3286134 45.0635327, -73.3286517 45.0634517, -73.32869 45.0634158, -73.3287409 45.0633438, -73.3287411 45.0632988, -73.3287667 45.0632179, -73.3287727 45.0631516, -73.3287798 45.0630739, -73.3287927 45.0630289, -73.3288055 45.062984, -73.3288311 45.062903, -73.3288693 45.062858, -73.3289585 45.0627952, -73.328984 45.0627592, -73.3290348 45.0627143, -73.3290605 45.0626334, -73.3291116 45.0625615, -73.3291497 45.0625256, -73.3292897 45.0624448, -73.3293405 45.0624269, -73.329404 45.062391, -73.329544 45.0623011, -73.3296713 45.0621934, -73.3297224 45.0621124, -73.3297735 45.0619865, -73.3297736 45.0619415, -73.3297865 45.0619055, -73.3297867 45.0617886, -73.3297616 45.0617075, -73.3297618 45.0616625, -73.3297365 45.0616175, -73.3297245 45.0613925, -73.3297627 45.0613565, -73.3296867 45.0612844, -73.3296614 45.0612754, -73.329636 45.0612664, -73.3295979 45.0612663, -73.3295344 45.0612662, -73.3294836 45.0612571, -73.3293567 45.061212, -73.3292553 45.0611938, -73.3290522 45.0611665, -73.3289887 45.0611664, -73.3289379 45.0611574, -73.328849 45.0611572, -73.3287983 45.0611751, -73.3287347 45.061184, -73.3286712 45.0611839, -73.3286077 45.0611749, -73.3285443 45.0611568, -73.3284935 45.0611567, -73.3284681 45.0611386, -73.3284428 45.0611206, -73.3283795 45.0610485, -73.3283796 45.0610306, -73.3283797 45.0610125, -73.3283798 45.0609855, -73.3284054 45.0609046, -73.3284182 45.0608596, -73.3284438 45.0607786, -73.3284694 45.0607426, -73.328533 45.0606617, -73.3285459 45.0606258, -73.3285589 45.0605269, -73.3285464 45.0604818, -73.3285211 45.0604368, -73.3285084 45.0603917, -73.3285086 45.0603467, -73.3284835 45.0602658, -73.3284582 45.0602297, -73.3284456 45.0601847, -73.3284077 45.0601486, -73.3283824 45.0601126, -73.3283064 45.0600405, -73.3281672 45.0599053, -73.3281545 45.0598873, -73.3281419 45.0598693, -73.3281292 45.0598332, -73.3281293 45.0598062, -73.3281421 45.0597793, -73.3282059 45.0596893, -73.3282442 45.0596085, -73.3282315 45.0595815, -73.3282062 45.0595724, -73.328168 45.0595814, -73.3280918 45.0596172, -73.3280664 45.0596352, -73.3280409 45.0596621, -73.3279899 45.0597161, -73.3279136 45.0597789, -73.3278627 45.0597969, -73.3278119 45.0598058, -73.327761 45.0598237, -73.3276975 45.0598236, -73.32752 45.0597874, -73.3273931 45.0597511, -73.3273424 45.059724, -73.3271775 45.0596608, -73.3270428 45.0595589, -73.3269748 45.0595075, -73.3268862 45.0594175, -73.3267595 45.0593362, -73.3266581 45.0592641, -73.3265947 45.059237, -73.3264933 45.0591648, -73.3262907 45.0590025, -73.3260627 45.0588223, -73.3259614 45.0587411, -73.3258727 45.058651, -73.325822 45.0586059, -73.3255812 45.0584525, -73.3253784 45.0583802, -73.325315 45.0583621, -73.3252008 45.0583259, -73.325074 45.0582718, -73.3250233 45.0582357, -73.3249347 45.0581456, -73.3248715 45.0580555, -73.3247831 45.0578664, -73.3247203 45.0576773, -73.3246573 45.0574882, -73.3246072 45.0572901, -73.3245694 45.0571641, -73.3245315 45.0571101, -73.3244556 45.0570379, -73.3243541 45.0570018, -73.3242906 45.0569927, -73.3242144 45.0569926, -73.3241637 45.0570015, -73.3240746 45.0570553, -73.3240364 45.0570913, -73.3239474 45.0571451, -73.3239219 45.0571901, -73.3237816 45.0573879, -73.323705 45.0574958, -73.3236795 45.0575677, -73.3236793 45.0576216, -73.3236918 45.0576667, -73.3237169 45.0577657, -73.3237546 45.0579097, -73.3237545 45.0579548, -73.323767 45.0579998, -73.3237795 45.0580448, -73.3238555 45.0581169, -73.3239441 45.058189, -73.323982 45.0582701, -73.3239565 45.058315, -73.3239183 45.0583509, -73.3239055 45.0583869, -73.3239433 45.058468, -73.3239558 45.058513, -73.3239556 45.058621, -73.3239679 45.05872, -73.3239932 45.0587651, -73.3240057 45.0588191, -73.3239927 45.058927, -73.3239799 45.058963, -73.3239413 45.059152, -73.3238771 45.0593678, -73.3238003 45.0595747, -73.3237107 45.0597635, -73.3236721 45.0599435, -73.3236207 45.0601503, -73.3235439 45.0603662, -73.3235055 45.0604562, -73.3234673 45.0605191, -73.3234544 45.060564, -73.3234415 45.060609, -73.3234414 45.060654, -73.3234158 45.060699, -73.3233904 45.0607439, -73.3233648 45.0607889, -73.323352 45.0608339, -73.3233264 45.0608788, -73.3233008 45.0609238, -73.3232754 45.0609688, -73.3231863 45.0610316, -73.3231354 45.0610495, -73.3230338 45.0610854, -73.3229192 45.0611752, -73.3230204 45.0613103, -73.3230711 45.0613374, -73.3230964 45.0613734, -73.3231216 45.0614454, -73.3230576 45.0616073, -73.3230447 45.0616523, -73.3230446 45.0617063, -73.3230571 45.0617424, -73.3230569 45.0617963, -73.3231075 45.0618774, -73.3231455 45.0619045, -73.3232469 45.0619406, -73.3233611 45.0619858, -73.3233864 45.0620218, -73.3234115 45.0621028, -73.3234369 45.0621478, -73.3234494 45.0621929, -73.3234743 45.0623459, -73.323461 45.0625529, -73.323435 45.0627598, -73.3233581 45.0629757, -73.323256 45.0631465, -73.3232304 45.0632184, -73.3232045 45.0633984, -73.3231658 45.0635423, -73.3231273 45.0636953, -73.3230889 45.0637762, -73.3230634 45.0638122, -73.3230379 45.063884, -73.322974 45.063974, -73.3229231 45.0640189, -73.3228722 45.0640638, -73.3227956 45.0641717, -73.3227193 45.0642526, -73.3226552 45.0644325, -73.3226424 45.0644774, -73.3225402 45.0646752, -73.3225146 45.0647202, -73.3224764 45.0647471, -73.3224255 45.064765, -73.3223621 45.0647739, -73.3222606 45.0647557, -73.3222223 45.0647917, -73.3222095 45.0648367, -73.3221966 45.0648817, -73.3222473 45.0649088, -73.3223235 45.0649089, -73.322387 45.064927, -73.3223741 45.0649629, -73.322374 45.0650079, -73.3223102 45.0651248, -73.3222208 45.0653047, -73.3221952 45.0653497, -73.3221696 45.0653946, -73.3221568 45.0654395, -73.3220927 45.0656195, -73.3220671 45.0657274, -73.3220159 45.0658263, -73.3219904 45.0658712, -73.3219649 45.0659162, -73.3219521 45.0659612, -73.3219265 45.0659971, -73.3218883 45.0660331, -73.3218373 45.066114, -73.3218117 45.066159, -73.3217606 45.0662489, -73.3216078 45.0663927, -73.321506 45.0664645, -73.3214805 45.0665004, -73.3214677 45.0665363, -73.3214673 45.0666714, -73.3214799 45.0667164, -73.3214797 45.0667704, -73.3214541 45.0668153, -73.3213142 45.0669141, -73.3212759 45.06695, -73.321225 45.066977, -73.3211106 45.0670488, -73.3210723 45.0670938, -73.3209449 45.0672285, -73.3208811 45.0673184, -73.3208683 45.0673633, -73.320868 45.0674534, -73.3208927 45.0676874, -73.320892 45.0679213, -73.3208912 45.0681373, -73.3208905 45.0683623, -73.3208772 45.0685603, -73.3208385 45.0687581, -73.3208126 45.0689201, -73.3208122 45.0690461, -73.3207989 45.0692711, -73.3207981 45.069469, -73.3207977 45.069631, -73.3208226 45.0698111, -73.3208222 45.069919, -73.3208347 45.069964, -73.3208598 45.0700451, -73.3209105 45.0700812, -73.3209614 45.0700722, -73.3210505 45.0700183, -73.3210633 45.0699824, -73.3210887 45.0699465, -73.3211144 45.0698655, -73.32114 45.0698206, -73.3211529 45.0697666, -73.3211785 45.0696676, -73.3212041 45.0696226, -73.3212423 45.0695867, -73.3212678 45.0695418, -73.3213445 45.0694069, -73.3213574 45.0693619, -73.3213828 45.069317, -73.3214085 45.069218, -73.3214597 45.0690922, -73.3214726 45.0690472, -73.3215364 45.0689573, -73.3215748 45.0688493, -73.3215753 45.0686964, -73.321588 45.0686514, -73.3216009 45.0686064, -73.3216138 45.0685614, -73.3216139 45.0685164, -73.3216273 45.0683005, -73.3216279 45.0680845, -73.3216284 45.0679495, -73.3216413 45.0679045, -73.3216415 45.0678056, -73.3216544 45.0677606, -73.3216926 45.0677246, -73.3217181 45.0676887, -73.3217562 45.0676617, -73.3218073 45.0675898, -73.3218455 45.0675539, -73.321871 45.0675179, -73.32196 45.0674641, -73.3220874 45.0673563, -73.3221766 45.0672664, -73.3222021 45.0672214, -73.3222785 45.0671496, -73.3223933 45.0669788, -73.3224698 45.0668889, -73.3225207 45.066862, -73.3225589 45.0668171, -73.3225717 45.0667811, -73.32261 45.0667362, -73.3228137 45.0665745, -73.3228519 45.0665475, -73.3229918 45.0664578, -73.3230427 45.0664399, -73.3230809 45.0664129, -73.3231317 45.066395, -73.3231825 45.0663681, -73.323259 45.0662872, -73.3233863 45.0661884, -73.323577 45.0660897, -73.323717 45.0660179, -73.3237678 45.066009, -73.3239074 45.0659598, -73.3239203 45.0659552, -73.3240729 45.0658745, -73.3243398 45.0658479, -73.3245684 45.0658303, -73.3246319 45.0658214, -73.3249239 45.0658398, -73.3249873 45.0658489, -73.3250636 45.065849, -73.3251144 45.0658401, -73.3253939 45.0657955, -73.3255336 45.0657778, -73.3255844 45.0657599, -73.3256735 45.065706, -73.3256737 45.065661, -73.325623 45.0656339, -73.3256358 45.0655979, -73.3257374 45.0655621, -73.3257883 45.0655532, -73.3258897 45.0655893, -73.3259533 45.0655894, -73.3260042 45.0655625, -73.3260549 45.0655535, -73.3261564 45.0655717, -73.3261946 45.0655448, -73.3261694 45.0655087, -73.3261313 45.0654817, -73.3261442 45.0654367, -73.3262204 45.0654368, -73.3262838 45.0654279, -73.3263346 45.065437, -73.3264361 45.0654731, -73.3265248 45.0655363, -73.3265756 45.0655544, -73.3266264 45.0655454, -73.3266646 45.0655185, -73.3267537 45.0654376, -73.3267792 45.0654017, -73.3268556 45.0653388, -73.3270339 45.0651771, -73.3271102 45.0651052, -73.3271611 45.0650783, -73.327212 45.0650604, -73.3272502 45.0650334, -73.3273137 45.0650155, -73.3273645 45.0649976, -73.3274789 45.0649708, -73.3275298 45.0649439, -73.3276314 45.064908, -73.3276807 45.0649003 ))";
		
		String w1 = "POLYGON ((-73.3224585 45.0828623,-73.3223943 45.0830422,-73.3223301 45.083258,-73.3222406 45.0834559,-73.3222403 45.0835729,-73.3222779 45.083726,-73.3222777 45.0838159,-73.3222774 45.0838879,-73.3222643 45.0840138,-73.3222002 45.0841938,-73.3220979 45.0844096,-73.3220596 45.0845085,-73.3220593 45.0845985,-73.3220719 45.0846346,-73.3220458 45.0848415,-73.3219943 45.0850754,-73.3219685 45.0851833,-73.3219303 45.0852463,-73.3218791 45.0853541,-73.3218789 45.0854081,-73.3218659 45.0855252,-73.321853 45.0855611,-73.3218403 45.085579,-73.3216619 45.0857317,-73.32156 45.0858396,-73.3214835 45.0859475,-73.3214579 45.0859924,-73.3214197 45.0860284,-73.3213941 45.0860644,-73.3212669 45.0861541,-73.321216 45.0861721,-73.3211016 45.0862079,-73.3210761 45.0862258,-73.3209997 45.0862707,-73.3208723 45.0863875,-73.3207196 45.0864862,-73.3206432 45.0865491,-73.3206049 45.0865761,-73.3205542 45.086594,-73.3204523 45.0866568,-73.3204014 45.0866747,-73.3203505 45.0867016,-73.3202997 45.0867105,-73.3202488 45.0867285,-73.3202107 45.0867374,-73.3201471 45.0867553,-73.3200454 45.0867911,-73.3182907 45.0858056,-73.3164941 45.0847966,-73.314906 45.0839045,-73.3145703 45.0837159,-73.312767 45.0827029,-73.3127925 45.0826669,-73.3127927 45.0826129,-73.3127676 45.0825408,-73.3127423 45.0825048,-73.3127298 45.0824598,-73.3127298 45.0824058,-73.3127684 45.0822979,-73.3128707 45.0820911,-73.3129597 45.0820373,-73.3129852 45.0820013,-73.3129854 45.0819563,-73.3129982 45.0819203,-73.3130619 45.0818934,-73.3131253 45.0818935,-73.3131761 45.0818846,-73.3132653 45.0818218,-73.3133037 45.0817138,-73.3133419 45.0816869,-73.3133802 45.08166,-73.3133677 45.0815609,-73.3133551 45.0815249,-73.3133553 45.08148,-73.3133937 45.081399,-73.3135086 45.0812102,-73.3135595 45.0811923,-73.3136103 45.0811654,-73.3136739 45.0811655,-73.313839 45.0811927,-73.3139152 45.0811838,-73.3139533 45.0811569,-73.3139789 45.081121,-73.3140046 45.0810401,-73.3140048 45.0809411,-73.3139922 45.080905,-73.3140178 45.0808601,-73.314107 45.0807972,-73.3141451 45.0807703,-73.3141833 45.0807343,-73.314298 45.0806535,-73.3143361 45.0806176,-73.3143617 45.0805816,-73.3143237 45.0805456,-73.3142985 45.0805006,-73.314324 45.0804646,-73.3143368 45.0804286,-73.3143877 45.0803837,-73.3145278 45.080294,-73.3146301 45.0800961,-73.3147321 45.0799433,-73.3147959 45.0798444,-73.3148088 45.0798085,-73.3148343 45.0797725,-73.3149621 45.0795478,-73.3150769 45.0793859,-73.3152173 45.0791882,-73.3152938 45.0790714,-73.3153067 45.0790264,-73.3153069 45.0789724,-73.3152182 45.0789002,-73.3151674 45.0788822,-73.315015 45.0788639,-73.3147103 45.0788364,-73.3146468 45.0788273,-73.3145833 45.0788272,-73.3145198 45.0788181,-73.3144563 45.078818,-73.3144056 45.0787819,-73.3143931 45.0787279,-73.314444 45.07871,-73.314609 45.0787103,-73.3148758 45.0787197,-73.3150154 45.0787289,-73.315079 45.07872,-73.3151682 45.0786481,-73.3151936 45.0786033,-73.3152577 45.0784503,-73.3153472 45.0782615,-73.315411 45.0781626,-73.3154238 45.0781267,-73.3154494 45.0780907,-73.3154877 45.0779917,-73.3155263 45.0778838,-73.3155265 45.0778299,-73.3155139 45.0777848,-73.315514 45.0777308,-73.3155523 45.0776859,-73.3155905 45.0776589,-73.3156414 45.077641,-73.3157811 45.0776233,-73.3159083 45.0775784,-73.3160101 45.0775066,-73.3160357 45.0774617,-73.316036 45.0773717,-73.3160743 45.0772908,-73.3160745 45.0772367,-73.3159985 45.0771557,-73.3159863 45.0770296,-73.315999 45.0769936,-73.3159869 45.0768407,-73.3159492 45.0766877,-73.3160386 45.0765168,-73.3160771 45.0764088,-73.3161409 45.07631,-73.3161792 45.0762561,-73.3161921 45.0762201,-73.3161924 45.0760941,-73.3162185 45.0759141,-73.3162699 45.0757072,-73.3162702 45.0756353,-73.3162702 45.0755903,-73.3162831 45.0755453,-73.3163342 45.0754643,-73.3163725 45.0754284,-73.3163978 45.0754195,-73.3164996 45.0753656,-73.316614 45.0753118,-73.3166903 45.075312,-73.3168048 45.0752672,-73.316843 45.0752312,-73.316932 45.0751774,-73.3170086 45.0750875,-73.3171616 45.0749077,-73.3172511 45.0747099,-73.3173021 45.074638,-73.3172771 45.074521,-73.3172649 45.07435,-73.3172651 45.074296,-73.3173163 45.074143,-73.317317 45.0739541,-73.3173044 45.073918,-73.3173048 45.0737921,-73.3173307 45.0736211,-73.3173436 45.0735581,-73.3173692 45.0735132,-73.3173821 45.0734683,-73.3173948 45.0734233,-73.3173951 45.0733333,-73.3174337 45.0732163,-73.3174592 45.0731444,-73.3175103 45.0730815,-73.3175612 45.0730366,-73.3175866 45.0730006,-73.3175995 45.0729646,-73.3175108 45.0728925,-73.3174603 45.0728114,-73.3174732 45.0727665,-73.3175241 45.0727395,-73.3176384 45.0727218,-73.3177781 45.0727219,-73.3178035 45.072713,-73.3178544 45.0727041,-73.3178798 45.0726591,-73.317918 45.0726322,-73.3196588 45.0731819,-73.3203353 45.0733956,-73.3218652 45.0738787,-73.3231938 45.0742982,-73.3242534 45.0746328,-73.3258227 45.0751283,-73.325797 45.0752002,-73.3257715 45.0752362,-73.3257715 45.0752811,-73.3257586 45.0753261,-73.3257584 45.0753801,-73.3257327 45.0754611,-73.3257073 45.0755061,-73.3256562 45.075587,-73.3255797 45.0756589,-73.3255924 45.0757038,-73.3256176 45.0757489,-73.3256175 45.0757939,-73.3256046 45.0758299,-73.3256043 45.0759289,-73.3255916 45.0759648,-73.3255914 45.0760098,-73.325604 45.0760548,-73.3256165 45.0760999,-73.325616 45.0762438,-73.3256033 45.0762798,-73.3255651 45.0763067,-73.3254381 45.0763066,-73.3253745 45.0763155,-73.3253237 45.0763334,-73.3253236 45.0763784,-73.3253741 45.0764504,-73.3253993 45.0765315,-73.3253989 45.0766304,-73.3253987 45.0767384,-73.3253858 45.0767744,-73.3253857 45.0768284,-73.3253601 45.0769094,-73.3253597 45.0770174,-73.3253595 45.0770714,-73.3253211 45.0771883,-73.3252827 45.0772692,-73.3251936 45.077323,-73.3251682 45.077359,-73.325206 45.0774401,-73.3252313 45.0774851,-73.3252438 45.0775302,-73.3252437 45.0775751,-73.325218 45.0776741,-73.3251414 45.077782,-73.3250778 45.0778179,-73.3250524 45.0778448,-73.3249757 45.0779707,-73.3249376 45.0780067,-73.3249373 45.0781056,-73.3249369 45.0782046,-73.324924 45.0782496,-73.3248986 45.0782856,-73.3247968 45.0783394,-73.3246696 45.0784292,-73.3246821 45.0784741,-73.3247074 45.0785102,-73.3247581 45.0785373,-73.3248723 45.0785735,-73.324923 45.0786095,-73.3249227 45.0787175,-73.3249604 45.0788255,-73.3249602 45.0789246,-73.3249341 45.0791135,-73.3249085 45.0791944,-73.3248319 45.0793113,-73.3247809 45.0793833,-73.3246917 45.0794551,-73.3246154 45.079518,-73.3245644 45.0795629,-73.3245262 45.0795899,-73.3244627 45.0796168,-73.3243353 45.0797156,-73.3242971 45.0797515,-73.3241954 45.0797873,-73.3241319 45.0797962,-73.3240175 45.079841,-73.323903 45.0798858,-73.3237758 45.0799036,-73.3236615 45.0799305,-73.3236107 45.0799394,-73.3234962 45.0799662,-73.323293 45.0799839,-73.3231023 45.0800376,-73.3230514 45.0800645,-73.3230386 45.0801004,-73.3229748 45.0801903,-73.3229493 45.0802353,-73.3229108 45.0803343,-73.322898 45.0803973,-73.3228722 45.0804962,-73.3228847 45.0805592,-73.3228464 45.0806401,-73.3228079 45.0807571,-73.3228077 45.080811,-73.3227821 45.080892,-73.3227057 45.0809549,-73.3226801 45.0809998,-73.3226164 45.0810897,-73.3225654 45.0811347,-73.3225144 45.0811796,-73.3224636 45.0812065,-73.3224254 45.0812424,-73.3223745 45.0812694,-73.3223362 45.0813053,-73.3222851 45.0814041,-73.322234 45.0815031,-73.3222337 45.0816021,-73.3222209 45.0816471,-73.3222207 45.0816921,-73.3222457 45.0818091,-73.3222711 45.0818631,-73.3222961 45.0819621,-73.3223336 45.0821511,-73.3223458 45.0823312,-73.32232 45.0824571,-73.3223453 45.0825112,-73.3223832 45.0825562,-73.3224337 45.0826643,-73.3224462 45.0827003,-73.3224461 45.0827273,-73.3224585 45.0828623),(-73.3193311 45.0797437,-73.3192676 45.0796626,-73.3192296 45.0796356,-73.3191661 45.0796264,-73.3191278 45.0796624,-73.3191274 45.0797704,-73.3191527 45.0798155,-73.3191907 45.0798425,-73.3191907 45.0798875,-73.3191778 45.0799234,-73.3191775 45.0800135,-73.3191774 45.0800411,-73.3191768 45.0802294,-73.3191637 45.0803913,-73.3191762 45.0804364,-73.3191761 45.0804814,-73.3191632 45.0805174,-73.3191121 45.0805893,-73.3189975 45.0806881,-73.318972 45.0807241,-73.3189338 45.080751,-73.3188574 45.0808229,-73.3188445 45.0808678,-73.3188825 45.0809039,-73.3189333 45.080913,-73.3189841 45.0809311,-73.3190476 45.0809312,-73.3190985 45.0809223,-73.3192001 45.0809044,-73.3192383 45.0808774,-73.3193528 45.0807876,-73.319391 45.0807607,-73.3194549 45.0806799,-73.3194678 45.0806259,-73.3194934 45.0805449,-73.3195316 45.080509,-73.3195571 45.080473,-73.3195954 45.0804371,-73.3196463 45.0803651,-73.319672 45.0802932,-73.3196976 45.0802572,-73.3197994 45.0801675,-73.3198759 45.0800596,-73.3199016 45.0799786,-73.3199527 45.0799067,-73.3200164 45.0798258,-73.3200165 45.0797808,-73.3199785 45.0797538,-73.319915 45.0797446,-73.3198133 45.0798075,-73.3197625 45.0797894,-73.3197118 45.0797623,-73.3195976 45.0797262,-73.3195213 45.079726,-73.3194578 45.0797349,-73.3193943 45.0797528,-73.3193311 45.0797437))";
		String w2 = "POLYGON (( -73.3354503 45.0528157, -73.3354752 45.0529867, -73.335513 45.0530948, -73.3355759 45.0532839, -73.3356262 45.0534729, -73.3356893 45.05359, -73.3357272 45.053653, -73.335841 45.0538602, -73.3358788 45.0539412, -73.3359293 45.0540403, -73.3359291 45.0540943, -73.3359416 45.0541393, -73.3359669 45.0541843, -73.3360175 45.0542834, -73.3361189 45.0543555, -73.3362075 45.0544367, -73.3362201 45.0544727, -73.3361819 45.0545086, -73.3360674 45.0546075, -73.3360163 45.0546883, -73.3359142 45.0548772, -73.3358887 45.0549221, -73.3358757 45.0549851, -73.3358248 45.0550751, -73.3357992 45.055138, -73.3357736 45.055183, -73.3357099 45.0552998, -73.3356334 45.0553897, -73.3355952 45.0554167, -73.3355062 45.0554795, -73.3354044 45.0555334, -73.3353409 45.0555423, -73.3352775 45.0555152, -73.3351507 45.055452, -73.3351127 45.0554159, -73.3351382 45.05538, -73.3351384 45.0553351, -73.3350876 45.055317, -73.3350368 45.0553439, -73.3349732 45.0553618, -73.3349478 45.0553978, -73.3323185 45.0547591, -73.331727 45.0546154, -73.3292829 45.0540216, -73.3260042 45.0532248, -73.3236184 45.052645, -73.3236569 45.0525371, -73.3236824 45.0524562, -73.3236826 45.0524112, -73.3236446 45.0523751, -73.3235811 45.052366, -73.3235303 45.0523749, -73.3234669 45.0523568, -73.3234162 45.0523208, -73.3234164 45.0522668, -73.3234293 45.0522218, -73.3234294 45.0521768, -73.3234169 45.0521318, -73.3234043 45.0520867, -73.3233918 45.0520418, -73.3233795 45.0518888, -73.3233543 45.0518437, -73.3233417 45.0517988, -73.3233292 45.0517537, -73.3233167 45.0517087, -73.323304 45.0516637, -73.3233045 45.0515196, -73.3233174 45.0514747, -73.3233175 45.0514297, -73.3233429 45.0513938, -73.3233687 45.0512948, -73.3235088 45.051133, -73.3235853 45.0510431, -73.323598 45.0509982, -73.3236112 45.0508542, -73.3236241 45.0508093, -73.3236245 45.0506562, -73.3236631 45.0505124, -73.3236887 45.0504314, -73.3237015 45.0503864, -73.3237017 45.0503234, -73.3237402 45.0501704, -73.3237404 45.0501165, -73.3237662 45.0499635, -73.3237791 45.0499096, -73.3237541 45.0498016, -73.3237289 45.0497565, -73.3237036 45.0497115, -73.3236783 45.0496664, -73.3235646 45.0494863, -73.3234891 45.0492972, -73.3234892 45.0492342, -73.3234514 45.0491531, -73.3234134 45.049117, -73.323312 45.0490629, -73.3232741 45.0490269, -73.3232869 45.0489819, -73.3233251 45.0489459, -73.3234395 45.0489011, -73.3235411 45.0488833, -73.3237062 45.0488296, -73.3237699 45.0487937, -73.3238718 45.0487039, -73.3238845 45.0486679, -73.3238213 45.0485868, -73.3237833 45.0485507, -73.323758 45.0485146, -73.3237964 45.0484338, -73.3238599 45.0484248, -73.3239234 45.0484339, -73.3239741 45.048425, -73.3240123 45.0483891, -73.3240126 45.04829, -73.3239874 45.0482451, -73.3239876 45.0482001, -73.3240256 45.0481731, -73.3240512 45.0481282, -73.324064 45.0480832, -73.3240515 45.0480472, -73.3240262 45.0480111, -73.3239375 45.047957, -73.3238741 45.0479299, -73.3238361 45.0479028, -73.3237981 45.0478758, -73.3236842 45.0477586, -73.323659 45.0477226, -73.3236337 45.0476415, -73.323558 45.0475155, -73.3235455 45.0474704, -73.3235585 45.0473714, -73.3235712 45.0473265, -73.3235841 45.0472815, -73.3236096 45.0472456, -73.3236605 45.0472096, -73.3237114 45.0471917, -73.3238636 45.047192, -73.3239398 45.0471831, -73.3239782 45.0471021, -73.3239911 45.0470572, -73.3239911 45.0470032, -73.324004 45.0469582, -73.3240045 45.0468232, -73.324005 45.0466342, -73.3240183 45.0464453, -73.3240693 45.0463644, -73.324171 45.0463105, -73.3242983 45.0462027, -73.3243365 45.0461668, -73.3244 45.0461399, -73.3244638 45.046059, -73.3244893 45.046014, -73.3244768 45.045969, -73.3244642 45.045924, -73.3244896 45.045888, -73.3245869 45.0457793, -73.3246533 45.045705, -73.3247117 45.0456347, -73.32477 45.0455645, -73.3248334 45.0455466, -73.3249225 45.0454927, -73.3251389 45.0452951, -73.3251771 45.0452681, -73.3252026 45.0452232, -73.3253044 45.0451423, -73.3253426 45.0451064, -73.3253681 45.0450704, -73.3253808 45.0450255, -73.3254318 45.0449896, -73.3254826 45.0449716, -73.3255335 45.0449447, -73.3255717 45.0449088, -73.32561 45.0448279, -73.3256482 45.044783, -73.3256867 45.044666, -73.3256618 45.0444769, -73.3256366 45.044441, -73.3256369 45.044351, -73.3255862 45.0443239, -73.3255354 45.0443148, -73.3254341 45.0442337, -73.3253961 45.0442066, -73.3253962 45.0441616, -73.325409 45.0441256, -73.3254345 45.0440897, -73.3255236 45.0440178, -73.3255617 45.0439909, -73.3256127 45.0439189, -73.3256514 45.0437121, -73.3256643 45.0436671, -73.3256771 45.0436221, -73.3256773 45.0435771, -73.3256901 45.0435411, -73.3256903 45.0434421, -73.3257032 45.0434061, -73.3257033 45.0433612, -73.3256782 45.0432801, -73.325653 45.0431991, -73.3256277 45.043163, -73.3256152 45.043118, -73.3255899 45.043082, -73.3255773 45.043046, -73.325514 45.0429919, -73.3254634 45.0429468, -73.3254508 45.0429018, -73.3253878 45.0427487, -73.3253625 45.0427037, -73.32535 45.0426586, -73.3253375 45.0426137, -73.325249 45.0424875, -73.3251226 45.0423074, -73.3250721 45.0422083, -73.3250219 45.0420462, -73.3250222 45.0419292, -73.3250102 45.0417132, -73.3250236 45.0414972, -73.3250492 45.0413894, -73.3250748 45.0413444, -73.3250876 45.0412994, -73.3251767 45.0412365, -73.3252148 45.0412006, -73.3252657 45.0411737, -73.3253165 45.0411648, -73.3253673 45.0411469, -73.3254563 45.041084, -73.3255327 45.0410121, -73.3255456 45.0409762, -73.3255711 45.0409402, -73.3256219 45.0409043, -73.32566 45.0408863, -73.3257109 45.0408684, -73.325787 45.0408685, -73.3258505 45.0408596, -73.325914 45.0408597, -73.3260663 45.040842, -73.3290606 45.0419409, -73.3321623 45.0430793, -73.3350887 45.044153, -73.3379094 45.045188, -73.337947 45.045368, -73.3379594 45.045485, -73.337972 45.045503, -73.3379464 45.045575, -73.3379463 45.0456469, -73.3379712 45.045782, -73.337971 45.045908, -73.3380087 45.046007, -73.3380338 45.0461151, -73.3380464 45.0461511, -73.3380461 45.046223, -73.3380334 45.046268, -73.3379949 45.0463849, -73.3378929 45.0465558, -73.3378674 45.0466008, -73.3378292 45.0466367, -73.3377782 45.0467176, -73.33774 45.0467536, -73.3377273 45.0467716, -73.3377145 45.0467896, -73.3376381 45.0469064, -73.3376124 45.0469873, -73.3375994 45.0470773, -73.3375992 45.0471403, -73.3376118 45.0471764, -73.3376117 45.0472483, -73.3376113 45.0473653, -73.3375985 45.0474013, -73.3375476 45.0474732, -73.3374202 45.047599, -73.3373693 45.047662, -73.3372802 45.0477518, -73.3372674 45.0477878, -73.3372418 45.0478238, -73.3372292 45.0478598, -73.3371527 45.0479496, -73.3371145 45.0479765, -73.3370509 45.0480035, -73.3369748 45.0480034, -73.3369114 45.0479943, -73.3367717 45.047994, -73.3367208 45.04803, -73.336746 45.048075, -73.336784 45.0481111, -73.3369995 45.0482464, -73.3371768 45.0483816, -73.3372781 45.0484628, -73.337316 45.0485528, -73.3373156 45.0486878, -73.3373282 45.0487238, -73.3374546 45.048931, -73.3375684 45.0490751, -73.3376697 45.0491743, -73.337733 45.0492193, -73.3377456 45.0492553, -73.3377705 45.0494444, -73.3378083 45.0495434, -73.3378336 45.0495794, -73.3378713 45.0496965, -73.3378711 45.0497414, -73.3378837 45.0497775, -73.3378832 45.0499665, -73.3378829 45.0501014, -73.3378701 45.0501464, -73.3378698 45.0502274, -73.337857 45.0502634, -73.3378061 45.0503083, -73.3377426 45.0503442, -73.3376663 45.0503711, -73.3376788 45.0504341, -73.3377296 45.0504252, -73.3377805 45.0503983, -73.3378314 45.0503804, -73.3378821 45.0503984, -73.3378561 45.0505964, -73.3378302 45.0507853, -73.3378299 45.0508753, -73.3378297 45.0509743, -73.3378166 45.0511002, -73.337791 45.0511542, -73.3377273 45.0512441, -73.3377145 45.0512801, -73.337689 45.0513161, -73.3376506 45.051424, -73.3375997 45.0514779, -73.3375107 45.0515318, -73.3374342 45.0516487, -73.3373832 45.0517026, -73.3373196 45.0517385, -73.3372814 45.0517835, -73.3372686 45.0518374, -73.3372304 45.0518913, -73.3371667 45.0519362, -73.3369504 45.0521069, -73.336874 45.0522238, -73.3366831 45.0523855, -73.3365812 45.0524574, -73.3365049 45.0524932, -73.3364415 45.0525021, -73.3364033 45.0525471, -73.3363651 45.052574, -73.3362379 45.0526638, -73.336149 45.0526907, -73.33606 45.0526996, -73.3358824 45.0526993, -73.33573 45.0526811, -73.3355649 45.0526899, -73.3355013 45.0527168, -73.3354633 45.0527437, -73.3354503 45.0528157 ))";
	
		Polygon polygon = (Polygon)reader.read(waterbody);
		
		List<Polygon> others = new ArrayList<>();
		for (String w : new String[] {w1,w2}) {
			others.add((Polygon)reader.read(w));
		}
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, others, Collections.emptyList());
		pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.3292829, 45.0540216), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3218652, 45.0738787), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3321268, 45.0649057), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3232469, 45.0619406), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3207052, 45.0626476), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		
		//second run
		waterbody = "POLYGON (( -73.2700858 45.4554992,-73.2696859 45.4555921,-73.2696315 45.4556048,-73.2684482 45.4558798,-73.2674751 45.4561059,-73.2676032 45.4560251,-73.2677056 45.4559983,-73.2678852 45.4558277,-73.2679882 45.4556839,-73.2680908 45.4555942,-73.2681038 45.4555492,-73.2679892 45.455414,-73.2680023 45.45536,-73.2680408 45.4553151,-73.2681822 45.4551355,-73.2682336 45.4550815,-73.2682724 45.4549737,-73.2682471 45.4548836,-73.268286 45.4547757,-73.2684018 45.454605,-73.2683636 45.4545599,-73.2682737 45.4546497,-73.2678881 45.4551529,-73.2676571 45.4553413,-73.2672856 45.4555476,-73.2669653 45.4556819,-73.2667984 45.4558255,-73.2667728 45.4558704,-73.2667341 45.4559154,-73.2666953 45.4560232,-73.2667207 45.4560683,-73.2665147 45.4559953,-73.2663122 45.4559235,-73.2665811 45.455825,-73.2667094 45.4557443,-73.266863 45.4556816,-73.2670554 45.455556,-73.2671192 45.4555562,-73.2673113 45.4555026,-73.2673753 45.4554667,-73.2676701 45.4552963,-73.2678755 45.4551078,-73.2680813 45.4548112,-73.2681459 45.4546404,-73.2681345 45.4542895,-73.2680089 45.4537493,-73.2678578 45.4531911,-73.2678709 45.4531101,-73.2678335 45.4528671,-73.2678341 45.4527052,-73.2677835 45.452579,-73.267771 45.452516,-73.2677587 45.45239,-73.2677333 45.452345,-73.2677341 45.452174,-73.2677091 45.45203,-73.2678378 45.4518233,-73.2679017 45.4518234,-73.2679147 45.4517874,-73.2678008 45.4514813,-73.2675335 45.4511837,-73.2673296 45.4510484,-73.2667167 45.4508581,-73.2660657 45.4506049,-73.2658999 45.4505236,-73.2657977 45.4504963,-73.2654277 45.4503156,-73.2648916 45.4500986,-73.2640235 45.4497908,-73.2636538 45.449538,-73.2633097 45.4492944,-73.2632462 45.4491773,-73.2632469 45.4490513,-73.2631319 45.4490061,-73.262966 45.4489517,-73.2628385 45.4488525,-73.2627362 45.4488523,-73.2626469 45.4488341,-73.2623408 45.4486625,-73.2618436 45.4483375,-73.2616649 45.4482471,-73.2612441 45.4479943,-73.2607466 45.4477233,-73.260479 45.4475428,-73.2603388 45.4474525,-73.2601349 45.4472901,-73.2600966 45.447263,-73.2600584 45.447227,-73.2600332 45.4471549,-73.2599823 45.4470918,-73.2597656 45.4469384,-73.2597147 45.4469023,-73.260199 45.4464777,-73.2606834 45.446053,-73.2612363 45.4455842,-73.2617675 45.4451339,-73.2618441 45.445179,-73.2620095 45.4453413,-73.2620344 45.4455214,-73.2620978 45.4456115,-73.2622507 45.4457648,-73.2623783 45.4458191,-73.2625058 45.4458913,-73.2626589 45.4459456,-73.2629904 45.4461622,-73.2634241 45.4463791,-73.2635136 45.4463973,-73.2635518 45.4464064,-73.2636541 45.4464336,-73.2637562 45.4464608,-73.2640113 45.4465963,-73.2646114 45.4467865,-73.264918 45.4468231,-73.2651094 45.4469135,-73.2653263 45.44704,-73.2655555 45.4472293,-73.2656447 45.4473105,-73.2656314 45.4474365,-73.2656698 45.4474456,-73.2657211 45.4473827,-73.2659246 45.4476261,-73.2658987 45.447716,-73.2659494 45.447815,-73.2660894 45.4479503,-73.2661532 45.4479954,-73.266485 45.4481581,-73.266753 45.4482667,-73.2669445 45.4483121,-73.2670721 45.4483663,-73.267187 45.4484205,-73.2674807 45.4484931,-73.2675446 45.4485112,-73.2678766 45.4485839,-73.2680044 45.4486112,-73.2681704 45.4486475,-73.2683238 45.4486658,-73.2685283 45.4486842,-73.2687326 45.4487206,-73.2689754 45.4487481,-73.2692309 45.4487936,-73.2693588 45.4487939,-73.2700103 45.4489302,-73.2703167 45.4490118,-73.270483 45.4489941,-73.2706235 45.4490034,-73.2707766 45.4491027,-73.2709171 45.4491209,-73.2710834 45.4491033,-73.2714541 45.449131,-73.2716587 45.4491225,-73.2721442 45.4491684,-73.2722719 45.4491956,-73.2724125 45.4492049,-73.2728594 45.4493497,-73.2729998 45.449422,-73.2731148 45.4494402,-73.2733323 45.4493957,-73.2735241 45.4493871,-73.2735625 45.4493782,-73.2737416 45.4493515,-73.2739973 45.4493341,-73.2742402 45.4493255,-73.2744831 45.449326,-73.2747516 45.4493175,-73.2749306 45.4493358,-73.2751478 45.4493543,-73.2753012 45.4493726,-73.2753779 45.4493727,-73.275544 45.4494001,-73.275774 45.4494365,-73.2759399 45.4494728,-73.276055 45.4494821,-73.2761569 45.4495722,-73.2762846 45.4496085,-73.2764757 45.4497798,-73.2766035 45.4497981,-73.2767953 45.4497895,-73.2768593 45.4497716,-73.2772683 45.4497994,-73.2773323 45.4497636,-73.2769494 45.4508292,-73.2767814 45.4512967,-73.2764124 45.4523234,-73.2762853 45.452677,-73.2761961 45.4525868,-73.2761708 45.4525328,-73.276133 45.4523888,-73.2760948 45.4523526,-73.276031 45.4523256,-73.2757371 45.452271,-73.2756988 45.4522619,-73.2753794 45.4522163,-73.2752132 45.452225,-73.2750853 45.4522337,-73.2749573 45.4522605,-73.2749316 45.4522874,-73.2749186 45.4523504,-73.2750584 45.4525756,-73.2751221 45.4526117,-73.2753266 45.4526122,-73.2754543 45.4526843,-73.2756074 45.4527387,-73.2756842 45.4527388,-73.2757863 45.452766,-73.2758886 45.4527752,-73.2760676 45.4527485,-73.2762339 45.4527579,-73.2762979 45.452722,-73.2759202 45.4531151,-73.2757436 45.453299,-73.2752452 45.4538177,-73.2752583 45.4537098,-73.2753098 45.4536559,-73.2753227 45.453611,-73.275272 45.4534849,-73.2751955 45.4534577,-73.2751572 45.4534397,-73.275106 45.4534306,-73.2750675 45.4534754,-73.2750416 45.4535654,-73.2748621 45.453691,-73.2748235 45.453736,-73.2748362 45.4537809,-73.2748743 45.453826,-73.2749382 45.4538442,-73.2751683 45.4538626,-73.2743069 45.4540453,-73.273346 45.4542492,-73.2720588 45.4545223,-73.2716591 45.4547398,-73.2713668 45.4548989,-73.2713799 45.454809,-73.271342 45.4547099,-73.271291 45.4546648,-73.2711633 45.4546195,-73.2710995 45.4546104,-73.2710101 45.4546012,-73.2708822 45.4546009,-73.270805 45.4546998,-73.2708302 45.4547898,-73.2708171 45.4548798,-73.2708554 45.4549158,-73.270983 45.4549701,-73.2711108 45.4549883,-73.2713028 45.4549347,-73.2708521 45.4551438,-73.2707256 45.4552025,-73.2700858 45.4554992 ),( -73.2625829 45.4474245,-73.2625505 45.4474302,-73.2624993 45.4474301,-73.262461 45.4474119,-73.2623717 45.4473848,-73.2622316 45.4472585,-73.2621552 45.4471863,-73.2621436 45.4471731,-73.2620915 45.4471142,-73.2619642 45.447006,-73.2618877 45.4469428,-73.2618113 45.4468977,-73.2617345 45.4468885,-73.2617214 45.4468911,-73.261645 45.4469063,-73.261632 45.4469423,-73.2616574 45.4470053,-73.2617338 45.4470595,-73.2617721 45.4470866,-73.2618231 45.4471317,-73.2618994 45.4472038,-73.2619886 45.447285,-73.2620523 45.4473391,-73.2621032 45.4473662,-73.2621924 45.4474563,-73.2622818 45.4474746,-73.2623839 45.4475288,-73.2624729 45.4476189,-73.2625111 45.4476731,-73.2625621 45.4477091,-73.2626387 45.4477093,-73.2626774 45.4476553,-73.2627287 45.4476015,-73.2626395 45.4475293,-73.2626269 45.4474843,-73.2626073 45.4474354,-73.2626016 45.4474212,-73.2625829 45.4474245 ),( -73.2630349 45.447764,-73.2630478 45.4477281,-73.2630097 45.4476831,-73.2629202 45.4476468,-73.2628436 45.4476377,-73.2627797 45.4476466,-73.2627156 45.4476915,-73.262677 45.4477453,-73.2626512 45.4477992,-73.262651 45.4478533,-73.2626892 45.4478893,-73.2627787 45.4478715,-73.2628171 45.4478536,-73.2628429 45.4478176,-73.2629069 45.4477818,-73.262971 45.447764,-73.2630349 45.447764 ),( -73.2631874 45.4479803,-73.2631619 45.4479534,-73.2630471 45.4478721,-73.2629833 45.4478629,-73.2629321 45.4478718,-73.2628937 45.4478897,-73.2628552 45.4479167,-73.2628551 45.4479527,-73.2628932 45.4479887,-73.2629699 45.4480159,-73.2630336 45.4480521,-73.2630591 45.44807,-73.2631104 45.4480522,-73.263136 45.4480163,-73.2631874 45.4479803 ),( -73.2641184 45.4485042,-73.2641186 45.4484683,-73.2641061 45.4483782,-73.2640425 45.4483331,-73.2638506 45.4483237,-73.2637484 45.4483504,-73.2637099 45.4483684,-73.2636716 45.4483413,-73.2636078 45.4483232,-73.2634927 45.4483409,-73.2634159 45.4483677,-73.2634797 45.4483859,-73.2635307 45.448413,-73.2635945 45.4484402,-73.2636329 45.4484402,-73.2637094 45.4484674,-73.2638627 45.4484947,-73.2639904 45.4485399,-73.2640544 45.4485401,-73.2641184 45.4485042 ),( -73.2643423 45.4487705,-73.2643219 45.4487836,-73.2642702 45.4488735,-73.264321 45.4489635,-73.2644486 45.4490538,-73.2647164 45.4491893,-73.264844 45.4492616,-73.2649587 45.4493248,-73.265048 45.4493789,-73.2651372 45.4494331,-73.2654436 45.4495598,-73.2659289 45.4497047,-73.2662862 45.4498404,-73.2667332 45.4499313,-73.2672186 45.4500763,-73.2673717 45.4501396,-73.2677548 45.4502484,-73.2682141 45.4504743,-73.2682651 45.4505014,-73.2685583 45.450727,-73.2687362 45.4509703,-73.2687869 45.4510783,-73.2687994 45.4511683,-73.2685941 45.4513479,-73.2685678 45.4515278,-73.2685928 45.4516449,-73.2685796 45.4517528,-73.2686047 45.4518699,-73.2686557 45.4519149,-73.2687962 45.4519422,-73.2689625 45.4519065,-73.2690127 45.4521496,-73.26905 45.4524016,-73.2690623 45.4525277,-73.2692275 45.452771,-73.2694052 45.4530862,-73.2694816 45.4531404,-73.2697876 45.453384,-73.2699278 45.4534742,-73.270017 45.4535374,-73.2701065 45.4535645,-73.2701958 45.4535918,-73.2703105 45.453709,-73.270425 45.4538262,-73.2705117 45.4539322,-73.270565 45.4539974,-73.2707563 45.4541148,-73.2708198 45.4541959,-73.2708067 45.4542859,-73.2709602 45.4542502,-73.2710878 45.4543494,-73.2713688 45.454395,-73.271522 45.4544493,-73.2716114 45.4544674,-73.2717008 45.4545127,-73.2718029 45.4545579,-73.2720588 45.4545223,-73.2721486 45.4544145,-73.2721496 45.4541896,-73.2721882 45.4541447,-73.2722141 45.4540457,-73.2722271 45.4539828,-73.2720877 45.4536855,-73.2720883 45.4535506,-73.2719231 45.4532803,-73.2719106 45.4532173,-73.2718607 45.4529292,-73.2716702 45.4526048,-73.27153 45.4524696,-73.2714412 45.4522894,-73.271365 45.4521993,-73.2712373 45.4521271,-73.2712505 45.4520371,-73.2713018 45.4519923,-73.2713656 45.4520374,-73.2714296 45.4520105,-73.2714557 45.4518756,-73.2714431 45.4518305,-73.2713668 45.4517314,-73.2713286 45.4516774,-73.271265 45.4516322,-73.2711373 45.451569,-73.2709077 45.4514425,-73.2701925 45.4512431,-73.2698989 45.4511615,-73.2697967 45.4511434,-73.2696689 45.4511251,-73.2693882 45.4509985,-73.2693372 45.4509625,-73.2692735 45.4508903,-73.2692481 45.4508543,-73.2691207 45.450755,-73.2687767 45.4504754,-73.268241 45.4501413,-73.2680753 45.450033,-73.2679986 45.4500149,-73.2678327 45.4499425,-73.2674497 45.4498158,-73.2666323 45.4496342,-73.2665428 45.449598,-73.2663514 45.4495436,-73.2662239 45.4494714,-73.266224 45.4494354,-73.2661858 45.4493903,-73.2659431 45.4493448,-73.2657768 45.4493535,-73.2654832 45.4492449,-73.2647176 45.4488834,-73.2646668 45.4488383,-73.264616 45.4487482,-73.2645523 45.4487031,-73.2644757 45.4486849,-73.2643423 45.4487705 ),( -73.2755138 45.4505609,-73.2754885 45.4504708,-73.2754377 45.4504257,-73.2753099 45.4504074,-73.2752458 45.4504253,-73.2751817 45.4504702,-73.275156 45.4505151,-73.2752069 45.4505603,-73.2753346 45.4506145,-73.2754624 45.4506057,-73.2755138 45.4505609 ),( -73.2750366 45.4515947,-73.275024 45.4515497,-73.2748837 45.4514684,-73.2747305 45.4514231,-73.2746411 45.451414,-73.2742963 45.4512873,-73.2742324 45.4512962,-73.2741813 45.4512781,-73.2740411 45.4511698,-73.2740285 45.4511248,-73.2740926 45.45108,-73.2741056 45.4510349,-73.2738505 45.4508635,-73.2736461 45.4508451,-73.273518 45.4508808,-73.2734543 45.4508447,-73.2734546 45.4507547,-73.2733652 45.4507456,-73.273263 45.4507273,-73.273199 45.4507542,-73.2731604 45.4507992,-73.2730325 45.4507989,-73.2730069 45.4508439,-73.2730192 45.4509338,-73.2730831 45.45097,-73.273313 45.4510064,-73.2734025 45.4510066,-73.2736708 45.4510612,-73.273696 45.4511511,-73.2736575 45.4511961,-73.273504 45.4511957,-73.2733632 45.4512224,-73.2731462 45.4511591,-73.2730825 45.451123,-73.272993 45.4510957,-73.2729163 45.4511136,-73.2728522 45.4511585,-73.272839 45.4512755,-73.2728898 45.4513205,-73.2730432 45.4513388,-73.273222 45.4514112,-73.2734519 45.4514566,-73.2737328 45.4515472,-73.2738987 45.4515925,-73.2739879 45.4516826,-73.2741154 45.4517639,-73.2743199 45.4518003,-73.2744089 45.4518994,-73.2744855 45.4519536,-73.2745492 45.4519897,-73.2746771 45.4519719,-73.2748307 45.4519182,-73.274895 45.4518284,-73.2748445 45.4516843,-73.2749085 45.4516485,-73.2749854 45.4516306,-73.2750366 45.4515947 ),( -73.2682631 45.4509963,-73.2681611 45.4509151,-73.2680845 45.4509059,-73.2680328 45.4510228,-73.2680962 45.4511489,-73.2681221 45.451059,-73.2681864 45.4510141,-73.2682631 45.4509963 ),( -73.2748288 45.4524132,-73.274829 45.4523682,-73.2747783 45.4522691,-73.2747529 45.4522331,-73.2745996 45.4521788,-73.274523 45.4521696,-73.2744335 45.4521515,-73.2743697 45.4521333,-73.2743314 45.4521063,-73.2742422 45.4520611,-73.2741655 45.4520429,-73.2741016 45.4520428,-73.273897 45.4520514,-73.2738328 45.4520873,-73.2738453 45.4521772,-73.2739471 45.4523214,-73.2740235 45.4523846,-73.2742787 45.4524931,-73.2743427 45.4524842,-73.2746623 45.4525028,-73.2747904 45.4524581,-73.2748288 45.4524132 ),( -73.2688454 45.4524283,-73.2688713 45.4523383,-73.2689102 45.4522034,-73.2688724 45.4520773,-73.2687315 45.452113,-73.2686288 45.4522298,-73.2686924 45.45232,-73.2688454 45.4524283 ),( -73.2704214 45.454726,-73.2704215 45.454672,-73.2703968 45.454492,-73.2702059 45.4542487,-73.2701295 45.4541855,-73.2700785 45.4541494,-73.2699642 45.4539602,-73.2699132 45.4539152,-73.2697732 45.4537799,-73.2696202 45.4536716,-73.2693777 45.4535361,-73.2692122 45.4533918,-73.2691612 45.4533467,-73.2690342 45.4531485,-73.2689832 45.4531124,-73.268869 45.4528962,-73.2687422 45.452653,-73.2687042 45.4525629,-73.268551 45.4524996,-73.2684742 45.4524995,-73.2683716 45.4526072,-73.2683586 45.4526522,-73.2683685 45.4533541,-73.2683671 45.4536871,-73.2683279 45.4539119,-73.268417 45.4539931,-73.2684291 45.4541551,-73.2685312 45.4542093,-73.2685436 45.4542993,-73.2686327 45.4543805,-73.2686324 45.4544705,-73.2686961 45.4545156,-73.2687475 45.4544797,-73.2687858 45.4544888,-73.2688623 45.4545339,-73.2689 45.454714,-73.2690275 45.4547952,-73.269168 45.4548224,-73.2693594 45.4548949,-73.2693976 45.4549399,-73.2694096 45.4551469,-73.269435 45.455192,-73.269499 45.4551561,-73.2696279 45.4549134,-73.2696536 45.4548685,-73.2697178 45.4548326,-73.2698456 45.4548148,-73.2703186 45.4548428,-73.270357 45.4548339,-73.2704214 45.454726 ),( -73.2749679 45.4528274,-73.2749681 45.4527374,-73.2748919 45.4526473,-73.2747641 45.4526111,-73.2746363 45.4526198,-73.2745086 45.4525745,-73.2744318 45.4525834,-73.2743549 45.4526282,-73.2743548 45.4526732,-73.2744436 45.4528083,-73.274584 45.4528716,-73.2748395 45.4529261,-73.2749036 45.4529172,-73.2749679 45.4528274 ),( -73.2754915 45.4529634,-73.2755046 45.4528735,-73.2754538 45.4527833,-73.2754284 45.4527473,-73.2753646 45.4527022,-73.2752879 45.4527021,-73.275224 45.4527199,-73.2751599 45.4527647,-73.2751341 45.4528097,-73.2751338 45.4528997,-73.2751719 45.4529448,-73.2753636 45.4529721,-73.2754915 45.4529634 ),( -73.2742363 45.4535189,-73.2742367 45.4534108,-73.274237 45.4533569,-73.2742756 45.453267,-73.2742503 45.4532129,-73.2741993 45.4531678,-73.2740589 45.4531046,-73.2739184 45.4530952,-73.2738543 45.4531221,-73.2737137 45.4530949,-73.2736371 45.4530947,-73.2735731 45.4531216,-73.2735345 45.4531665,-73.2735598 45.4532565,-73.2736233 45.4533466,-73.2738144 45.453491,-73.2738783 45.4535181,-73.2740062 45.4535183,-73.274108 45.4536086,-73.2741721 45.4535997,-73.274185 45.4535547,-73.2742363 45.4535189 ),( -73.2749791 45.4531873,-73.2748899 45.4531242,-73.274775 45.4530969,-73.2747109 45.4531058,-73.2746469 45.4531417,-73.274838 45.453313,-73.274902 45.4533222,-73.2749791 45.4531873 ),( -73.2689117 45.4549659,-73.2688737 45.4548759,-73.2688227 45.4548307,-73.2687588 45.4548486,-73.2686822 45.4548035,-73.2686564 45.4548485,-73.2685922 45.4549473,-73.2685917 45.4550373,-73.2687836 45.4550197,-73.2689117 45.4549659 ),( -73.2699467 45.455121,-73.2699856 45.4549951,-73.2699987 45.4549321,-73.2698837 45.4548689,-73.2696919 45.4548956,-73.2696534 45.4549404,-73.2696528 45.4550934,-73.2696267 45.4551924,-73.2696647 45.4552824,-73.2697924 45.4553187,-73.2698566 45.4552828,-73.2699467 45.455121 ),( -73.2700858 45.4554992,-73.2702398 45.4553646,-73.2703039 45.4553287,-73.2703169 45.4552658,-73.2702414 45.4549686,-73.2701774 45.4549775,-73.2701259 45.4550764,-73.2701128 45.4551664,-73.2700224 45.4553551,-73.2700221 45.4554361,-73.2700858 45.4554992 ),( -73.2692034 45.4555424,-73.2691398 45.4554523,-73.2689741 45.455335,-73.2690382 45.4552902,-73.2690384 45.4552451,-73.2690259 45.4551731,-73.2689112 45.4550829,-73.2687833 45.4551006,-73.268668 45.4551544,-73.2686295 45.4552083,-73.2686289 45.4553253,-73.2685645 45.4554331,-73.2685643 45.4554782,-73.2686281 45.4555233,-73.2689349 45.4555329,-73.2691393 45.4555872,-73.2692034 45.4555424 ))";
		String a1 = "POLYGON (( -73.2700858 45.4554992, -73.2707256 45.4552025, -73.2708521 45.4551438, -73.2713028 45.4549347, -73.2713668 45.4548989, -73.2716591 45.4547398, -73.2720588 45.4545223, -73.273346 45.4542492, -73.2743069 45.4540453, -73.2751683 45.4538626, -73.2752452 45.4538177, -73.2757436 45.453299, -73.2759202 45.4531151, -73.2762979 45.452722, -73.2762853 45.452677, -73.2764124 45.4523234, -73.2767814 45.4512967, -73.2769494 45.4508292, -73.2773323 45.4497636, -73.2773458 45.4495926, -73.2777565 45.4491885, -73.2784743 45.4487219, -73.278769 45.4485335, -73.2789738 45.44848, -73.2790379 45.448426, -73.2790637 45.4483811, -73.2790512 45.4482911, -73.2789621 45.4481919, -73.2790388 45.4481921, -73.2791535 45.4482913, -73.2791789 45.4483364, -73.2792297 45.4483994, -73.2792681 45.4484085, -73.2793064 45.4484356, -73.2794212 45.4484808, -73.2794851 45.4484809, -73.2795883 45.4482741, -73.2796523 45.4482472, -73.2797801 45.4482565, -73.2800613 45.4482571, -73.2801767 45.4481853, -73.2807394 45.4481054, -73.2809313 45.4481058, -73.280982 45.4482138, -73.2810842 45.448223, -73.2814166 45.4482237, -73.2816977 45.4482332, -73.2819536 45.4481977, -73.2826314 45.448127, -73.2826193 45.4479291, -73.2826577 45.4479291, -73.2827216 45.4479202, -73.2827718 45.4481723, -73.2832706 45.4481463, -73.2833725 45.4482364, -73.2837909 45.449119, -73.2838528 45.4496591, -73.2839551 45.4496503, -73.2838805 45.4490832, -73.2834748 45.4482276, -73.2835132 45.4482187, -73.2835644 45.4481918, -73.2836267 45.4481821, -73.2836795 45.448174, -73.2837818 45.4481741, -73.2839226 45.4481115, -73.2846386 45.4481128, -73.2846898 45.4481129, -73.2846243 45.4484997, -73.2846881 45.4485178, -73.2847522 45.448509, -73.2847917 45.4481851, -73.284856 45.4480952, -73.2856353 45.4482137, -73.2856992 45.4482408, -73.285763 45.4482589, -73.2859801 45.4483223, -73.2861208 45.4483226, -73.2862484 45.4483498, -73.2863763 45.4483501, -73.2865043 45.4483233, -73.2865682 45.4483324, -73.2866958 45.4483866, -73.2869512 45.4484771, -73.2870533 45.4485132, -73.2872959 45.4485858, -73.2875515 45.4486222, -73.2876792 45.4486584, -73.2881517 45.4487672, -73.2883179 45.4487856, -73.2888544 45.4489215, -73.2889181 45.4489487, -73.2891864 45.4490122, -73.2893139 45.4490843, -73.2893393 45.4491294, -73.2895436 45.4492288, -73.2896713 45.449265, -73.2897989 45.4493282, -73.2898626 45.4493733, -73.2899516 45.4495085, -73.2901172 45.4496797, -73.2902063 45.4497699, -73.2903205 45.450004, -73.2903331 45.4500491, -73.2904733 45.4501843, -73.2904981 45.4503823, -73.2905742 45.4505265, -73.2905353 45.4506884, -73.2905479 45.4507514, -73.2905476 45.4508143, -73.2905984 45.4509225, -73.2905981 45.4509854, -73.2906235 45.4510395, -73.290559 45.4511833, -73.2906225 45.4513364, -73.290596 45.4515613, -73.2906204 45.4518853, -73.2907215 45.4522184, -73.290874 45.4524707, -73.2910906 45.452678, -73.2912048 45.4528672, -73.2912041 45.4530562, -73.2913313 45.4532454, -73.2913436 45.4533624, -73.2913175 45.4535243, -73.2914064 45.4536684, -73.2914317 45.4537855, -73.291342 45.4538124, -73.2913538 45.4540553, -73.2913912 45.4543344, -73.2914289 45.4545324, -73.2915696 45.4545236, -73.2915937 45.4549016, -73.291606 45.4550546, -73.2916181 45.4552436, -73.2916178 45.4553065, -73.2916661 45.4560715, -73.2915712 45.4575471, -73.2915707 45.4576731, -73.291519 45.457826, -73.2915186 45.4579339, -73.2914927 45.4580149, -73.2915051 45.4581409, -73.2914789 45.4582938, -73.2914273 45.4584197, -73.2913885 45.4585546, -73.2914261 45.4587706, -73.2914116 45.4592206, -73.2913458 45.4597333, -73.2912542 45.4602821, -73.291253 45.460615, -73.2913033 45.4608311, -73.2913031 45.4608851, -73.291239 45.460921, -73.2912126 45.4611369, -73.2913398 45.4613441, -73.2913782 45.4613351, -73.2913394 45.461461, -73.2912752 45.4615419, -73.29084 45.46164, -73.2905586 45.4616666, -73.2904305 45.4617384, -73.2901227 45.4619628, -73.2899687 45.4621334, -73.2899044 45.4622323, -73.2897889 45.462313, -73.2897372 45.4625019, -73.285602 45.4607047, -73.2815044 45.4589237, -73.2805738 45.4585191, -73.2786139 45.4579548, -73.2747484 45.4568419, -73.2737336 45.4565497, -73.2712938 45.4558471, -73.2709361 45.4557441, -73.2700858 45.4554992 ))";
		String a2 = "POLYGON (( -73.2618786 45.4612504, -73.2619569 45.4611275, -73.2620332 45.4610078, -73.2622119 45.4610531, -73.2623783 45.4610445, -73.2624679 45.4610087, -73.2625834 45.46091, -73.2626602 45.4608831, -73.2627371 45.4608743, -73.2629029 45.4609466, -73.2629924 45.4609558, -73.2630693 45.46092, -73.2631207 45.4608661, -73.2631354 45.4606924, -73.263161 45.4603893, -73.2631228 45.4603352, -73.2629569 45.4602628, -73.2629187 45.4602088, -73.2628679 45.4601637, -73.2627528 45.4601544, -73.262625 45.4601452, -73.2622804 45.4599825, -73.2622057 45.4597251, -73.2621418 45.4595053, -73.2622187 45.4594604, -73.2624242 45.4592269, -73.2624374 45.459155, -73.2625402 45.4590112, -73.2625281 45.4588492, -73.2625666 45.4587953, -73.2627081 45.4586156, -73.2626955 45.4585706, -73.262978 45.4582742, -73.263145 45.4581036, -73.263325 45.45787, -73.2634148 45.4578072, -73.2635561 45.4576545, -73.2638126 45.4574481, -73.2638768 45.4573763, -73.2640181 45.4572325, -73.2642234 45.457053, -73.2649159 45.4565505, -73.2650182 45.4565418, -73.2651976 45.4564521, -73.2653128 45.4564254, -73.2654153 45.4563805, -73.2663122 45.4559235, -73.2665147 45.4559953, -73.2667207 45.4560683, -73.2667973 45.4561135, -73.2671425 45.4561232, -73.2673086 45.4561415, -73.2674751 45.4561059, -73.2684482 45.4558798, -73.2696315 45.4556048, -73.2696859 45.4555921, -73.2700858 45.4554992, -73.2709361 45.4557441, -73.2712938 45.4558471, -73.2737336 45.4565497, -73.2747484 45.4568419, -73.2786139 45.4579548, -73.2805738 45.4585191, -73.2815044 45.4589237, -73.285602 45.4607047, -73.2897372 45.4625019, -73.2897496 45.4625919, -73.2898132 45.462682, -73.2897998 45.462826, -73.2898505 45.46297, -73.2898374 45.463033, -73.289786 45.4631229, -73.2897217 45.4632037, -73.2897085 45.4633388, -73.2898352 45.4636269, -73.2899118 45.4636631, -73.2898733 45.463717, -73.2898349 45.4637079, -73.289719 45.4639237, -73.2896552 45.4639145, -73.2895139 45.4640673, -73.2893598 45.464247, -73.2893981 45.464265, -73.2893208 45.4643998, -73.2891795 45.4645976, -73.2889475 45.465083, -73.2888192 45.4651998, -73.2887164 45.4653166, -73.2885871 45.4656943, -73.2884582 45.465982, -73.2883295 45.4661797, -73.2882137 45.4663864, -73.2879818 45.4668179, -73.287905 45.4668448, -73.2878407 45.4669347, -73.2878918 45.4669617, -73.28743 45.4673569, -73.2874042 45.4673837, -73.2872506 45.4674465, -73.2872247 45.4675004, -73.2872372 45.4676084, -73.2872113 45.4676714, -73.287121 45.4678782, -73.2870825 45.4679231, -73.2870439 45.467977, -73.2869925 45.4680579, -73.2867613 45.4683364, -73.28685 45.4685346, -73.2869516 45.4687327, -73.2871425 45.468958, -73.2871167 45.469003, -73.2869249 45.4690206, -73.2868226 45.4690025, -73.2867209 45.4688493, -73.2866445 45.4687681, -73.2865937 45.4686691, -73.2864922 45.4684619, -73.2864284 45.4684078, -73.286352 45.4683446, -73.2862115 45.4682994, -73.2861605 45.4682543, -73.2860966 45.4682542, -73.2860708 45.4682992, -73.2859554 45.4683889, -73.2859168 45.4684428, -73.2859038 45.4685057, -73.2859289 45.4686138, -73.2860177 45.4688029, -73.286043 45.468875, -73.286094 45.4689291, -73.2859787 45.4689829, -73.2860295 45.469064, -73.2860679 45.469073, -73.2861061 45.4690821, -73.2861444 45.4691092, -73.2862595 45.4691093, -73.286336 45.4691905, -73.2863354 45.4693525, -73.2863992 45.4693886, -73.2864628 45.4694697, -73.286563 45.4700368, -73.2866895 45.4704059, -73.2866635 45.4705139, -73.286612 45.4706128, -73.2865349 45.4706936, -73.286317 45.4708372, -73.286189 45.4708549, -73.2860484 45.4708367, -73.2859207 45.4707915, -73.2858186 45.4707283, -73.2857422 45.4706381, -73.2857043 45.4705211, -73.2857062 45.4700172, -73.2857704 45.4699633, -73.2858342 45.4699724, -73.2858981 45.4700175, -73.2859612 45.4702156, -73.285973 45.4704676, -73.2859727 45.4705666, -73.2860237 45.4706027, -73.2861899 45.470621, -73.286254 45.4705671, -73.2862927 45.4704862, -73.2862812 45.4701622, -73.2862436 45.4699462, -73.2862309 45.4699191, -73.2861547 45.4697751, -73.286091 45.4697299, -73.2858743 45.4695406, -73.2858744 45.4695136, -73.2859511 45.4695137, -73.2859897 45.4694508, -73.285926 45.4693697, -73.2858366 45.4693425, -73.2857988 45.4692165, -73.2857354 45.4690634, -73.2857102 45.4689644, -73.2857107 45.4688204, -73.2855446 45.4687751, -73.2855192 45.468721, -73.2853914 45.4687028, -73.2853143 45.4688196, -73.2852246 45.4688825, -73.285049 45.4688464, -73.2850479 45.4688464, -73.2848665 45.4688548, -73.2848027 45.4688097, -73.2847005 45.4687825, -73.2844958 45.4688001, -73.2843679 45.4688358, -73.284176 45.4688175, -73.2840098 45.4688351, -73.2832674 45.4690048, -73.2830625 45.4690584, -73.2827297 45.4691657, -73.2823966 45.4692911, -73.2820379 45.4694343, -73.2817305 45.4695777, -73.2817175 45.4696137, -73.281474 45.4697482, -73.2812434 45.4698647, -73.281077 45.4699184, -73.2810002 45.4699273, -73.2809486 45.4700172, -73.280833 45.4701519, -73.2806792 45.4702326, -73.2806022 45.4703044, -73.2803972 45.470421, -73.2801021 45.4706634, -73.2800635 45.4707084, -73.2799864 45.4707982, -73.2797427 45.4709687, -73.2797296 45.4710586, -73.279486 45.4712291, -73.2793833 45.4713279, -73.2793447 45.4713728, -73.2793316 45.4714628, -73.2791775 45.4716244, -73.278895 45.4719118, -73.2788439 45.4719207, -73.2787154 45.4720735, -73.2786254 45.4721813, -73.2785613 45.4722261, -73.2784332 45.4722619, -73.2780737 45.4726122, -73.2779069 45.4727378, -73.2777016 45.4729174, -73.2775864 45.4729712, -73.2774452 45.4730699, -73.2773041 45.4731686, -73.2771244 45.4733482, -73.2770984 45.4734561, -73.2769701 45.4735459, -73.2768803 45.4736357, -73.2767521 45.4736984, -73.2765084 45.4738689, -73.2763034 45.4739405, -73.2761109 45.4741201, -73.2759187 45.4742367, -73.2758285 45.4743715, -73.2755592 45.4745689, -73.2755206 45.4746138, -73.2754693 45.4746497, -73.2753153 45.4747934, -73.2752126 45.4748742, -73.2751739 45.4749641, -73.2750584 45.4750628, -73.2750582 45.4751078, -73.2750325 45.4751528, -73.2749553 45.4752696, -73.2741632 45.47528, -73.2733711 45.4752904, -73.2725903 45.4751959, -73.2718095 45.4751014, -73.2717329 45.4750742, -73.2717072 45.4751102, -73.2716688 45.4751011, -73.2716562 45.4750651, -73.2713751 45.4749836, -73.2712216 45.4749922, -73.2708898 45.4748026, -73.2708007 45.4746854, -73.2705207 45.4743699, -73.2703044 45.4740726, -73.2701899 45.4739553, -73.2700884 45.4737301, -73.270051 45.4735141, -73.2700641 45.4734062, -73.270167 45.4732714, -73.2703593 45.4731638, -73.27036 45.4729838, -73.2704755 45.4729031, -73.2704119 45.472813, -73.2702844 45.4727317, -73.2701569 45.4726055, -73.2701193 45.4724255, -73.2700811 45.4723804, -73.2700429 45.4723353, -73.2699924 45.4722002, -73.2699032 45.4720921, -73.2693675 45.4717311, -73.2692785 45.4716318, -73.2691255 45.4715146, -73.2688315 45.47146, -73.2687675 45.4714779, -73.2687417 45.4715228, -73.2686779 45.4715047, -73.2685631 45.4714145, -73.2685249 45.4713514, -73.2684103 45.4712432, -73.2683593 45.4711981, -73.2683467 45.4711621, -73.2683726 45.4711082, -73.2683602 45.4710001, -73.2681815 45.4708918, -73.268055 45.4705676, -73.2680172 45.4704145, -73.2679286 45.4702074, -73.2679162 45.4701174, -73.2678404 45.4699013, -73.2677515 45.4697391, -73.2676628 45.469514, -73.2675611 45.4693967, -73.2674972 45.4693606, -73.2673828 45.4691985, -73.2673971 45.4688296, -73.2673972 45.4687935, -73.2674502 45.4683708, -73.2674504 45.4683077, -73.2674636 45.4681908, -73.2674894 45.4681458, -73.2675407 45.46811, -73.2676049 45.4680651, -73.2675795 45.4680201, -73.2675155 45.4680199, -73.2674518 45.4679838, -73.2673754 45.4678936, -73.2674011 45.4678487, -73.2673634 45.4676957, -73.267338 45.4676596, -73.2671723 45.4675153, -73.2670447 45.4674701, -73.2668661 45.4673437, -73.2666373 45.4670013, -73.2665737 45.4669382, -73.26637 45.4666948, -73.2662171 45.4665685, -73.2660644 45.4663702, -73.2658605 45.4661988, -73.2658097 45.4661357, -73.2656439 45.4660274, -73.2654272 45.465856, -73.2652236 45.4656216, -73.2650451 45.4654683, -73.2649686 45.4654232, -73.2648795 45.465324, -73.2648668 45.465297, -73.2648543 45.465234, -73.2647266 45.4651977, -73.2646123 45.4649995, -73.2644465 45.4648822, -73.2642168 45.4647917, -73.264051 45.4646744, -73.2639871 45.4646562, -73.2638592 45.4646919, -73.2637952 45.4646829, -73.2635272 45.4645473, -73.2633994 45.464529, -73.2632337 45.4644027, -73.2631447 45.4642765, -73.2628272 45.463754, -73.2627125 45.4636548, -73.2624572 45.4635642, -73.2623301 45.463375, -73.2622664 45.4633119, -73.2621525 45.4630327, -73.2619368 45.4626274, -73.2617094 45.461979, -73.2616731 45.4615019, -73.2616604 45.461457, -73.2617247 45.4613851, -73.2617887 45.4613582, -73.2619167 45.4613495, -73.2619168 45.4612955, -73.2618786 45.4612504 ), ( -73.2654577 45.4646413, -73.2654572 45.4647852, -73.2656732 45.4651186, -73.2657236 45.4653078, -73.2658127 45.4654159, -73.2658892 45.465443, -73.2660934 45.4655514, -73.26617 45.4656056, -73.2663741 45.465705, -73.2664381 45.4657051, -73.2665018 45.4657412, -73.2665785 45.4657504, -73.2667063 45.4658046, -73.2667953 45.4658948, -73.2667817 45.4660837, -73.2669859 45.4662011, -73.2671009 45.4662194, -73.2672926 45.4662467, -73.2673219 45.4662615, -73.2674713 45.4663371, -73.2675864 45.4663373, -73.2676892 45.4662295, -73.2677026 45.4660497, -73.2677419 45.4658427, -73.2676959 45.4656285, -73.2676917 45.4656087, -73.2676791 45.4655637, -73.267769 45.4654649, -73.2677693 45.4653749, -73.2677951 45.46533, -73.2677574 45.4651589, -73.2676052 45.4648976, -73.2674398 45.4646633, -73.2673759 45.4646362, -73.267312 45.4646451, -73.2671585 45.4646718, -73.2668387 45.4646891, -73.2667745 45.464725, -73.266736 45.4647699, -73.2666081 45.4647697, -73.2665699 45.4647245, -73.2665702 45.4646796, -73.2664295 45.4646702, -73.2662122 45.4646788, -73.2658415 45.4646241, -73.2657648 45.4646059, -73.2656626 45.4645787, -73.2655861 45.4645516, -73.2654457 45.4644793, -73.2653183 45.4643441, -73.2652545 45.4643259, -73.2651905 45.4643348, -73.2654577 45.4646413 ))";
		String a3 = "POLYGON (( -73.241904 45.4186979, -73.2419719 45.4185902, -73.2419982 45.4184283, -73.241986 45.4182932, -73.2418976 45.4180591, -73.24186 45.417888, -73.2417073 45.4177707, -73.2416186 45.4176175, -73.2415677 45.4175544, -73.2414912 45.4175093, -73.2414164 45.4171222, -73.2422512 45.4170194, -73.2431005 45.4169149, -73.2439457 45.4168109, -73.2447914 45.4167068, -73.2448037 45.4168058, -73.2448542 45.4169499, -73.2449175 45.417076, -73.2449553 45.4171931, -73.2449549 45.417301, -73.2449544 45.417391, -73.244967 45.4174271, -73.2449666 45.417535, -73.2449657 45.417733, -73.2449782 45.417778, -73.244978 45.4178231, -73.2450033 45.4179041, -73.2450538 45.4180302, -73.2450663 45.4180752, -73.2450917 45.4181203, -73.245117 45.4181653, -73.245155 45.4182464, -73.2451547 45.4183364, -73.2451673 45.4183723, -73.245167 45.4184174, -73.2451924 45.4184534, -73.2451919 45.4185524, -73.245255 45.4187506, -73.2453696 45.4188498, -73.2454077 45.4188768, -73.2454712 45.4189579, -73.2455091 45.4190841, -73.2455344 45.4191291, -73.2456485 45.4193273, -73.2457248 45.4193995, -73.2458647 45.4195528, -73.2458901 45.4195888, -73.2459027 45.4196248, -73.2459281 45.4196609, -73.2459407 45.4196968, -73.2459915 45.419769, -73.2460548 45.4198861, -73.2460928 45.4199672, -73.2461054 45.4200122, -73.2461561 45.4200933, -73.2461814 45.4201383, -73.2462068 45.4201834, -73.2462323 45.4202285, -73.24627 45.4203455, -73.2462826 45.4203906, -73.2462824 45.4204355, -73.2463202 45.4205526, -73.2463452 45.4206876, -73.2463578 45.4207236, -73.2463575 45.4207687, -73.2463828 45.4208497, -73.2463826 45.4208947, -73.2464203 45.4210297, -73.246496 45.4212458, -73.246559 45.421435, -73.2465715 45.421489, -73.2465969 45.4215341, -73.2466855 45.4217322, -73.2467109 45.4217682, -73.2467487 45.4218854, -73.2468116 45.4220924, -73.2468369 45.4221735, -73.2468367 45.4222184, -73.2468492 45.4222635, -73.2468489 45.4223535, -73.2468615 45.4223985, -73.2468612 45.4224434, -73.2468482 45.4224794, -73.2468481 45.4225334, -73.2468218 45.4226684, -73.2468217 45.4227133, -73.2468087 45.4227583, -73.2468084 45.4228033, -73.2467826 45.4228753, -73.2467821 45.4229742, -73.2467948 45.4230103, -73.2467946 45.4230642, -73.2468197 45.4231453, -73.2468195 45.4231992, -73.246832 45.4232443, -73.2469078 45.4234514, -73.2469586 45.4235235, -73.2469712 45.4235685, -73.2470474 45.4236767, -73.2470728 45.4237127, -73.2470854 45.4237488, -73.2471616 45.4238659, -73.2472124 45.423938, -73.2472375 45.4240281, -73.2473005 45.4242352, -73.2473131 45.4242712, -73.2473128 45.4243252, -73.247338 45.4244063, -73.2473379 45.4244512, -73.2473505 45.4244873, -73.2473503 45.4245322, -73.2473754 45.4246133, -73.247388 45.4246583, -73.2474385 45.4247844, -73.2474512 45.4248294, -73.2474766 45.4248744, -73.2475399 45.4250006, -73.2475524 45.4250456, -73.2475778 45.4250906, -73.2475904 45.4251357, -73.2475901 45.4251807, -73.247628 45.4252888, -73.247691 45.4254958, -73.2477287 45.4256219, -73.2477414 45.425667, -73.2478171 45.4258651, -73.2478423 45.4259461, -73.2478549 45.4259911, -73.2478674 45.4260362, -73.2479305 45.4262433, -73.2479559 45.4262793, -73.247981 45.4263603, -73.2480064 45.4263964, -73.2480444 45.4264775, -73.248095 45.4265946, -73.2481204 45.4266306, -73.2481203 45.4266756, -73.2480817 45.4267115, -73.2480814 45.4268015, -73.248094 45.4268375, -73.2480935 45.4269365, -73.2480932 45.4269815, -73.248106 45.4270175, -73.2481055 45.4271165, -73.248118 45.4271615, -73.2481178 45.4272065, -73.2481432 45.4272516, -73.2481685 45.4273326, -73.2481682 45.4273776, -73.2482061 45.4274856, -73.2482568 45.4275667, -73.2482946 45.4276748, -73.2483073 45.4277198, -73.2483071 45.4277649, -73.2483448 45.4278909, -73.2483574 45.4279269, -73.2484336 45.4280441, -73.2484968 45.4281972, -73.2485095 45.4282422, -73.2485858 45.4283054, -73.248624 45.4283414, -73.248662 45.4284225, -73.2486746 45.4284586, -73.2487381 45.4285396, -73.2488524 45.4287199, -73.248865 45.4287559, -73.2489158 45.428828, -73.2489155 45.428873, -73.2489534 45.4289901, -73.2490042 45.4290712, -73.2490805 45.4291343, -73.2490931 45.4291703, -73.2491439 45.4292424, -73.2491819 45.4293595, -73.2492319 45.4295756, -73.2492572 45.4296566, -73.2492569 45.4297106, -73.2492695 45.4297556, -73.249269 45.4298546, -73.2492561 45.4298996, -73.2492558 45.4299649, -73.2492555 45.4300436, -73.249255 45.4301336, -73.2492677 45.4301695, -73.2492672 45.4302775, -73.249267 45.4303315, -73.2492281 45.4304484, -73.2492151 45.4304844, -73.2491766 45.4305293, -73.2490611 45.430628, -73.2490227 45.4306549, -73.2489969 45.4306909, -73.2489585 45.4307267, -73.2489198 45.4308077, -73.2489196 45.4308617, -73.2489321 45.4309067, -73.2489575 45.4309428, -73.2489701 45.4309787, -73.2489955 45.4310148, -73.2489953 45.4310598, -73.2490079 45.4310959, -73.2490333 45.4311319, -73.2490459 45.431177, -73.2490586 45.4312219, -73.2490584 45.4312669, -73.2490838 45.431303, -73.2491089 45.431384, -73.2491087 45.431438, -73.2491466 45.431555, -73.2491463 45.4316091, -73.2491589 45.4316451, -73.2491587 45.4316901, -73.2491839 45.4317621, -73.2492347 45.4318342, -73.2492345 45.4318792, -73.2492724 45.4319873, -73.249285 45.4320233, -73.2493612 45.4321404, -73.2494374 45.4322486, -73.24945 45.4322846, -73.2495136 45.4323657, -73.2495898 45.4324739, -73.2496279 45.43251, -73.2496787 45.4325821, -73.2497169 45.4326181, -73.2497549 45.4326992, -73.2498565 45.4328524, -73.2499961 45.4330777, -73.250136 45.433231, -73.2501741 45.433285, -73.2502505 45.4333482, -73.2503141 45.4334203, -73.2503904 45.4335104, -73.2504412 45.4335735, -73.250492 45.4336547, -73.2505301 45.4337087, -73.2505811 45.4337539, -73.2506702 45.4338081, -73.2507848 45.4339163, -73.2508612 45.4339794, -73.2509121 45.4340245, -73.2510013 45.4340967, -73.251103 45.4341959, -73.251154 45.43425, -73.2511921 45.4343041, -73.2513065 45.4344393, -73.2513574 45.4345024, -73.2514338 45.4345565, -73.2514847 45.4346017, -73.2515485 45.4346468, -73.2515993 45.4346829, -73.2516375 45.434728, -73.2517395 45.4348002, -73.2517905 45.4348363, -73.251854 45.4348995, -73.251956 45.4349806, -73.2520197 45.4350348, -73.2521088 45.435107, -73.2521598 45.435143, -73.2522108 45.4351792, -73.2523508 45.4353055, -73.2524145 45.4353596, -73.2524909 45.4354228, -73.2525544 45.4354859, -73.2526436 45.435567, -73.2527201 45.4356302, -73.2527709 45.4356753, -73.2528473 45.4357384, -73.2528727 45.4357835, -73.2529363 45.4358646, -73.2529873 45.4359007, -73.2530381 45.4359458, -73.2531274 45.436009, -73.2532166 45.4360812, -73.2532929 45.4361534, -73.2533566 45.4362075, -73.2534203 45.4362616, -73.2534712 45.4363157, -73.2534837 45.4363607, -73.2535091 45.4364058, -73.2535727 45.4364599, -73.2536364 45.4365141, -73.2536874 45.4365591, -73.2537893 45.4366224, -73.2538402 45.4366674, -73.2538783 45.4367305, -73.2539163 45.4368116, -73.2539544 45.4368657, -73.2540181 45.4369198, -73.2540819 45.4369649, -73.2541454 45.437019, -73.2542093 45.4370552, -73.254273 45.4370823, -73.2543369 45.4370915, -73.2544263 45.4371096, -73.2544901 45.4371368, -73.2545539 45.4371549, -73.2546561 45.4371822, -73.2547199 45.4371912, -73.2548349 45.4371915, -73.2549241 45.4372726, -73.254975 45.4373357, -73.2550258 45.4373899, -73.2550639 45.437435, -73.2551659 45.4375161, -73.255204 45.4375703, -73.255255 45.4376153, -73.2553186 45.4376515, -73.255408 45.4376876, -73.2554845 45.4377328, -73.2555483 45.4377599, -73.2555992 45.437796, -73.2556374 45.4378412, -73.2557009 45.4379312, -73.255739 45.4379853, -73.2557771 45.4380394, -73.2558025 45.4380844, -73.2558407 45.4381295, -73.2559044 45.4381836, -73.2559679 45.4382557, -73.2560441 45.4383639, -73.256095 45.438427, -73.2561458 45.4384991, -73.2561712 45.4385442, -73.2562093 45.4385982, -73.2562602 45.4386613, -73.2563109 45.4387424, -73.2563618 45.4388145, -73.2564253 45.4389046, -73.2564634 45.4389587, -73.256476 45.4390127, -73.256514 45.4390758, -73.2565266 45.4391118, -73.2565904 45.439157, -73.2566413 45.4392201, -73.2566921 45.4392652, -73.256743 45.4393192, -73.2568195 45.4393914, -73.2570101 45.4396618, -73.2571629 45.439788, -73.2573031 45.4398784, -73.2573412 45.4399234, -73.2580286 45.4405817, -73.258105 45.4406719, -73.258245 45.4407982, -73.2582704 45.4408252, -73.2582446 45.4409061, -73.258206 45.4409691, -73.2581801 45.441032, -73.2581416 45.441077, -73.2581414 45.4411129, -73.2581408 45.4412749, -73.2581789 45.4413199, -73.2583319 45.4414193, -73.2584084 45.4414554, -73.2584723 45.4414645, -73.2585617 45.4414737, -73.2586767 45.4414829, -73.2588171 45.4415373, -73.2589318 45.4416005, -73.2589701 45.4416186, -73.2590968 45.4418798, -73.2594913 45.4423126, -73.2598852 45.4428533, -73.2600634 45.4430606, -73.2602032 45.4432589, -73.2603433 45.4433582, -73.2605086 45.4435655, -73.2606229 45.4437277, -73.2607375 45.443854, -73.2610937 45.4442596, -73.2613483 45.4444852, -73.2615396 45.4446295, -73.2616159 45.4447016, -73.2617438 45.4447019, -73.261782 45.444729, -73.2619477 45.4448463, -73.2621388 45.4449997, -73.2617675 45.4451339, -73.2612363 45.4455842, -73.2606834 45.446053, -73.260199 45.4464777, -73.2597147 45.4469023, -73.2596763 45.4469022, -73.2595869 45.446893, -73.2592422 45.4467663, -73.258847 45.4465315, -73.2586559 45.4463871, -73.2581841 45.4460712, -73.2577763 45.4457734, -73.2576998 45.4457463, -73.2576233 45.4456921, -73.2573049 45.4454214, -73.2572283 45.4453853, -73.2567825 45.4449974, -73.2566808 45.4448712, -73.2562735 45.4444744, -73.2559556 45.4440868, -73.2558409 45.4439786, -73.2557901 45.4439064, -73.2555997 45.4436181, -73.2554475 45.4433118, -73.2553968 45.4432487, -73.2552959 45.4429245, -73.2553094 45.4427626, -73.2553999 45.4425288, -73.2553624 45.4423218, -73.2552224 45.4421865, -73.2551586 45.4421504, -73.255082 45.4421322, -73.2550054 45.4421051, -73.254929 45.4420509, -73.2548653 45.4419968, -73.2548145 45.4419247, -73.2548019 45.4418797, -73.2547767 45.4418077, -73.2547386 45.4417446, -73.254726 45.4416995, -73.2547006 45.4416275, -73.2546881 45.4415825, -73.254663 45.4414834, -73.2546506 45.4414024, -73.2546381 45.4413214, -73.2546383 45.4412674, -73.2546131 45.4412044, -73.2545877 45.4411504, -73.2545497 45.4410873, -73.2544606 45.4409791, -73.2543843 45.440889, -73.2543207 45.4408078, -73.2542827 45.4407267, -73.2542702 45.4406727, -73.2542705 45.4406188, -73.2542582 45.4405197, -73.2542582 45.4404837, -73.2542457 45.4404297, -73.2542336 45.4402947, -73.2542209 45.4402497, -73.2542085 45.4401597, -73.2541705 45.4400966, -73.2541198 45.4399885, -73.2540563 45.4398894, -73.2540183 45.4398083, -73.2539933 45.4396913, -73.2539806 45.4396463, -73.2539173 45.4395202, -73.2538538 45.439421, -73.2538157 45.439367, -73.2537268 45.4392498, -73.2536632 45.4391777, -73.2535869 45.4390786, -73.2535488 45.4390244, -73.2534725 45.4389343, -73.2534471 45.4388892, -73.2534089 45.4388442, -73.253358 45.4387901, -73.2532435 45.4386819, -73.2531926 45.4386368, -73.2531162 45.4385736, -73.253027 45.4385104, -73.252925 45.4384652, -73.2527719 45.4384018, -73.2527081 45.4383657, -73.2526316 45.4383296, -73.2524784 45.4382482, -73.2523893 45.4381941, -73.2522746 45.4381129, -73.2521981 45.4380587, -73.2521217 45.4379956, -73.2520071 45.4378963, -73.2519563 45.4378332, -73.2518672 45.437734, -73.2517908 45.4376799, -73.2517143 45.4376347, -73.2515486 45.4375264, -73.2514721 45.4374722, -73.251434 45.4374181, -73.2513831 45.437373, -73.2513322 45.4373189, -73.2512813 45.4372648, -73.2512304 45.4372107, -73.2511155 45.4371835, -73.2510517 45.4371473, -73.2509882 45.4370662, -73.2508736 45.4369669, -73.2508227 45.4369219, -73.2507336 45.4368497, -73.2506827 45.4367956, -73.2506318 45.4367415, -73.2505937 45.4366874, -73.250517 45.4366602, -73.2504406 45.4366151, -73.2503514 45.4365339, -73.2503133 45.4364888, -73.2502369 45.4364346, -73.2501988 45.4363896, -73.2501478 45.4363535, -73.2500969 45.4362814, -73.2499965 45.4358852, -73.2499456 45.4358221, -73.2497546 45.4356688, -73.2496656 45.4355426, -73.2496274 45.4355065, -73.2496021 45.4354614, -73.2495767 45.4354164, -73.249526 45.4353353, -73.2495133 45.4352992, -73.2494751 45.4352632, -73.2494243 45.4351911, -73.2494117 45.435155, -73.2493863 45.435119, -73.2493737 45.435083, -73.2493229 45.4350109, -73.2493103 45.4349659, -73.2492595 45.4348847, -73.2491454 45.4346865, -73.2490184 45.4344973, -73.2489039 45.4343981, -73.248815 45.4342719, -73.2487896 45.4342268, -73.2487642 45.4341818, -73.2487263 45.4341007, -73.2487009 45.4340647, -73.2486883 45.4340286, -73.248612 45.4339205, -73.2485866 45.4338844, -73.2485484 45.4338484, -73.248523 45.4338124, -73.2484848 45.4337852, -73.2483576 45.433659, -73.2482684 45.4335868, -73.2481665 45.4335236, -73.2481157 45.4334515, -73.2480395 45.4333433, -73.2480012 45.4333163, -73.2479631 45.4332711, -73.2478997 45.433154, -73.2478107 45.4330369, -73.2477345 45.4329288, -73.2476074 45.4327935, -73.2475438 45.4327123, -73.2474928 45.4326763, -73.2474165 45.4325861, -73.2473786 45.432505, -73.2473278 45.4324329, -73.2473152 45.4323969, -73.2472897 45.4323608, -73.2472771 45.4323248, -73.2472008 45.4322437, -73.2470989 45.4321714, -73.2470226 45.4320903, -73.2469972 45.4320542, -73.2469846 45.4320182, -73.246921 45.4319371, -73.2468195 45.4317749, -73.2467559 45.4316938, -73.2467054 45.4315766, -73.2466801 45.4315046, -73.2466547 45.4314686, -73.2466169 45.4313515, -73.246579 45.4312705, -73.2465536 45.4312344, -73.2465157 45.4311174, -73.2464903 45.4310813, -73.2464525 45.4309642, -73.2464271 45.4309281, -73.2464273 45.4308832, -73.2463766 45.4308021, -73.2463388 45.430685, -73.2462626 45.4305679, -73.2461737 45.4304416, -73.2461866 45.4303967, -73.2461741 45.4303517, -73.2461235 45.4302256, -73.2460982 45.4301806, -73.2460728 45.4301355, -73.2460221 45.4300544, -73.2459587 45.4299373, -73.2458445 45.429748, -73.2458191 45.429712, -73.2458065 45.429676, -73.2457811 45.4296399, -73.2457559 45.4295679, -73.2456797 45.4294508, -73.2456672 45.4294057, -73.2456675 45.4293157, -73.2456423 45.4292347, -73.2456169 45.4291986, -73.2456044 45.4291537, -73.2455918 45.4291086, -73.2455665 45.4290636, -73.2455538 45.4290185, -73.2455284 45.4289735, -73.2454905 45.4288924, -73.2454651 45.4288564, -73.24544 45.4287573, -73.2454274 45.4287123, -73.2454149 45.4286672, -73.2454151 45.4286223, -73.2453772 45.4285052, -73.2453143 45.4282891, -73.2453147 45.4281992, -73.2452893 45.4281631, -73.2452515 45.428046, -73.2452268 45.427857, -73.2452142 45.427812, -73.2452017 45.4277669, -73.2451763 45.4277309, -73.2451385 45.4276138, -73.2450626 45.4274157, -73.2449996 45.4272266, -73.2449871 45.4271815, -73.2449238 45.4270195, -73.2449113 45.4269744, -73.244861 45.4267854, -73.2448107 45.4266053, -73.2447982 45.4265603, -73.2447351 45.4263531, -73.2447098 45.4263081, -73.24471 45.4262631, -73.2446721 45.426182, -73.2445452 45.4259748, -73.244431 45.4257856, -73.2444059 45.4257045, -73.2443297 45.4255963, -73.2442915 45.4255603, -73.2442535 45.4254792, -73.244241 45.4254342, -73.2442283 45.4253891, -73.2441775 45.425308, -73.2441524 45.425227, -73.244127 45.4251909, -73.2440892 45.4250739, -73.2440262 45.4248848, -73.2440008 45.4248397, -73.244001 45.4247947, -73.2439632 45.4246867, -73.2439506 45.4246506, -73.2439635 45.4246147, -73.2439639 45.4245247, -73.2439513 45.4244797, -73.2439262 45.4243987, -73.2439263 45.4243446, -73.2438886 45.4242276, -73.2438257 45.4240115, -73.2437878 45.4238944, -73.2437243 45.4238133, -73.2436735 45.4237322, -73.2435594 45.423534, -73.2435086 45.4234619, -73.2433816 45.4233086, -73.2433055 45.4231915, -73.2431406 45.4228941, -73.2429885 45.4226238, -73.2429382 45.4224617, -73.2428625 45.4222276, -73.2428255 45.4219486, -73.2428133 45.4218135, -73.242866 45.4214628, -73.2429437 45.4212469, -73.2429191 45.4210219, -73.2428811 45.4209589, -73.2428428 45.4209317, -73.2427922 45.4208327, -73.2427799 45.4207337, -73.2427805 45.4205986, -73.2427685 45.4204187, -73.2427059 45.4201395, -73.24263 45.4199864, -73.2426179 45.4198155, -73.2425675 45.4196714, -73.2424917 45.4194642, -73.2423528 45.4191219, -73.2422513 45.4189687, -73.2422131 45.4189237, -73.2421494 45.4188785, -73.2421112 45.4188784, -73.2420856 45.4188874, -73.2420598 45.4189143, -73.2420466 45.4190222, -73.2420204 45.4191572, -73.2419555 45.4194, -73.2419297 45.419436, -73.2419166 45.4195079, -73.2419038 45.4195259, -73.2418781 45.4195348, -73.2418525 45.4195348, -73.2418271 45.4195167, -73.241789 45.4194716, -73.2418282 45.4192647, -73.2418287 45.4191837, -73.2418296 45.4189858, -73.24183 45.4189034, -73.24183 45.4188968, -73.2418304 45.4188148, -73.241896 45.4187107, -73.241904 45.4186979 ), ( -73.244824 45.4179936, -73.2448242 45.4179307, -73.2448244 45.4178857, -73.2448375 45.4178407, -73.2447995 45.4177417, -73.2448125 45.4176877, -73.2448128 45.4176427, -73.2448004 45.4175707, -73.2448006 45.4175077, -73.2447622 45.4174986, -73.2446601 45.4174894, -73.2446215 45.4175522, -73.2446338 45.4176783, -73.2446843 45.4177954, -73.2447218 45.4179754, -73.2447727 45.4180205, -73.244824 45.4179936 ), ( -73.2456557 45.4205511, -73.2456688 45.4205062, -73.2456564 45.4204072, -73.2456059 45.4202631, -73.2455424 45.4201729, -73.2454787 45.4201638, -73.2454145 45.4201996, -73.2453889 45.4202356, -73.2453887 45.4202626, -73.2454649 45.4203707, -73.2454647 45.4204158, -73.24549 45.4204698, -73.2455536 45.4205419, -73.2455918 45.420569, -73.2456301 45.42056, -73.2456557 45.4205511 ))";
	
		polygon = (Polygon)reader.read(waterbody);
		
		others = new ArrayList<>();
		for (String w : new String[] {a1,a2,a3}) {
			others.add((Polygon)reader.read(w));
		}
		pg = createPointGenerator();
		pg.processPolygon(polygon, others, Collections.emptyList());
		pnts = pg.getPoints();

		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.2682737, 45.4546497), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2751599, 45.4527647), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2702414, 45.4549686), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2618231, 45.4471317), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2644757, 45.4486849), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2743549, 45.4526282), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2680328, 45.4510228), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2606834, 45.446053) , NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2749316, 45.4522874), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2750416, 45.4535654), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2738328, 45.4520873), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2634927, 45.4483409), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.26878045768625, 45.45580258301047), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2687315, 45.452113) , NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2696528, 45.4550934), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2665147, 45.4559953), NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2757436, 45.453299) , NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2628551, 45.4479527), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2735731, 45.4531216), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2716591, 45.4547398), NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2660657, 45.4506049), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2736575, 45.4511961), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27361354527456, 45.45419242772247), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2689754, 45.4487481), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2686295, 45.4552083), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2751817, 45.4504702), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2685922, 45.4549473), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2746469, 45.4531417), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2707256, 45.4552025), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.270805, 45.4546998), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2626512, 45.4477992), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2767814, 45.4512967), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2683685, 45.4533541), NodeType.BANK, FlowDirection.INPUT, null));

		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		
		polygon = (Polygon)reader.read(a1);
		others = new ArrayList<>();
		for (String w : new String[] {waterbody,a2,a3}) {
			others.add((Polygon)reader.read(w));
		}
		pg.processPolygon(polygon, others, Collections.emptyList());
		pnts = pg.getPoints();

		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.2682737, 45.4546497), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2751599, 45.4527647), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2702414, 45.4549686), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2618231, 45.4471317), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2644757, 45.4486849), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2743549, 45.4526282), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2680328, 45.4510228), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2606834, 45.446053) , NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2749316, 45.4522874), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2750416, 45.4535654), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2738328, 45.4520873), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2634927, 45.4483409), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.26878045768625, 45.45580258301047), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2687315, 45.452113) , NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2696528, 45.4550934), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2665147, 45.4559953), NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2757436, 45.453299) , NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2628551, 45.4479527), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2735731, 45.4531216), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2716591, 45.4547398), NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2660657, 45.4506049), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2736575, 45.4511961), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27361354527456, 45.45419242772247), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2689754, 45.4487481), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2686295, 45.4552083), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2751817, 45.4504702), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2685922, 45.4549473), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2746469, 45.4531417), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2707256, 45.4552025), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.270805, 45.4546998), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2626512, 45.4477992), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2767814, 45.4512967), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2683685, 45.4533541), NodeType.BANK, FlowDirection.INPUT, null));

		expected.add(new ConstructionPoint(new Coordinate(-73.2767814, 45.4512967), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27361354527456, 45.45419242772247), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2707256, 45.4552025), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2757436, 45.453299), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.28013051316978, 45.45839146759105), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2883179, 45.4487856), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27520675, 45.453840150000005), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2716591, 45.4547398), NodeType.WATER, FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.27629160000001, 45.4526995), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.2713348, 45.45491680000001), NodeType.BANK, FlowDirection.INPUT, null));

		
		
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	@Test
	public void testSingleOut() throws Exception {
		String waterbody = "POLYGON((-73.3162237 45.551731,-73.3161594 45.5518028,-73.3160821 45.5519557,-73.3160691 45.5520097,-73.3160562 45.5520637,-73.3160176 45.5521086,-73.3160047 45.5521535,-73.3159661 45.5521985,-73.3159147 45.5522434,-73.3158507 45.5522523,-73.3157737 45.5522791,-73.3157097 45.5522701,-73.3156328 45.55227,-73.3155689 45.5522518,-73.3155049 45.5522157,-73.3154283 45.5521706,-73.3153644 45.5521075,-73.3153389 45.5520625,-73.3153008 45.5520085,-73.3152626 45.5519364,-73.3152115 45.5518643,-73.3151476 45.5518102,-73.3150838 45.5517651,-73.3150198 45.55172,-73.314956 45.551675,-73.314892 45.5516299,-73.3148282 45.5515938,-73.3147642 45.5515486,-73.3146747 45.5515125,-73.3145981 45.5514674,-73.3145214 45.5514313,-73.3144573 45.5514132,-73.3143167 45.551368,-73.3142016 45.5513228,-73.3141247 45.5513047,-73.3140479 45.5513045,-73.3139584 45.5512594,-73.3139072 45.5512233,-73.3138562 45.5511783,-73.3138307 45.5511332,-73.3138181 45.5510882,-73.3137799 45.5510162,-73.3137672 45.5509711,-73.3137418 45.5509081,-73.313742 45.5508541,-73.3137421 45.5508001,-73.3137551 45.5507732,-73.3138064 45.5507192,-73.3138834 45.5506833,-73.3139475 45.5506565,-73.3140373 45.5506116,-73.314127 45.5505938,-73.3142039 45.5505849,-73.3142681 45.550576,-73.3143833 45.5505673,-73.3144729 45.5505584,-73.3145371 45.5505495,-73.3146908 45.5505317,-73.3148061 45.5505319,-73.3148958 45.5505321,-73.3150238 45.5505143,-73.3151006 45.5505144,-73.3152416 45.5505236,-73.3153439 45.5505508,-73.3154335 45.550569,-73.315523 45.5506051,-73.3155998 45.5506502,-73.3156637 45.5506773,-73.3157787 45.5507405,-73.3158426 45.5507765,-73.3159066 45.5508036,-73.3159578 45.5508397,-73.3160472 45.5508939,-73.3161238 45.550948,-73.3161878 45.5509931,-73.3162388 45.5510291,-73.3163028 45.5510652,-73.3163923 45.5511013,-73.3164435 45.5511465,-73.3164816 45.5511915,-73.316507 45.5512546,-73.3165069 45.5513175,-73.3164939 45.5513715,-73.3164424 45.5514434,-73.3164039 45.5514973,-73.3163652 45.5515513,-73.3163009 45.5516232,-73.3162367 45.551686,-73.3162237 45.551731))";

		String lsin  = "LINESTRING (-73.3142681 45.550576, -73.3142052850323 45.550463921079164, -73.31402565698887 45.55034816078451, -73.31387397108554 45.550196474881176, -73.31366240916773 45.55008869805513)";
		Polygon polygon = (Polygon)reader.read(waterbody);
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(lsin));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.3160047, 45.5521535), NodeType.HEADWATER, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3142681, 45.550576), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3159578, 45.5508397), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		
		waterbody = "POLYGON (( -1579200.8005433206 344349.26974770986, -1579209.1527465582 344343.7452917285, -1579225.5945284618 344342.36309857666, -1579238.2394918718 344342.61998081114, -1579254.5573383449 344347.4205646198, -1579268.892497065 344354.69368321355, -1579275.15599318 344381.3975622514, -1579273.5020481588 344394.5938063031, -1579266.8400333954 344407.1344554294, -1579259.7271354953 344415.1328210803, -1579251.2028347147 344430.0203440394, -1579245.0117083811 344438.524856057, -1579242.9817555204 344444.1781722009, -1579243.083931708 344452.6318322234, -1579244.5556398274 344472.1923603108, -1579237.2746661464 344483.4957803171, -1579230.2563306594 344485.1325299116, -1579212.2305913754 344481.8941490771, -1579196.7288310172 344475.2031837888, -1579176.7372717767 344465.85848739743, -1579165.670939847 344455.4069179166, -1579160.1874910234 344443.97045498155, -1579158.7693282887 344436.0448171003, -1579162.6035223498 344422.46861329395, -1579167.085209913 344410.3079811493, -1579172.7331117422 344397.5638729064, -1579178.306129553 344387.8226158852, -1579186.5561329168 344373.84449483734, -1579193.0200579704 344359.21219441295, -1579196.2166527524 344352.9767318107, -1579200.8005433206 344349.26974770986 ))";
		lsin  = "LINESTRING ( -1579200.8005433206 344349.26974770986 1882, -1579177.1364915506 344335.3804605063 1876, -1579170.2420664944 344330.8344765948 1875, -1579162.003027596 344321.4193415912 1873, -1579155.5785795928 344312.83677325957 1871, -1579148.1846418434 344306.92975012213 1868, -1579144.5122036452 344302.38517191913 1868, -1579135.1833035906 344295.76898492593 1866, -1579120.049816985 344281.8078725822 1861, -1579115.3637267984 344277.06117320154 1859, -1579104.2500736634 344269.79039130453 1858, -1579088.8431861529 344256.73917146213 1851, -1579076.7631370851 344246.08545851056 1847, -1579065.2552680622 344239.8488614727 1843, -1579055.258758879 344235.1767517654 1839, -1579049.6036320298 344233.10472077783 1837, -1579035.0418388145 344223.56163104065 1833, -1579023.5339617 344217.3250446012 1829, -1579017.2593874452 344214.01672078855 1828, -1579010.7577958365 344208.4370129714 1826, -1578998.7985411868 344197.659026742 1822, -1578989.546256035 344188.04089957476 1820, -1578983.3189291083 344181.55176016595 1818, -1578971.4060267124 344167.5925011793 1815, -1578962.7736103972 344159.21201599855 1813, -1578946.7463223562 344144.9240767099 1809, -1578937.0240579008 344139.3425574135 1807, -1578933.6245162135 344133.88898396026 1803, -1578928.1654975298 344128.6911419807 1799, -1578921.665228634 344123.1110072816 1795, -1578915.0436835831 344117.65605254285 1792, -1578898.0767480365 344106.2216535676 1785, -1578890.9084354884 344102.5864837738 1782, -1578869.376349488 344091.49991629366 1774, -1578864.1421153732 344088.5734488331 1770, -1578854.7659041265 344085.1381352097 1764, -1578844.376928422 344081.50116394367 1764, -1578832.446294529 344076.1204061359 1758, -1578810.8656086654 344068.21512788907 1754, -1578804.3456817989 344065.9960121354 1752, -1578795.8627301005 344062.88845975976 1750, -1578784.9733405851 344057.8900050698 1749, -1578781.253160718 344056.5271585854 1743, -1578770.4410382165 344053.74464574177 1741, -1578753.3497368982 344048.4939898951 1738, -1578743.5797516718 344046.0942275701 1734, -1578735.3220530348 344045.2571665216 1732, -1578728.9993257264 344045.1292534154 1725, -1578718.9559625983 344043.63938849233 1724, -1578707.370937533 344040.4057416301 1719, -1578700.8220646752 344038.00689879805 1717, -1578695.8148541003 344037.3518406106 1710, -1578682.3242537829 344033.58790963795 1704, -1578674.4602965156 344031.7175643565 1700, -1578666.2030310577 344030.88185914326 1696, -1578656.5814856756 344028.53576881904 1691, -1578639.793147283 344027.77291475516 1682, -1578628.4338148236 344026.81110918336 1677, -1578621.6115642968 344025.32217047084 1670, -1578601.5725189808 344019.1607779693 1660, -1578587.4620022275 344014.1614718912 1652, -1578579.598043702 344012.2911434304 1648, -1578569.828055159 344009.89141949173 1643, -1578566.106983661 344008.5281367786 1636, -1578554.550895646 344005.4742729813 1634, -1578545.174211165 344002.03991564177 1627, -1578532.969264148 343997.5709117912 1626, -1578527.3141058374 343995.49894968886 1620, -1578511.8885008793 343991.0281660119 1613, -1578502.5118132392 343987.5938180173 1609, -1578493.1640679154 343984.33921454754 1604, -1578483.3646771633 343981.760656205 1599, -1578473.744013418 343979.41506106127 1596, -1578460.920053265 343973.7088985378 1591, -1578451.5429066895 343970.2754501989 1588, -1578440.879645693 343967.54801447224 1582, -1578431.5024977713 343964.11457052734 1580, -1578423.0190708628 343961.0079805041 1573, -1578412.5819699976 343960.55148151424 1571, -1578402.510092447 343958.88328920957 1565, -1578382.4224724714 343955.9032541141 1560, -1578372.6520214756 343953.5044629518 1553, -1578364.393869154 343952.6683582738 1551, -1578351.9159936379 343949.10841031 1548, -1578338.1519831487 343946.2567107715 1543, -1578326.1731865222 343944.0586938467 1540, -1578318.3377328815 343942.36681115907 1537, -1578312.4087434043 343941.205658786 1534, -1578301.1255577898 343937.242857879 1530, -1578293.5345052753 343934.4635764649 1527, -1578284.777704386 343932.2669067979 1521, -1578275.0077059148 343929.8672488462 1519, -1578260.1530112713 343929.8140947614 1511, -1578237.1899298478 343928.980312285 1505, -1578229.551680262 343929.3818606194 1501, -1578222.0627605587 343929.8375160843 1497, -1578207.8284287304 343931.02111609094 1492, -1578201.0830165886 343931.7490603803 1490, -1578176.6377509465 343934.74937097915 1483 )";
		
		polygon = (Polygon)reader.read(waterbody);
		items.clear();
		items.add((LineString)reader.read(lsin));
		
		pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		pnts = pg.getPoints();
		
		expected.clear();
		expected.add(new ConstructionPoint(new Coordinate(-1579275.15599318, 344381.3975622514), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1579200.8005433206, 344349.26974770986), NodeType.FLOWPATH, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1579244.5556398274, 344472.1923603108), NodeType.HEADWATER, FlowDirection.INPUT, null));

		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	@Test
	public void testIsolatedWaterbody() throws Exception {
		String waterbody = "POLYGON (( -73.3268155 45.5393028,-73.3269176 45.5393839,-73.3269942 45.539438,-73.326994 45.53951,-73.3270194 45.5395551,-73.3270193 45.539627,-73.3270318 45.5397081,-73.3270573 45.5397621,-73.3271083 45.5398071,-73.3271979 45.5398613,-73.3272489 45.5399063,-73.3272743 45.5399513,-73.3273254 45.5400234,-73.3274275 45.5401136,-73.3274914 45.5401677,-73.3275808 45.5402308,-73.3276446 45.5403119,-73.32767 45.5403929,-73.3276826 45.5404649,-73.3278096 45.540807,-73.3278343 45.541095,-73.3278598 45.5411401,-73.3278724 45.5411851,-73.3279106 45.5412661,-73.3279361 45.5413111,-73.3279744 45.5413652,-73.3280509 45.5414463,-73.3281276 45.5415184,-73.3281785 45.5415995,-73.3281782 45.5416984,-73.3281524 45.5417434,-73.328088 45.5418512,-73.3280238 45.5419231,-73.3279212 45.541995,-73.3278443 45.5420308,-73.3277802 45.5420487,-73.3277161 45.5420667,-73.3276136 45.5420935,-73.3275495 45.5421114,-73.3274725 45.5421473,-73.3274085 45.5421651,-73.3273187 45.542201,-73.3272034 45.5422549,-73.3271264 45.5422907,-73.327011 45.5423175,-73.326947 45.5423264,-73.3268319 45.5422723,-73.326755 45.5422722,-73.3266782 45.5422721,-73.3266142 45.542281,-73.3265373 45.5422988,-73.3263579 45.5423346,-73.3262554 45.5423434,-73.3261658 45.5423522,-73.3260633 45.5423611,-73.325884 45.5423608,-73.3257559 45.5423606,-73.3256535 45.5423694,-73.3255894 45.5423784,-73.3254997 45.5423873,-73.3254357 45.5423962,-73.3253588 45.5424231,-73.3252434 45.5424498,-73.3251922 45.5424587,-73.3250769 45.5424766,-73.3250002 45.5424404,-73.3249107 45.5424043,-73.324821 45.5423772,-73.3247315 45.5423951,-73.3246545 45.5424399,-73.3245648 45.5424308,-73.3245008 45.5424217,-73.324424 45.5424216,-73.324437 45.5423766,-73.3245139 45.5423048,-73.3245397 45.5422598,-73.3246807 45.5422151,-73.3247704 45.5421882,-73.3248731 45.5421343,-73.3249372 45.5421075,-73.3250013 45.5420625,-73.32504 45.5420176,-73.3250401 45.5419547,-73.3249763 45.5418825,-73.3248996 45.5418644,-73.3247715 45.5418642,-73.3246947 45.5418641,-73.3246307 45.541819,-73.3245157 45.5417378,-73.3244519 45.5416927,-73.324388 45.5416477,-73.3243498 45.5415577,-73.3242988 45.5414856,-73.3241837 45.5414314,-73.3241199 45.5414043,-73.3240431 45.5413862,-73.3238639 45.5413319,-73.3237872 45.5412958,-73.3236978 45.5412507,-73.3236337 45.5412326,-73.3234289 45.5412142,-73.3233266 45.5412141,-73.3232369 45.541214,-73.3231345 45.5412138,-73.3230064 45.5412046,-73.3229297 45.5411685,-73.3228019 45.5411053,-73.322738 45.5410512,-73.3226997 45.5409882,-73.3226616 45.5408982,-73.3226361 45.5408531,-73.3225725 45.540745,-73.3225214 45.540691,-73.3224703 45.5406369,-73.3222789 45.5404297,-73.3222151 45.5403756,-73.322164 45.5403305,-73.3220233 45.5402673,-73.3219338 45.5402221,-73.3218571 45.540204,-73.321729 45.5402128,-73.3216522 45.5401947,-73.3215755 45.5401856,-73.3214602 45.5401854,-73.3213706 45.5401672,-73.3213323 45.5401402,-73.3213453 45.5400863,-73.3214222 45.5400684,-73.3215631 45.5400685,-73.3216271 45.5400597,-73.3218321 45.540033,-73.3218961 45.5400151,-73.3219731 45.5399792,-73.3220372 45.5399524,-73.3221398 45.5398985,-73.322204 45.5398536,-73.322358 45.5397369,-73.322435 45.539674,-73.322512 45.5396022,-73.3225635 45.5395482,-73.3226276 45.5395034,-73.3227815 45.5394226,-73.3229225 45.5393598,-73.3230122 45.539342,-73.3231404 45.5393152,-73.3232172 45.5393153,-73.323294 45.5393154,-73.3234093 45.5393246,-73.3235117 45.5393248,-73.323755 45.5393251,-73.3238702 45.5393343,-73.3239726 45.5393434,-73.3240877 45.5393886,-73.3242157 45.5394338,-73.3243563 45.539461,-73.3244204 45.5394701,-73.3244972 45.5394793,-73.3246379 45.5394975,-73.3247148 45.5395066,-73.3250222 45.539462,-73.3251888 45.5394263,-73.3253042 45.5393905,-73.3253939 45.5393727,-73.3256117 45.53931,-73.32574 45.5392561,-73.3258425 45.5391933,-73.3258939 45.5391574,-73.3260478 45.5390857,-73.3262783 45.53905,-73.3264447 45.5390953,-73.3265726 45.5391674,-73.3268155 45.5393028 ))";
		
		Polygon polygon = (Polygon)reader.read(waterbody);
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(),  Collections.emptyList());
		List<ConstructionPoint> pnts = pg.getPoints(); 
		
		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.3240431, 45.5413862), NodeType.TERMINAL, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3268155, 45.5393028), NodeType.HEADWATER, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.322512, 45.5396022), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		
		waterbody = "POLYGON(( -73.3389781 45.5354423,-73.3392085 45.5354786,-73.339516 45.5354431,-73.3396567 45.5354612,-73.3398872 45.5354526,-73.3401431 45.5355159,-73.3402454 45.535552,-73.3404373 45.5355883,-73.3406929 45.5357596,-73.3407824 45.5358408,-73.3408462 45.5358859,-73.3409357 45.5359669,-73.3411274 45.5360842,-73.3412168 45.5361563,-73.3417152 45.5364809,-73.3417792 45.536526,-73.3418047 45.5365621,-73.3419197 45.5366612,-73.3420345 45.5367873,-73.3421237 45.5369404,-73.3420722 45.5370573,-73.3420846 45.5371743,-73.3421484 45.5372644,-73.3422505 45.5373905,-73.3423398 45.5375256,-73.3425184 45.5377059,-73.3425952 45.5377509,-73.342736 45.5378051,-73.3429406 45.5378774,-73.3430685 45.5379316,-73.3431196 45.5379496,-73.343158 45.5379677,-73.3431579 45.5380036,-73.3431578 45.5380487,-73.343272 45.5383907,-73.3432719 45.5384268,-73.3433996 45.5385439,-73.3434893 45.538544,-73.343758 45.5386343,-73.3440268 45.5386617,-73.3442447 45.5385991,-73.3444495 45.5385993,-73.3445135 45.5386084,-73.3447693 45.5387437,-73.3449612 45.53878,-73.3450892 45.5388342,-73.3453192 45.5389784,-73.3463927 45.5397268,-73.3462899 45.5398796,-73.3462385 45.5399245,-73.3461228 45.5400773,-73.3460844 45.5401223,-73.3460202 45.5401762,-73.3459815 45.5402661,-73.3459292 45.54068,-73.3458267 45.5407068,-73.3457881 45.5407427,-73.3457108 45.5409406,-73.3458386 45.5410128,-73.3459025 45.5411028,-73.3456588 45.5412285,-73.345556 45.5413273,-73.3452611 45.5414979,-73.3449533 45.5416594,-73.3447611 45.5416861,-73.3446205 45.541596,-73.344301 45.5413976,-73.3441603 45.5413074,-73.3439943 45.5411543,-73.3438921 45.5410641,-73.3436749 45.5409108,-73.3434575 45.5407576,-73.3433298 45.5406494,-73.3431892 45.5405502,-73.3430104 45.5404061,-73.3428442 45.5402978,-73.3426526 45.5401535,-73.3424352 45.5400003,-73.3422947 45.5398921,-73.3420519 45.5397118,-73.3418092 45.5395135,-73.3416558 45.5394143,-73.3415152 45.5393151,-73.3413107 45.5391799,-73.3410935 45.5390356,-73.3408763 45.5388913,-73.3406845 45.5387561,-73.3404673 45.5386028,-73.3401989 45.5384134,-73.3399817 45.5382512,-73.3398029 45.538098,-73.3395984 45.5379447,-73.3393428 45.5377734,-73.3390872 45.5375841,-73.3388316 45.5374037,-73.3386272 45.5372595,-73.3385633 45.5371964,-73.3385635 45.5371514,-73.3385765 45.5370884,-73.3386022 45.5370345,-73.3387177 45.5369716,-73.3387436 45.5368457,-73.3386672 45.5367376,-73.338629 45.5366476,-73.3385524 45.5365575,-73.3383861 45.5365213,-73.3383094 45.5364672,-73.3381817 45.536341,-73.3380668 45.5362419,-73.3380669 45.5361969,-73.3378881 45.5360436,-73.3378882 45.5360077,-73.3379906 45.5360258,-73.3381191 45.535864,-73.3384012 45.5357114,-73.3386831 45.5356308,-73.3387472 45.535604,-73.3387986 45.5355231,-73.3388756 45.5354691,-73.3389781 45.5354423 ))";
		polygon = (Polygon)reader.read(waterbody);
		pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(),  Collections.emptyList());
		pnts = pg.getPoints(); 
		
		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.3389781, 45.5354423), NodeType.HEADWATER, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.345556, 45.5413273), NodeType.TERMINAL, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.3408763, 45.5388913), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);

		//with island
		waterbody = "POLYGON (( -73.1255718 45.6092503,-73.1256235 45.6092145,-73.1256749 45.6091876,-73.1257395 45.6090979,-73.1258037 45.6091071,-73.1258548 45.6091162,-73.1259317 45.6091255,-73.1260086 45.6091437,-73.126111 45.6091711,-73.1262005 45.6091984,-73.1262514 45.6092525,-73.1263795 45.6092709,-73.1265333 45.6092714,-73.1266492 45.6092089,-73.1266624 45.6091459,-73.1266628 45.6090739,-73.1266505 45.6090019,-73.1266123 45.6089568,-73.1264973 45.6089024,-73.1264463 45.6088573,-73.1263953 45.6088031,-73.1263828 45.6087581,-73.1263961 45.6087041,-73.1264731 45.6086863,-73.1265505 45.6086146,-73.1266785 45.608642,-73.1267038 45.6086961,-73.1267932 45.6087594,-73.1268956 45.6087867,-73.1270363 45.6088142,-73.1270744 45.6088773,-73.1270867 45.6089403,-73.1271121 45.6089944,-73.1271889 45.6090126,-73.1272535 45.6089319,-73.1273181 45.6088601,-73.1274209 45.6088334,-73.1274851 45.6088157,-73.1275751 45.6087619,-73.1275885 45.60869,-73.1276655 45.6086722,-73.1277294 45.6086994,-73.1277934 45.6087267,-73.12787 45.6087719,-73.1279338 45.6088171,-73.1279848 45.6088533,-73.1280229 45.6089073,-73.1280482 45.6089525,-73.1280607 45.6089975,-73.1280604 45.6090605,-73.12806 45.6091145,-73.1280852 45.6091686,-73.1281106 45.6092226,-73.128136 45.6092677,-73.128097 45.6093395,-73.1280069 45.6093932,-73.1279679 45.6094741,-73.1279804 45.6095191,-73.1280057 45.6095642,-73.1280439 45.6096093,-73.1280692 45.6096634,-73.1281073 45.6097085,-73.1281455 45.6097627,-73.1281707 45.6098257,-73.1281704 45.6098796,-73.1281572 45.6099246,-73.1280417 45.6099512,-73.1279649 45.609933,-73.1278752 45.6099057,-73.1277985 45.6098784,-73.127709 45.6098511,-73.127645 45.609842,-73.127568 45.6098327,-73.1275038 45.6098505,-73.1274396 45.6098682,-73.1273626 45.6098771,-73.127273 45.6098588,-73.1271963 45.6098315,-73.1271195 45.6098132,-73.1270299 45.609777,-73.1269404 45.6097407,-73.126851 45.6097044,-73.1268 45.6096592,-73.1267362 45.609614,-73.1266597 45.6095418,-73.1265959 45.6094966,-73.1264296 45.6094421,-73.1262632 45.6094145,-73.1261863 45.6093963,-73.1261224 45.6093781,-73.1259946 45.6093056,-73.1258791 45.6093143,-73.125738 45.6093318,-73.12561 45.6092954,-73.1255718 45.6092503 ),( -73.1279179 45.609276,-73.1279313 45.609204,-73.1279318 45.609114,-73.1279066 45.609051,-73.1278429 45.6089878,-73.1277534 45.6089515,-73.1276509 45.6089512,-73.1275354 45.6089598,-73.1274198 45.6089864,-73.1273556 45.6090042,-73.1272399 45.6090578,-73.1271755 45.6090846,-73.1271113 45.6091204,-73.1270082 45.609183,-73.1269182 45.6092457,-73.1268408 45.6093084,-73.1268275 45.6093804,-73.1268528 45.6094345,-73.1268909 45.6094886,-73.126929 45.6095427,-73.1270186 45.609561,-73.1271467 45.6095614,-73.1272111 45.6095436,-73.1272753 45.6095258,-73.1273395 45.609508,-73.1274038 45.6094812,-73.1274681 45.6094454,-73.1275325 45.6094097,-73.1276096 45.609383,-73.1276483 45.6093381,-73.1277254 45.6093113,-73.1278279 45.6093207,-73.1279179 45.609276 ))";
		
		polygon = (Polygon)reader.read(waterbody);
		pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(),  Collections.emptyList());
		pnts = pg.getPoints(); 
		expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-73.1255718, 45.6092503), NodeType.HEADWATER, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1280229, 45.6089073), NodeType.TERMINAL, FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1268408, 45.6093084), NodeType.BANK, FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-73.1273626, 45.6098771), NodeType.BANK, FlowDirection.INPUT, null));
		
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	@Test
	public void testWaterbodyComplex() throws Exception{
		String wb = "POLYGON ((-1545116.6724219415 309802.54312652536, -1545112.5946045234 309790.3494273452, -1545112.4516952015 309785.0943820588, -1545107.6031145942 309771.61978491675, -1545096.7550033492 309755.00362776313, -1545091.8538207298 309744.6997368522, -1545083.6428856107 309732.21139883343, -1545081.7308538663 309722.9694720451, -1545079.0116535418 309700.85194717254, -1545079.8051569925 309677.8003387805, -1545080.942729586 309656.8865895644, -1545081.4732678703 309649.6885837978, -1545079.7854078768 309642.7095025331, -1545080.6970137092 309628.26172239706, -1545077.6741440925 309606.87435172684, -1545070.6667133525 309585.2458904423, -1545060.4224625353 309563.64094531536, -1545052.0929222077 309542.5495291501, -1545046.2585472374 309520.3313085083, -1545035.8153333254 309493.11596477125, -1545033.4540076086 309488.07979703136, -1545030.444037849 309481.6377541479, -1545025.2430086643 309475.5913774697, -1545018.825947958 309463.741031982, -1545011.6473067878 309436.6801866973, -1544999.2906484252 309408.953044286, -1544991.6345021254 309385.9185843896, -1544991.0011226889 309369.7466492243, -1544991.5316480559 309362.5485653216, -1544992.481435401 309359.69639646634, -1544992.0626072444 309355.35182338394, -1544996.6990414748 309327.28763457667, -1544996.8881328104 309309.2253440581, -1545000.9645975337 309271.56227363367, -1545004.3744642562 309247.2602692591, -1545003.5186805548 309228.82624147274, -1545000.1954880496 309211.69709701836, -1544999.8509570467 309209.56007178966, -1544998.852677474 309185.8721977733, -1544996.8446049562 309173.40800454747, -1544998.4627515334 309148.4678424252, -1544998.0005323775 309137.72811427154, -1544995.6271227133 309117.74671172816, -1544994.2151095134 309109.85917255376, -1544997.155363343 309084.38185407687, -1544998.8482447732 309061.6505302191, -1544998.2475339987 309036.9278612165, -1544999.2494610974 309030.90573500656, -1544995.9797252852 309010.60611002985, -1544992.6043584403 308996.6489791041, -1544987.083969977 308985.11793772224, -1544987.6315380423 308963.15434524044, -1544989.7215381619 308939.38913954794, -1544988.087108785 308929.23952195887, -1544991.563438445 308916.7103273608, -1545005.263960927 308899.4233375862, -1545016.6630248297 308885.3466740642, -1545026.2547354216 308864.417063958, -1545036.2183362725 308845.8012245372, -1545046.1011200014 308830.1790102655, -1545056.3770414754 308822.24991447665, -1545068.5004182477 308811.7885123445, -1545083.4418691066 308796.95663062297, -1545091.4993656527 308789.2464828873, -1545107.9575769063 308775.9614447905, -1545127.3907564206 308757.5230209613, -1545137.4438605972 308747.33273956925, -1545141.2334231967 308745.49070266634, -1545148.1178415415 308738.3702856479, -1545151.9074057345 308736.52824802883, -1545156.175365116 308730.6601149542, -1545164.2328921298 308722.94994121976, -1545171.3633713368 308717.9970347611, -1545178.298439666 308713.1787638515, -1545193.7404971123 308699.7005310338, -1545206.6338459908 308690.5195494937, -1545222.7489435726 308675.0991679467, -1545237.6914031636 308660.26763730776, -1545247.7445656883 308650.07730531506, -1545261.64081 308634.8745086361, -1545274.6398492462 308619.3531012377, -1545285.793654824 308606.36403115746, -1545291.9082383013 308597.9630718054, -1545302.8245300786 308576.4960536519, -1545312.7083829904 308560.87407162227, -1545327.0309432014 308544.8150608875, -1545329.6995831907 308540.39276881237, -1545347.1917751234 308521.264290683, -1545356.732028312 308503.5056214286, -1545356.7855304263 308500.33518611453, -1545359.0583855016 308496.94624160416, -1545361.8871062656 308483.01128216553, -1545367.2451459698 308459.4004751984, -1545368.4699520355 308435.4950615028, -1545375.8448350755 308414.7834906578, -1545376.1008625366 308408.4952436993, -1545373.1102579143 308387.2871101955, -1545373.492271908 308380.03738962114, -1545376.9179295816 308370.67965824064, -1545383.1546973486 308362.1536151767, -1545377.4405872023 308348.53866940644, -1545360.063660072 308331.6153115062, -1545351.6314331903 308316.8660367569, -1545349.7069256646 308301.4089932032, -1545359.6457070368 308282.615895208, -1545365.1200449963 308267.6083666552, -1545368.0760747201 308232.5668883985, -1545366.9223517894 308218.3907535542, -1545366.6995034148 308216.12954063155, -1545363.0694964565 308208.4597626468, -1545359.7702301021 308196.7107020868, -1545346.0209686602 308167.3125317618, -1545344.097339832 308151.85585368983, -1545346.1473618771 308146.20563127473, -1545343.3318978825 308121.7027153587, -1545342.3673857334 308118.338178142, -1545339.9782303122 308113.12365280744, -1545338.9310411667 308092.60737203807, -1545346.147237168 308081.4078591829, -1545353.9834253495 308071.43575172685, -1545373.270711216 308052.94533645734, -1545386.8930846346 308038.6513404297, -1545416.5556860282 308015.45641052723, -1545420.0689804815 308014.52355922665, -1545422.0655132385 308012.0437999852, -1545442.1426244352 308000.2138310028, -1545459.2535032975 307988.33599348646, -1545469.4705446723 307968.6342384042, -1545479.4634088823 307946.67165802326, -1545486.59297732 307927.0474376315, -1545494.867017132 307906.65487552993, -1545503.1203023603 307880.8840620294, -1545509.770567317 307865.2855858896, -1545531.2916199826 307852.79429301526, -1545529.154867526 307850.0199469514, -1545508.7778519685 307841.5989743769, -1545496.9198359363 307836.2073844243, -1545481.6555280138 307825.40760472976, -1545470.3584549273 307808.3172639571, -1547931.02428742 308051.1388203427, -1550644.2170704934 308319.0207168367, -1550646.1077511846 308334.7916590972, -1550646.9492788133 308338.2823868776, -1550646.357873716 308363.599617593, -1550644.4994677838 308386.2804949209, -1550640.2281251752 308407.0937104691, -1550629.0125078717 308423.2449821476, -1550607.8310644375 308437.85503997933, -1550583.7559716655 308454.6251898892, -1550580.2429211137 308455.5546207754, -1550578.2455868872 308458.0329762455, -1550573.281936098 308460.4609382432, -1550564.3954043014 308470.05341305956, -1550566.8198400664 308493.08763636276, -1550574.568728504 308509.79115930013, -1550585.8854379146 308522.3950403137, -1550596.4814415034 308531.38144554384, -1550599.7640939315 308536.91921936814, -1550613.9852160818 308553.5820107041, -1550626.7914797135 308571.0835741507, -1550638.822231178 308588.1401026817, -1550653.227175346 308615.6164732883, -1550668.2893212289 308635.77083380055, -1550681.0955432337 308653.2723797634, -1550693.3745155085 308669.24239712954, -1550704.8978806315 308693.676243132, -1550718.8041618012 308719.79958970845, -1550728.0690939322 308738.0533054536, -1550737.427790116 308759.5307582766, -1550747.0347390305 308779.9217111822, -1550760.526277638 308801.6995219756, -1550771.3616922144 308818.32970963605, -1550783.5591691472 308840.82172299735, -1550790.9757387459 308861.6063628318, -1550800.5278233762 308885.1696774736, -1550805.022531696 308907.93488806766, -1550808.7048338905 308927.3870816147, -1550813.7359687292 308942.954885507, -1550813.5321511407 308946.0723840734, -1550815.2714829168 308964.83133364376, -1550806.2978225385 308989.9658092186, -1550801.1776844985 309004.3070958201, -1550805.0248500293 309014.2456242535, -1550812.7270565527 309025.3920165412, -1550820.1992677595 309043.0068329908, -1550822.807132294 309061.9081096342, -1550829.2181587387 309088.71598431934, -1550833.0390738111 309113.4241035115, -1550838.8015964415 309138.82585563324, -1550838.0641809932 309164.0901250271, -1550837.7901135518 309179.9475156497, -1550839.4468433233 309201.70057185274, -1550842.0289677677 309223.9517634306, -1550843.158551501 309232.7524267547, -1550843.466446199 309258.3897611238, -1550840.4382928456 309281.6613174854, -1550839.9046956713 309303.80798589904, -1550837.9654978435 309318.06237217784, -1550838.807423808 309321.5543284677, -1550835.8880110853 309338.4829012472, -1550829.4012444795 309359.51225716434, -1550827.6924780076 309367.29961415846, -1550820.5324240092 309390.27109948266, -1550814.516040916 309412.4761391701, -1550811.9570169155 309425.50294180214, -1550811.5165600148 309435.9260825021, -1550808.3398737346 309459.1438960051, -1550808.1210706555 309471.83010086976, -1550807.1989841869 309486.2803361304, -1550804.4482260572 309508.6428595595, -1550799.754533419 309530.3121432187, -1550797.6485035247 309539.13322438765, -1550794.897753547 309561.4956948506, -1550792.9046513538 309578.9226877168, -1550796.1622957138 309599.23141333647, -1550796.5637667 309613.14639221784, -1550790.4972609133 309653.47135985456, -1550786.0087466568 309672.02266461495, -1550777.9795188461 309691.32517306414, -1550771.038771454 309701.6115835393, -1550760.1707770457 309719.90169979166, -1550755.2264403207 309727.70945043024, -1550741.892150835 309747.3015741734, -1550727.540333641 309766.69861066993, -1550723.3249965627 309769.39238554426, -1550706.7260455196 309788.82733358257, -1550700.2656090967 309795.0870708702, -1550683.5280269976 309809.26610221155, -1550652.8869751908 309823.688788373, -1550650.8901530085 309826.16607619636, -1550639.1812107533 309840.9646512959, -1550633.594025596 309862.31445515994, -1550626.2681802136 309879.85276912246, -1550619.3818592227 309886.9676992856, -1550588.740901373 309901.3903275281, -1550568.154943325 309905.63155495934, -1550548.1232634608 309908.05388699286, -1550528.6561743561 309914.87686070707, -1550501.0175160158 309920.79907570407, -1550489.898055429 309925.22736472636, -1550468.9148731506 309930.5023753615, -1550445.1598528621 309937.8109888686, -1550414.3986684643 309952.35950197745, -1550392.382360813 309963.4795567887, -1550380.2176384244 309967.5346960211, -1550373.1092602513 309972.38746872544, -1550354.0147220923 309981.52704274096, -1550338.57180289 309994.9931328958, -1550334.1818301596 310000.98411193304, -1550326.581034943 310019.4310665671, -1550327.9337130492 310030.49395772815, -1550333.5213340307 310044.24435709044, -1550342.9921123537 310059.37978180964, -1550351.815739523 310073.10875201225, -1550358.3347420795 310078.626141103, -1550368.3657607506 310083.21377870254, -1550346.1205130413 310100.8022987433, -1550336.3968799547 310106.9043781208, -1550319.1023176424 310107.9532852229, -1550302.8053644442 310111.70932523906, -1550287.5541407333 310115.83985975385, -1550278.4320085295 310117.78997189365, -1550271.3779977337 310119.47137237433, -1550251.49751232 310157.0479598297, -1550248.6713704476 310162.2528628381, -1550236.169966339 310179.1195867462, -1550226.681098848 310193.70320642553, -1550222.4720233467 310211.3461086657, -1550222.6182450836 310231.5506118024, -1550221.975492315 310245.09242457245, -1550226.2817429085 310265.7740488015, -1550225.3058745111 310303.54725674074, -1550225.1437986235 310313.06163096894, -1550226.8281545148 310320.044313618, -1550227.034861951 310352.0265226569, -1550228.246048949 310377.98523211945, -1550230.5305345927 310380.8164162589, -1550230.9756857874 310385.34104459174, -1550244.8887366885 310411.466263799, -1550260.933167704 310428.94885267597, -1550265.733132034 310436.03597623017, -1550268.512709727 310439.32138400245, -1550279.9850096982 310452.8776008971, -1550293.6628516293 310470.5222102478, -1550309.430792185 310488.9140034048, -1550318.9284780475 310500.70117841195, -1550331.1305452012 310523.19307850953, -1550345.968414649 310549.8172632223, -1550350.7992721763 310568.503093807, -1550353.5297662262 310575.85932999104, -1550355.786580974 310602.19234971516, -1550354.611890139 310622.9330769107, -1550349.7834190323 310639.34732736833, -1550344.8737505586 310658.7552019702, -1550336.6011319994 310679.1454257015, -1550333.4517586192 310687.59377741534, -1550330.2827156559 310690.6610130407, -1550329.1826549887 310693.46001543105, -1550318.510343629 310702.41355196014, -1550294.7589272151 310709.7221938921, -1550275.0184973506 310717.4553442793, -1550273.1374317394 310728.5393366078, -1550279.0153482978 310747.5990738021, -1550295.2540075318 310767.1654908452, -1550295.6452540986 310774.8626484703, -1550285.1551295759 310795.46966322046, -1550282.2625512325 310797.6276875194, -1550276.275834783 310805.0632230649, -1550259.3193826184 310816.98078256287, -1550241.9379342536 310829.7539721541, -1550233.8809156814 310837.4581605643, -1550220.9040690407 310838.2003014721, -1550210.063128397 310841.72003416345, -1550202.1466043103 310854.6807594467, -1550203.4556147933 310858.94460596517, -1547730.6666362272 310743.6472122539, -1544973.3262533105 310615.2210359145, -1544974.078489249 310603.57225288264, -1544974.6441776673 310578.2591666989, -1544977.8027466512 310555.04216154106, -1544980.954338859 310537.0269071087, -1544984.1120257636 310513.8094049543, -1544987.413524862 310495.8472189782, -1544990.5651252915 310477.8319164412, -1544998.3563585887 310456.26263293717, -1545017.3988834198 310415.3628538707, -1545025.810991898 310395.0212649405, -1545028.1331858598 310388.4615441449, -1545042.6955373222 310371.31500434317, -1545057.2856823043 310354.34651910514, -1545067.5885846897 310337.867574621, -1545077.518310103 310319.07315477636, -1545082.059768928 310312.29496334214, -1545098.6463582916 310292.8469624603, -1545104.309631561 310279.9219661597, -1545104.362226682 310276.7513189679, -1545111.7286679507 310256.0374533739, -1545119.2445642443 310235.377559023, -1545130.1527877913 310213.90950570535, -1545139.6332965195 310199.32068117615, -1545153.6728899013 310154.4584100852, -1545161.4364926745 310132.71070681326, -1545169.177060227 310114.3126327414, -1545175.319219321 310097.36076983996, -1545178.6070312385 310073.18231055513, -1545184.1809508575 310051.8319548052, -1545190.3761814258 310031.7084685182, -1545194.0071783403 310009.66733920295, -1545195.381863599 310005.9596026819, -1545197.220287623 309983.2799286023, -1545195.7950349986 309960.44611711986, -1545193.9351839828 309948.03444731794, -1545190.716005053 309924.56252154894, -1545179.0308347826 309894.89056677, -1545170.1986618263 309881.1731286952, -1545154.5679805854 309862.8560557198, -1545140.9249409505 309847.2604841776, -1545130.3523068621 309829.73470599484, -1545118.5101733825 309809.5752732996, -1545116.6724219415 309802.54312652536))";
		
		String line1 = "LINESTRING (-1551554.8389520333 308812.65794730466, -1551547.933184228 308814.39076444786, -1551528.1856795151 308822.12067415845, -1551511.9508198756 308828.91988809686, -1551494.0246070959 308837.46713258047, -1551477.7901969631 308844.2676896723, -1551460.112283614 308851.7284387052, -1551441.6875285876 308858.9226952344, -1551420.7008908123 308864.1943726009, -1551399.6856174557 308869.2874995908, -1551378.699885852 308874.5596387647, -1551353.673001984 308879.22914704867, -1551336.7528661275 308881.75426774286, -1551319.058128142 308883.8348030476, -1551293.689718467 308886.36617442966, -1551275.3747209453 308887.21782761905, -1551250.4318095276 308888.8948392682, -1551233.9098803166 308890.38661924936, -1551209.7798097772 308895.3757856954, -1551186.5189609167 308904.0359801352, -1551164.4322555256 308912.10696230363, -1551146.9039248463 308919.6217524437, -1551130.6152604464 308929.5938616749, -1551114.8242743886 308940.9207179304, -1551101.308020567 308948.8604555512, -1551084.7972877375 308956.5703075966, -1551065.7533148967 308962.53616166767, -1551045.7188474112 308964.95867754053, -1551027.0332643122 308963.4945851853, -1551010.7705042125 308958.6978374645, -1550994.0826987666 308954.7568127848, -1550976.4710835172 308953.8444577381, -1550957.2325458303 308954.19894205034, -1550936.5778222305 308955.3926160792, -1550915.8222588724 308954.1986282924, -1550895.2232584008 308952.2203686582, -1550871.6293231116 308950.0131367361, -1550853.093641102 308948.60446607694, -1550845.6960323113 308948.1469643889, -1550839.4654374544 308947.9385399502, -1550836.6270606774 308946.9252811689, -1550813.5321511407 308946.0723840734)";
		String line2 = "LINESTRING (-1550961.9466367904 311020.97387681715, -1550943.833663926 311003.75716089364, -1550936.695511476 310997.00920268055, -1550929.8047237033 310989.17440585047, -1550925.228341735 310984.34890263714, -1550919.7552460048 310979.20379432384, -1550904.1563022716 310966.24345538486, -1550889.4049102208 310948.04486623965, -1550878.4184532466 310931.3572425004, -1550867.5805455663 310914.72317239176, -1550855.1493051688 310898.69608065113, -1550841.6670202333 310883.133616196, -1550825.568576817 310868.8199596824, -1550810.065089751 310859.08624834474, -1550805.9590358953 310855.43642244395, -1550790.0287445323 310846.55744641554, -1550770.8155630867 310832.1397452997, -1550754.7175195748 310817.8274501525, -1550739.801673477 310797.72298007086, -1550737.4146097552 310792.5033940971, -1550739.4870931136 310772.0827632267, -1550738.294525298 310751.5035959808, -1550730.6251532375 310731.8031594902, -1550713.5352568843 310713.9459610963, -1550704.1054825087 310705.20503871236, -1550688.6267455043 310692.1210789485, -1550673.0267461333 310679.1625400428, -1550655.7558982337 310665.43895185366, -1550636.6443532642 310653.4092185451, -1550615.2121432715 310639.2088799458, -1550595.6020099143 310625.8262864696, -1550576.6646991384 310610.50031010807, -1550558.099370991 310597.49177405704, -1550535.5683850953 310586.0900518289, -1550515.0071508337 310575.55917579215, -1550497.9578947383 310564.09860599414, -1550484.9205144276 310553.06301141623, -1550475.562437217 310546.5319712395, -1550471.8274457944 310545.19914133195, -1550467.0476287485 310543.49226990435, -1550445.567522692 310547.41365766805, -1550426.3789907221 310553.32800456695, -1550407.311721336 310559.1169347791, -1550394.6776889623 310561.996645567, -1550383.836647988 310565.51643581595, -1550358.4721401813 310568.05101033207, -1550350.7992721763 310568.503093807)";
		String line3 = "LINESTRING (-1544352.666972511 308160.5147728631, -1544354.2376357866 308158.8902966874, -1544370.4498959382 308146.6911563128, -1544380.1309959642 308134.18444213737, -1544383.0246717115 308132.0232782578, -1544391.2850227563 308121.19413385727, -1544407.4542651188 308102.60098086763, -1544421.1035373944 308088.48372352123, -1544426.2700035907 308082.93354635965, -1544446.6899009785 308073.2365065152, -1544466.554622537 308074.08464701474, -1544479.7069604278 308078.75846696645, -1544492.860185265 308083.4327452611, -1544506.7680772354 308083.17159472406, -1544510.7066721858 308081.3820913248, -1544516.2893586832 308080.17754351627, -1544534.9461957973 308070.0210227519, -1544538.7357725394 308068.17887287587, -1544553.146786691 308060.5425550798, -1544565.3145683925 308056.4742428027, -1544578.7971230717 308057.06971852295, -1544589.1101033466 308060.7347370768, -1544595.4383959507 308064.15879170224, -1544622.6407388148 308073.82644347474, -1544626.1287780353 308076.2412105901, -1544647.5980526258 308087.0612063445, -1544661.294393918 308099.481944317, -1544676.9771433542 308114.6247308096, -1544690.8672277846 308129.12902039196, -1544706.9227517974 308146.58610624634, -1544723.7694696994 308170.7031355351, -1544735.2654772007 308188.7218546355, -1544755.1105473337 308204.3368124617, -1544775.488769963 308212.754728931, -1544790.637086921 308214.94979911577, -1544794.426670211 308213.1076787347, -1544810.951467542 308211.5956308432, -1544824.9123650538 308208.1650258545, -1544837.4967844798 308208.44154837355, -1544851.2981838437 308214.5227548098, -1544854.3612998342 308217.7932561552, -1544864.1211083028 308223.277741286, -1544879.9740616097 308243.85267581046, -1544882.760834429 308248.03243224975, -1544893.4660251334 308259.3925883034, -1544900.1922921403 308261.7833361663, -1544912.1567078384 308260.8324937653, -1544931.937906743 308264.6754323095, -1544944.222521634 308269.2097938806, -1544957.5976481661 308276.1471854551, -1544978.1700079895 308286.65008549765, -1544995.7074949208 308294.0596798714, -1545014.5388735097 308300.75496450905, -1545025.883300266 308298.5767603358, -1545040.4637496332 308296.374511905, -1545066.5107643644 308291.8690854907, -1545073.289164294 308291.08984572534, -1545101.937518237 308279.116178141, -1545122.78337259 308268.566398697, -1545127.470200225 308267.04289486166, -1545154.6013845433 308253.52322940715, -1545162.0541629116 308250.8013885198, -1545184.8001410328 308234.5483069606, -1545187.7216518894 308232.5652580168, -1545211.0889865959 308217.53912920505, -1545223.6535334035 308212.4380603619, -1545246.3558409868 308214.2989610452, -1545256.2716293149 308219.0001782533, -1545277.7195419332 308224.4432480866, -1545283.6745752892 308225.5539847659, -1545293.4205716613 308224.82218875084, -1545304.212360417 308224.46253212355, -1545327.6412050896 308221.2108251015, -1545352.1180808346 308218.3312832806, -1545366.9223517894 308218.3907535542)";
		String line4 = "LINESTRING (-1544512.9746400681 310025.9882646613, -1544523.5403494884 310023.3663807912, -1544552.1271446457 310014.5619930299, -1544563.313273806 310013.16876543406, -1544566.7046941218 310012.36012857687, -1544591.5725579602 310008.4437898854, -1544594.2914464173 310009.57850352675, -1544610.1624040203 310006.6610624939, -1544622.5498345306 310004.8553191228, -1544644.1804967984 310000.963421762, -1544668.0017341527 309996.6767650405, -1544689.0871840036 309993.76640331093, -1544697.0365657648 309992.39672692306, -1544721.95659265 309985.3106507668, -1544748.3246747802 309976.7261262061, -1544751.2160236465 309974.56519013736, -1544754.4810331776 309974.71884338744, -1544759.867970662 309971.430253393, -1544764.2769154878 309970.81656552106, -1544767.16872061 309968.6547392346, -1544774.4981418094 309966.0577511806, -1544793.7393073158 309956.95264473, -1544796.5098821109 309954.9162422139, -1544806.8518974893 309950.0328910304, -1544809.070707053 309949.8153109085, -1544833.9221423168 309939.6839922108, -1544858.640205357 309935.71685339604, -1544863.3537236985 309934.37116640806, -1544873.919508858 309931.7493124958, -1544886.278764354 309929.76641995367, -1544894.9016162339 309926.4538500635, -1544911.1302459394 309919.6351092383, -1544912.4523253264 309919.098050938, -1544920.6498379395 309916.64202034567, -1544935.5868304668 309901.81010789145, -1544944.2909477358 309895.5053734351, -1544951.6960130392 309886.38802335225, -1544955.9629370624 309880.51978305914, -1544962.8444688332 309873.398440687, -1544966.909362398 309870.64689910784, -1544984.5131372411 309860.12173249666, -1544986.5077761218 309857.641304004, -1545008.2963558135 309844.2395969853, -1545024.9747528133 309833.21640842315, -1545032.4254637337 309830.4939905936, -1545034.6442849278 309830.27641394455, -1545041.6005704007 309825.3639182113, -1545062.6114495627 309820.2469794918, -1545086.0888268575 309813.82474909443, -1545106.8764395388 309806.4454122232, -1545116.6724219415 309802.54312652536)";
		String p1 = "POLYGON ((-1551902.7225822012 310404.035041363, -1551886.6564637872 310401.31841874775, -1551861.7187881086 310402.99009443354, -1551838.5178752074 310408.47460914403, -1551830.1710993166 310410.8672576966, -1551813.8575948277 310409.2375348229, -1551775.2896286314 310395.29167244583, -1551757.1425527236 310386.6250908151, -1551753.1315116938 310386.2004827, -1551741.1595155033 310380.9156981064, -1551738.0443117635 310380.8102591671, -1551729.5299225973 310377.7694192128, -1551687.34100316 310371.09602117445, -1551663.7508977468 310368.8840801632, -1551651.1706041833 310368.58867373224, -1551644.1460495892 310370.4466553405, -1551619.7327259004 310370.12369314395, -1551598.5287427153 310373.1310918629, -1551553.115327457 310372.69821920805, -1551530.975370843 310368.98885875754, -1551517.1268518565 310366.05771564785, -1551492.3520431628 310358.2163851252, -1551466.9034609664 310352.31804150157, -1551440.4750951936 310349.0929081114, -1551423.486041305 310349.40761656873, -1551398.4529384226 310347.85726746917, -1551372.644371259 310345.8618962951, -1551350.930346617 310341.29741460644, -1551342.7865840162 310340.57234140486, -1551322.9859061367 310336.5243508043, -1551316.6351424672 310336.43939913064, -1551297.1109434704 310331.48219896667, -1551290.7597255846 310331.39814054314, -1551280.7952100504 310329.8548732549, -1551275.0646959753 310330.99876042455, -1551271.329684925 310329.6658613272, -1551259.646579637 310329.69150855485, -1551238.7730872633 310328.61936678644, -1551217.871386889 310327.37003436964, -1551194.9841617132 310323.39523507375, -1551176.107515046 310319.84589695, -1551156.8593364304 310313.9804267818, -1551137.4836944016 310309.0768543724, -1551115.8236028412 310301.3420274062, -1551094.5059431882 310295.74569701403, -1551090.152019025 310293.1835485697, -1551085.9915380343 310292.7049835874, -1551067.566547127 310284.95059368946, -1551056.9826658 310282.1790004913, -1551035.5985790251 310273.5358823696, -1551013.0126418641 310265.30384569895, -1550989.8355440889 310256.0206458969, -1550969.6184212358 310247.62664871383, -1550917.2049540062 310245.7074640477, -1550868.6942326992 310250.5568951145, -1550865.181314684 310251.486152946, -1550862.3430252592 310250.4728932474, -1550858.9522526397 310251.277185319, -1550846.6479982 310250.07588758506, -1550828.0730805642 310242.2684793584, -1550825.6052971184 310241.29549097456, -1550801.1613808263 310231.6538659949, -1550781.3602379386 310227.60700261313, -1550771.8942736394 310227.41898001265, -1550767.48508479 310228.0277527822, -1550744.7360213392 310229.3121123137, -1550736.7870515194 310230.6725192899, -1550670.9149363984 310233.5249588974, -1550649.1447375505 310232.1357063176, -1550640.0760494533 310230.9139553178, -1550633.5040824118 310228.56743093766, -1550599.4839939242 310222.80562515557, -1550595.7203271477 310221.2942421166, -1550592.8820358587 310220.281000074, -1550586.7350893598 310217.0788196223, -1550583.524780826 310213.7503420999, -1550580.2161251036 310211.56140386034, -1550573.9736219882 310205.13476842083, -1550569.4510202399 310197.1387699414, -1550565.96470174 310194.71862327214, -1550561.2204367048 310184.459617232, -1550548.0972809945 310164.9971900508, -1550511.4909240329 310136.9842753038, -1550500.5349981165 310131.8975758264, -1550485.7227865104 310125.60346920136, -1550480.5929008015 310122.59725572634, -1550472.354467678 310118.6483296938, -1550468.3429780004 310118.22472273745, -1550454.7713028297 310114.38826439064, -1550448.42009683 310114.3043222781, -1550445.702599163 310113.1665579863, -1550442.4665852701 310113.1879704017, -1550437.4093713632 310112.3898702925, -1550427.0475650185 310111.88278135564, -1550421.7134370853 310111.99479556736, -1550401.116838159 310110.0173927462, -1550379.4126304782 310111.6759800194, -1550374.8544355463 310112.23212462105, -1550341.154682191 310123.38106432, -1550337.6417811392 310124.3103597034, -1550333.2043899682 310124.7419744544, -1550331.6343991903 310126.3644664753, -1550308.6815827577 310130.76859249454, -1550283.0681412045 310134.3907101331, -1550271.0717286863 310143.8805934051, -1550262.7372317335 310152.49384128675, -1550257.2288814934 310155.9021819001, -1550251.49751232 310157.0479598297, -1550271.3779977337 310119.47137237433, -1550278.4320085295 310117.78997189365, -1550287.5541407333 310115.83985975385, -1550302.8053644442 310111.70932523906, -1550319.1023176424 310107.9532852229, -1550336.3968799547 310106.9043781208, -1550346.1205130413 310100.8022987433, -1550368.3657607506 310083.21377870254, -1550373.025717458 310085.0456262389, -1550382.2147905848 310086.1414408898, -1550387.7419426667 310088.11388724204, -1550412.3795771457 310090.69387814496, -1550440.103326134 310093.1993470667, -1550463.9833687602 310100.71469133627, -1550468.6142424566 310102.3666623561, -1550492.771175369 310108.97414305154, -1550494.7131976427 310109.66689227894, -1550512.6401744469 310116.06501605175, -1550523.1701943055 310122.0069319857, -1550526.2314983841 310125.282744769, -1550545.6193246825 310136.40196821094, -1550557.7614381544 310147.11766315345, -1550576.5490801763 310162.38843734376, -1550592.0275985715 310175.4711656049, -1550602.0581344105 310180.05974641256, -1550609.2794766698 310183.81273903884, -1550632.0602656608 310194.12770553306, -1550634.6212064445 310196.04971680883, -1550655.513435053 310202.5001459969, -1550658.7780946563 310202.6572926631, -1550662.5131164358 310203.99013896566, -1550665.6274187102 310204.09505438246, -1550669.362440365 310205.4279012792, -1550692.177944654 310207.1903128689, -1550712.654166455 310209.29372810293, -1550725.5108995985 310208.677435888, -1550748.6037657037 310209.531105794, -1550758.4947584716 310208.86345771234, -1550857.533390023 310221.1627454702, -1550974.8927087293 310235.7380699497, -1550984.027836546 310240.0067005446, -1551014.9787535274 310251.22540760227, -1551034.3000337332 310259.3002734035, -1551057.2827955575 310266.4994589323, -1551068.8842115072 310269.4661293747, -1551072.2210627599 310271.8323086556, -1551088.630970384 310276.6844662884, -1551108.6268777247 310282.8168462571, -1551134.0215383011 310291.88544647116, -1551153.2697263192 310297.75090599153, -1551193.066307385 310307.931240364, -1551212.9882468763 310311.8537536962, -1551236.5501267328 310313.8860416142, -1551259.520858992 310314.867160921, -1551280.1169944552 310316.84807417914, -1551300.8148386804 310321.21700211987, -1551321.0128050824 310324.2312302431, -1551345.8973489797 310325.727976514, -1551369.608689043 310327.81434197817, -1551397.6075503887 310329.4160747044, -1551420.69865146 310330.2736271396, -1551441.2284088635 310329.207780106, -1551461.426819354 310332.2234109668, -1551468.8959315363 310334.89102193713, -1551489.0399261385 310341.0780238779, -1551491.9351566252 310342.3438442685, -1551503.7294180766 310347.50056818686, -1551515.756756446 310349.61214690283, -1551537.4044051855 310351.12987529486, -1551553.6482874127 310348.88371311687, -1551563.166160525 310347.56730012037, -1551587.1535527962 310348.74543762393, -1551615.3563172414 310347.22994330246, -1551636.8363495306 310343.3142058542, -1551644.1124979758 310343.8973599225, -1551672.9642818945 310355.2111000838, -1551686.3855339328 310358.9979310818, -1551693.1622489805 310358.22771933395, -1551717.0288533662 310359.5304479636, -1551733.493157418 310361.2137115598, -1551752.562765049 310366.84999577794, -1551771.357839343 310376.92351322994, -1551792.591481515 310385.51699951664, -1551815.2848715107 310387.4093796108, -1551837.3302762597 310387.89483248163, -1551856.9093540371 310389.68224100396, -1551879.6108554462 310382.84434393793, -1551892.2447258155 310379.96797952894, -1551913.284526734 310386.47657959256, -1551924.239874661 310391.566771918, -1551933.7049813576 310391.75679451507, -1551937.0966827073 310390.95302151795, -1551950.609595567 310383.0158998715, -1551969.1206152213 310364.09941799194, -1551986.5605564064 310348.15965458006, -1551990.3495651158 310346.32212506793, -1552000.4053357262 310336.14236342907, -1552004.398703327 310331.18657637294, -1552014.3897852523 310325.94769132324, -1552021.5647957686 310333.8823067518, -1552028.2659177755 310341.2926930627, -1552009.8188616047 310354.45412353147, -1551992.3789107688 310370.3938793121, -1551983.6462519385 310380.0393850999, -1551971.871417535 310391.78891155124, -1551953.0243563328 310399.8356381599, -1551926.709548376 310405.21423765086, -1551906.8544309002 310404.33513258304, -1551902.7225822012 310404.035041363))";
		String p2 = "POLYGON ((-1550853.5260222028 304417.14907593, -1550850.5728197661 304422.4781826334, -1550844.7427172584 304441.5614499189, -1550846.135410273 304464.3948951848, -1550849.6994041891 304475.23861630075, -1550854.4951067176 304482.32354859635, -1550873.6938720327 304491.351848511, -1550880.2689827015 304493.69620207883, -1550882.0051923215 304497.50703408197, -1550878.5580774108 304521.8064612681, -1550882.0659115436 304535.82134743035, -1550892.8728069682 304562.0114495056, -1550905.9861063082 304581.4670801293, -1550924.3588416444 304592.38573153596, -1550930.2574428336 304596.67220667657, -1550948.4878927895 304613.7528329976, -1550960.790000629 304629.8967187442, -1550973.505042781 304650.38590973616, -1550987.486738542 304673.5104300743, -1551003.8089041072 304696.29415088426, -1551018.686073767 304719.7386984369, -1551034.4466949317 304738.1235519117, -1551037.727392849 304743.6598135205, -1551055.1175020845 304757.2510137744, -1551062.076648863 304767.2908636555, -1551079.3521880214 304787.22436329443, -1551094.0673437226 304805.2360459436, -1551107.7131438262 304832.44064525515, -1551110.2320592988 304842.9124549236, -1551107.2779585014 304848.24100210425, -1551093.5790174815 304865.69306963775, -1551083.516053604 304882.091740326, -1551083.2533735968 304888.3795598233, -1551087.9776879607 304893.2554136319, -1551116.8680520423 304883.5720857391, -1551125.385797759 304886.61059981864, -1551130.2384728491 304890.52480264194, -1551132.9064125726 304901.0492626289, -1551128.4578783659 304916.4265671503, -1551126.4585635394 304918.9044741886, -1551107.3524392853 304913.09855972324, -1551099.4541445756 304911.2886471106, -1551093.1640969038 304914.2525324682, -1551091.6625242124 304918.08314975817, -1551093.4331748208 304928.2888714932, -1551102.8112376367 304946.4128383137, -1551121.8027842664 304958.5610053288, -1551125.8161198706 304958.98401951883, -1551133.0101475436 304962.5578974141, -1551137.7344498702 304967.4337491561, -1551143.4756195939 304986.61285906937, -1551146.8696560597 305006.97026917525, -1551152.617521992 305032.366135044, -1551163.1048094444 305068.01796412, -1551165.8297870678 305075.37169326935, -1551164.0151463726 305094.87972499896, -1551159.403790958 305104.8236628873, -1551152.0034091272 305125.529324593, -1551140.9375313339 305147.1115190983, -1551138.3834357106 305151.407352861, -1551132.4770448213 305162.06519517023, -1551121.2479007954 305178.21502217464, -1551107.2734389745 305196.57667400874, -1551105.21708611 305202.22519333754, -1551096.8127888513 305214.0077256793, -1551084.3532844917 305233.9179721512, -1551083.2508221178 305236.7154473327, -1551067.055873603 305255.2927849181, -1551064.1597449167 305257.4510386847, -1551046.5849642695 305279.7347973697, -1551044.1865752006 305283.24573937245, -1551027.49392987 305300.4703419665, -1551011.5773167973 305318.13910153974, -1550995.9942656097 305331.7277940633, -1550963.719528295 305362.5414789645, -1550946.4792876446 305380.74552942626, -1550936.8379724906 305390.07171342336, -1550935.7355250781 305392.86916520726, -1550921.3205348854 305406.7073150836, -1550902.8423394903 305422.45463619474, -1550882.4857036136 305440.55522039067, -1550871.578662892 305447.24657070637, -1550849.5775722507 305443.59943381883, -1550848.6807421523 305443.2798291892, -1550844.1197927247 305443.8363323221, -1550840.94630719 305446.90352999326, -1550838.1802030012 305469.26219096687, -1550839.3556023997 305489.8357638987, -1550840.2739261643 305501.7506790804, -1550847.6256180643 305525.70298669767, -1550862.8472774075 305551.28570849076, -1550864.7338176281 305555.14863256924, -1550863.1414649638 305576.91873291414, -1550855.7431010765 305597.6248039203, -1550848.1239375696 305616.07011786755, -1550837.7941034103 305632.53918566275, -1550830.7724656616 305640.6164442785, -1550815.355600799 305659.638461221, -1550790.8174478982 305686.8288708655, -1550780.7502892234 305697.01029694546, -1550762.33109582 305709.587710605, -1550742.0178364275 305719.1392832082, -1550727.0904486254 305719.18960277084, -1550713.236380836 305716.26483810786, -1550692.6385586867 305720.507461505, -1550689.7424895235 305722.66566257924, -1550682.6229477867 305742.46441455465, -1550675.2826191701 305760.0001959298, -1550666.1680145408 305767.3310661884, -1550652.8216033918 305771.9759927364, -1550641.5165111262 305779.70073286165, -1550632.3825630385 305796.5972784059, -1550626.8381829762 305811.77237315103, -1550624.8362210602 305817.2508891169, -1550617.1624261257 305838.86654617265, -1550611.6153322908 305857.0423294855, -1550608.7421561657 305870.797410381, -1550606.893730683 305873.32876911294, -1550606.4380694572 305877.53370240703, -1550597.9962782473 305897.86719682533, -1550596.3391133975 305902.4824615037, -1550589.7829664904 305926.680561482, -1550585.394883705 305938.88702199794, -1550576.2770942727 305961.16378600243, -1550573.9443680337 305967.7214768771, -1550562.3862056178 305987.9514672123, -1550551.6440600348 306000.0765136471, -1550542.085138946 306017.82870625705, -1550538.3735325672 306028.0931310132, -1550530.0812698673 306048.4804833317, -1550520.1798482079 306064.09605322033, -1550513.0056736716 306087.06499252655, -1550510.5836293201 306111.56132657547, -1550505.9343235148 306130.05691980384, -1550504.250164529 306138.0207659537, -1550503.0032049154 306161.92816470657, -1550500.9442009998 306182.52356381156, -1550497.1756126964 306195.95839902945, -1550486.9420915793 306215.6532892287, -1550484.2682152332 306220.07389818225, -1550482.5140632351 306236.4108042987, -1550481.1957790027 306258.10920921434, -1550479.3051412008 306269.1917133806, -1550473.4830249182 306288.27606491186, -1550466.0885465606 306308.98321068846, -1550462.035351151 306317.111389827, -1550452.6986886417 306337.1257572621, -1550446.795328762 306347.78431224264, -1550431.5033014799 306366.6828832356, -1550418.829923062 306384.33223662805, -1550402.2990454156 306400.7737392429, -1550398.9775346222 306403.78856699076, -1550388.96537513 306425.74524085317, -1550385.1986227646 306439.180824046, -1550378.5928742506 306451.6040583197, -1550371.199363443 306472.31148710754, -1550367.3665761177 306482.7011294104, -1550368.4900617127 306506.44554445706, -1550366.0060866755 306527.89642183855, -1550363.0548763843 306533.225875536, -1550357.3459563698 306545.9686459629, -1550349.7312124292 306564.41400364786, -1550342.6159920348 306584.2128617177, -1550337.6103924755 306595.19133102335, -1550325.103173799 306618.273785525, -1550313.3262740367 306636.24339178577, -1550302.0484685597 306655.5651494879, -1550298.8207988292 306661.8039322281, -1550290.9210228575 306674.94135270454, -1550283.6559359974 306694.68698036764, -1550281.2380653578 306719.18354113493, -1550274.012957371 306730.37810143176, -1550258.5303272784 306747.19380895793, -1550246.356666881 306766.1963193733, -1550234.8024563128 306786.4273063559, -1550230.1959730515 306796.3726596497, -1550221.7576621089 306816.7079325877, -1550218.4092091962 306823.0712185642, -1550211.4157962897 306842.7457201835, -1550208.6559010341 306865.1047136197, -1550207.4431282366 306874.24455718417, -1550197.21258929 306893.94013541564, -1550182.2009242338 306911.9306299975, -1550169.917817198 306922.3302583508, -1550165.1444284085 306941.7876115097, -1550161.0361542057 306953.08681691345, -1550157.4669094367 306957.18723350484, -1550147.4594428143 306964.1998457974, -1550142.0666325202 306982.4286738653, -1550131.782270411 306990.34928099345, -1550123.2349618566 307002.0807780316, -1550116.0656170966 307025.0509312013, -1550114.63028686 307046.8748859968, -1550124.742948879 307074.8323632572, -1550140.4696798644 307101.768661893, -1550153.1352842348 307125.43024757504, -1550166.559825688 307144.155449016, -1550182.2138143422 307168.88335289806, -1550196.8776312633 307190.066843858, -1550209.431878073 307220.0704465732, -1550219.3141126444 307239.54974173475, -1550232.2408612196 307256.9223388424, -1550242.6607741688 307269.2033595247, -1550244.9620216861 307277.4139511883, -1550245.8022415375 307295.85077806376, -1550260.973651487 307324.60561763775, -1550263.2201350029 307335.9865470184, -1550264.734531861 307352.48145912495, -1550263.7825297618 307355.33310595714, -1550265.1874341827 307363.2231927728, -1550271.0017693955 307385.4497194905, -1550279.146921341 307401.11808080506, -1550280.3201315026 307415.47606042307, -1550283.2959743107 307436.6893269988, -1550298.5234155667 307462.27328565717, -1550305.2636510555 307470.05155909434, -1550318.1902813069 307487.42631102353, -1550335.350345377 307507.4855538765, -1550349.366345927 307527.2632262707, -1550360.3499171352 307543.94477065094, -1550372.5462102941 307566.43213168345, -1550383.0481569758 307587.14108563587, -1550394.9575908808 307604.3198778359, -1550410.7782965484 307619.5357334148, -1550440.1054959283 307646.9592431439, -1550455.5288927248 307663.2089770315, -1550460.4755104927 307670.3480501855, -1550477.6072378713 307690.2300581662, -1550489.9695601158 307703.2051097341, -1550506.9638989088 307717.83259362634, -1550525.3456301186 307734.9705666397, -1550540.989761848 307753.48307351675, -1550557.446324659 307775.30870555714, -1550559.526246473 307781.2573176874, -1550563.85476534 307787.1674858555, -1550567.2182596049 307801.131530053, -1550570.233055839 307813.7956791064, -1550564.85979554 307837.4056360638, -1550559.2639562236 307858.75413295906, -1550557.3315846275 307879.2253565034, -1550554.6298904368 307898.4149820898, -1550555.21135905 307923.1415789807, -1550559.6210774137 307937.47915916983, -1550563.7812044155 307964.32286958676, -1550566.5816950833 307988.8341900967, -1550566.1107104004 308014.0258665355, -1550562.06018188 308037.09991377685, -1550562.6239034769 308041.50041951705, -1550559.332205037 308086.0069668973, -1550558.6844479488 308099.5464312546, -1550565.3961780423 308122.09476176463, -1550573.2098196102 308141.8446465647, -1550580.1715837277 308151.88602243084, -1550591.1562430053 308168.5691391593, -1550600.5699314843 308186.8744604811, -1550610.8499379293 308205.3221430471, -1550618.6635455515 308225.07198929135, -1550621.8909806788 308233.7809614362, -1550628.8247827732 308258.591500354, -1550634.6962667617 308277.6485608956, -1550641.4088196715 308300.19723271485, -1550643.1847473353 308310.4042744171, -1550644.2170704934 308319.0207168367, -1547931.02428742 308051.1388203427, -1545470.3584549273 307808.3172639571, -1545467.874791227 307804.55955665745, -1545465.4533268 307787.75021629874, -1545467.8673361337 307769.4708578754, -1545472.3517192078 307750.9203004036, -1545470.9340548366 307728.0893349396, -1545470.2799850588 307715.2662175046, -1545471.9046737175 307690.3275612211, -1545468.8428934019 307687.0565139903, -1545459.0008097575 307684.5638325615, -1545459.1696922625 307689.99653206766, -1545456.566485669 307697.464098067, -1545448.7828200073 307704.26540256944, -1545435.3540282722 307700.4983347496, -1545423.3137440088 307683.45886909496, -1545418.221319161 307671.0719283316, -1545417.43198407 307664.41268740036, -1545421.0195710275 307645.54256105796, -1545427.5009285845 307624.5134450123, -1545431.101841265 307611.8607328385, -1545431.0686389802 307600.2654513074, -1545438.3937389664 307582.7254514806, -1545445.09841818 307563.9566566404, -1545448.975698651 307550.39461997803, -1545451.2495005175 307547.0059666587, -1545454.304258055 307535.33439851925, -1545458.0616443865 307521.8973490903, -1545466.486089364 307501.55885323323, -1545473.2580722845 307485.83600556385, -1545480.7516585672 307473.7273110971, -1545492.0164179238 307454.3981155213, -1545502.4042562714 307440.1295156982, -1545516.3594189163 307421.7565336805, -1545522.9031628422 307412.5002341829, -1545535.907587616 307396.97920883074, -1545543.7457326264 307387.0076539712, -1545547.1114445478 307365.8764323881, -1545548.8187880337 307358.08970722556, -1545559.1872591136 307338.4422461102, -1545565.9796082433 307328.0985163124, -1545574.4050375323 307307.7602752084, -1545573.89253449 307300.1907331394, -1545568.0660729795 307277.97453299724, -1545568.3160257344 307256.7436068943, -1545569.6934975171 307253.03675175365, -1545583.6496454063 307234.6640453385, -1545603.8802242754 307222.88708510716, -1545607.669956469 307221.04487019405, -1545611.718421041 307212.91543958336, -1545611.6256519344 307189.54813827295, -1545621.7598407445 307161.4225247931, -1545629.7603980633 307141.93988371827, -1545637.9099880052 307122.50987363793, -1545644.9791925235 307111.2580661094, -1545657.1165280337 307095.5963009363, -1545660.227133718 307080.75385947805, -1545662.758377854 307071.0783027271, -1545667.7576434487 307060.0967813516, -1545675.7582431503 307040.6140417047, -1545687.5786181262 307019.4671590738, -1545696.5180021713 307006.6978188902, -1545711.7438471678 306990.95881401, -1545724.751152769 306975.43880789634, -1545720.953557631 306962.3375620283, -1545713.2454049925 306951.2031116672, -1545709.6175694072 306943.53296097834, -1545705.0864188385 306920.6015999671, -1545712.6178685292 306899.94481644407, -1545717.7795322828 306879.45212456584, -1545725.3109958651 306858.7952998001, -1545726.5385811657 306855.03526748344, -1545740.64663378 306836.7161938576, -1545748.653792479 306832.17725860886, -1545750.9820812168 306825.61826328095, -1545749.7960724928 306819.9917519344, -1545739.766857225 306806.68900884315, -1545734.676178156 306794.30251157377, -1545742.0577508172 306773.59249836206, -1545753.825593795 306755.6164687751, -1545769.3960723625 306742.01450728904, -1545788.3609670943 306727.6050552428, -1545799.5937140638 306716.82567012776, -1545812.0355699852 306696.9077219283, -1545816.427755371 306690.91488632094, -1545820.247561817 306689.2507275697, -1545825.5006208667 306692.12612773664, -1545829.8033393403 306697.8527197996, -1545835.3614367966 306699.9973465651, -1545838.8757492935 306699.0648541292, -1545845.3666056492 306692.97801162023, -1545847.8701376438 306683.12417255435, -1545845.1630987453 306661.00875558984, -1545850.6436136619 306646.0018846616, -1545847.413369725 306637.29908823594, -1545831.3067257372 306623.01048786566, -1545827.6788787872 306615.3402305972, -1545827.8163982993 306609.178286463, -1545845.4536168575 306580.36217799503, -1545853.7196120066 306569.5357698593, -1545859.7842024271 306564.3051104024, -1545863.3276501542 306563.55027002376, -1545878.838730826 306573.26304596104, -1545888.958344963 306574.8468959704, -1545902.5867454035 306560.55449460447, -1545904.9159634046 306553.9958636975, -1545905.1296390563 306550.1257702345, -1545905.8907844778 306536.37900048215, -1545909.9946992234 306525.07948076725, -1545910.9814519228 306513.6785673555, -1545906.0596122057 306506.72489259485, -1545891.1929279482 306494.89120198786, -1545885.147674394 306470.41374302097, -1545886.9648661711 306456.28659616597, -1545894.1268656976 306433.3153177649, -1545904.3498366314 306413.6147656683, -1545905.4514472783 306410.8162051635, -1545920.2831022567 306396.11195814516, -1545938.074584335 306382.2929556649, -1545944.1907888772 306358.9494360555, -1545944.1059499714 306350.5251263287, -1545951.669806277 306341.4632769283, -1545958.6321444514 306336.55250975955, -1545973.1865843567 306322.7570936326, -1545984.6514007181 306305.51234319154, -1545997.4671122518 306287.90894309897, -1545997.6857541236 306275.22820169013, -1545997.3199271911 306252.7696944503, -1546002.9873086174 306198.5440151179, -1546005.6297964049 306182.5274404045, -1546008.913932441 306138.032021557, -1546013.5392247117 306098.3770749718, -1546020.3050712429 306076.4397668084, -1546027.136390476 306057.54774957057, -1546032.950538495 306038.4621157851, -1546041.6604112142 306017.2159698764, -1546047.5040615683 306009.72462466266, -1546059.4501725526 305988.4543520361, -1546071.000008307 305968.21843057405, -1546075.9727038012 305945.64331473503, -1546075.681597594 305925.3937270669, -1546076.392913473 305914.9023160385, -1546078.5265630616 305891.31732143555, -1546078.3590696072 305885.88597523794, -1546080.2874707526 305865.41774813086, -1546084.929354969 305846.9222509861, -1546090.1511088202 305823.2608870743, -1546091.416972624 305810.95160844736, -1546094.1721088972 305803.5373721607, -1546100.9139646604 305796.36501407064, -1546104.456599166 305795.6096693063, -1546107.147519144 305796.56729843, -1546113.556771284 305793.4737629313, -1546117.1547423734 305789.54850470833, -1546119.5762503427 305771.27107573114, -1546120.7848736746 305747.18920358364, -1546121.7075614075 305732.7443261659, -1546123.4149415349 305710.0153998276, -1546125.246375745 305702.1039695507, -1546128.7036230604 305677.9833349772, -1546132.354143008 305655.9451297056, -1546137.2451128084 305636.3633169653, -1546137.779293423 305614.224160213, -1546137.2690729692 305606.65629293676, -1546133.0774004783 305594.58869375475, -1546116.6663313464 305569.615325843, -1546109.5234163702 305547.9365215879, -1546110.8999633924 305529.28720147815, -1546117.1685157248 305505.99811227806, -1546121.5239438452 305482.1963477675, -1546122.8737455136 305478.3110660324, -1546120.772747312 305452.0455251727, -1546115.9061431522 305441.92162447795, -1546102.9185736664 305427.73384144437, -1546099.15308072 305426.22772762086, -1546071.5247010805 305432.35361094866, -1546066.8619242322 305430.5288843084, -1546056.8809259012 305422.78238883056, -1546052.977055813 305416.0225028526, -1546048.7285039567 305392.1834658524, -1546052.8066285716 305369.29052961245, -1546055.3019280918 305353.2216281872, -1546063.4605203648 305333.79313027114, -1546064.6890691132 305330.0332800746, -1546072.4224108001 305326.4033209244, -1546080.1004213127 305325.9433347015, -1546089.2847130827 305320.8136764802, -1546092.4941729812 305309.19625382964, -1546088.1911849694 305288.52753537335, -1546085.5172015429 305278.00731913093, -1546082.538388764 305271.7441203743, -1546067.535129432 305254.6584592331, -1546056.3504041408 305247.3245783374, -1546049.2078391179 305225.6468919432, -1546047.458911484 305215.6233823169, -1546044.0351456923 305189.8957216302, -1546042.8498435281 305169.3273779955, -1546042.709952632 305149.1320642121, -1546045.8639126457 305125.74261768255, -1546051.0621823976 305105.42954801675, -1546053.7904626871 305097.83741725795, -1546068.1836472135 305078.6113624787, -1546071.5771485057 305062.86132670846, -1546068.3763750133 305054.3370174896, -1546053.9553009379 305047.02724907734, -1546047.8309573762 305040.4854504345, -1546038.895109443 305018.16993941646, -1546037.8601532234 304997.6559057422, -1546038.6724270473 304974.6099400893, -1546038.32951274 304957.53139946423, -1546032.6861638573 304932.0221126331, -1546026.7014071862 304904.3758589821, -1546015.5737436912 304882.4569934979, -1546011.3684615365 304870.6853086548, -1548201.073782978 304185.2231910387, -1550356.7368787616 303510.4734781161, -1550363.7170960794 303521.054102147, -1550374.8580471266 303543.1622798918, -1550405.0115862384 303589.008432704, -1550409.9560504002 303596.14479935635, -1550427.4531646734 303618.33500604145, -1550437.2231689761 303629.20656550955, -1550452.3649359462 303646.3585743336, -1550464.5045617376 303657.06697048526, -1550480.0960397848 303663.7992811594, -1550483.1556079364 303667.07341733575, -1550495.3150434855 303689.3770243572, -1550509.295075765 303712.4974950431, -1550525.2761950751 303733.14080421906, -1550543.449241092 303753.389700735, -1550560.3263098374 303774.35214907955, -1550575.7458146028 303790.5964659434, -1550586.3547157971 303804.9579754006, -1550602.8775526346 303818.4050963558, -1550612.7969504888 303829.3306645034, -1550628.5710470327 303853.0916445162, -1550646.4499022344 303882.9774959292, -1550658.0471876834 303900.882950373, -1550669.0258822185 303917.5602279473, -1550679.2710572695 303939.35046559945, -1550687.8558543175 303965.7558991881, -1550707.2954474108 303988.6401444236, -1550721.610572858 304007.6833949648, -1550732.9312953155 304026.4982896736, -1550740.278887617 304050.4473310439, -1550747.8761022906 304073.3092047535, -1550763.7995186767 304097.124098924, -1550805.453397572 304140.86181046255, -1550814.4313154551 304160.0174678499, -1550820.18726967 304170.46692165174, -1550825.9911446886 304192.6908689523, -1550828.2600981628 304204.2486750614, -1550828.328202833 304227.6172746029, -1550833.0153040043 304247.2589353807, -1550838.7562644777 304266.4370918479, -1550842.8238956688 304284.8501113998, -1550845.5112073438 304306.9706121953, -1550853.9854584846 304318.55696700886, -1550865.7352655604 304315.356851032, -1550877.9321064919 304322.8958153846, -1550882.0504391987 304331.9224691307, -1550878.8961263252 304346.5857037157, -1550873.9910691835 304366.16588572226, -1550873.7136753863 304367.0748943109, -1550869.3697036803 304391.0548502542, -1550863.0350864525 304402.5685067605, -1550853.5260222028 304417.14907593), (-1545729.3393619352 307358.1506063733, -1545722.9856982501 307358.07413562015, -1545712.0312854988 307367.94474960025, -1545710.0347014247 307370.42459243257, -1545708.6581077764 307374.1318858266, -1545706.8105482606 307376.6643779278, -1545703.0928578698 307380.71430959925, -1545684.2208438443 307383.4046140546, -1545661.2261475306 307376.2354796743, -1545653.2735179164 307377.6041179495, -1545647.1020299797 307389.17572712526, -1545644.5712410293 307398.85248932615, -1545645.1377086702 307403.25052886084, -1545645.2526121715 307411.8525513448, -1545651.2409120433 307424.5587077914, -1545651.4093382782 307429.9901356576, -1545649.7642439774 307449.5498955371, -1545649.283556924 307453.5762158446, -1545650.721520325 307461.6415287778, -1545656.5483497614 307483.858956716, -1545662.8138873612 307495.6562476102, -1545672.398168353 307504.4365658816, -1545676.3377928606 307502.6474946784, -1545685.77538527 307491.23001152463, -1545688.7766899744 307482.72897112835, -1545689.727457616 307479.8769954769, -1545691.1040461413 307476.1697207317, -1545694.469374364 307455.0394347012, -1545695.1115363021 307441.501802966, -1545700.9735385864 307419.2441032557, -1545717.7151298684 307405.05194757506, -1545722.5515545714 307403.5823636288, -1545730.6670078002 307392.7019694941, -1545735.5782632288 307373.2962046983, -1545734.79031233 307366.6364157479, -1545733.2979416894 307361.7412080355, -1545729.3393619352 307358.1506063733))";
		String p3 = "POLYGON ((-1550533.7806050605 312467.73443180695, -1550527.123036032 312477.1134495819, -1550516.6928764319 312494.54826033954, -1550512.203156268 312498.1516127251, -1550508.8617552496 312504.5154498117, -1550494.824689223 312519.6547246268, -1550479.0616166878 312537.20176318847, -1550469.0139560609 312547.38398147747, -1550445.236833662 312563.2449883502, -1550440.0074443251 312565.74369097874, -1550430.356153195 312574.8918033382, -1550421.8006064394 312589.9745451184, -1550415.1574401509 312605.57104026247, -1550405.2267860952 312624.3611960197, -1550401.8576562246 312630.54692041315, -1550391.84581141 312652.3304455625, -1550387.9524453958 312660.51292197686, -1550384.789532654 312683.73423418496, -1550380.7581592035 312706.81310906075, -1550379.3953604565 312725.471395229, -1550380.9480410826 312738.62101160735, -1550381.4732438226 312761.1443550056, -1550382.6282321562 312775.32847020496, -1550384.5171201744 312779.19400457013, -1550387.4563338992 312803.58654993866, -1550385.6150965397 312826.2717585927, -1550385.1648495565 312830.47816752084, -1550384.8572847098 312839.9407286281, -1550377.2132731518 312861.56167914346, -1550368.3750422553 312882.7567917071, -1550360.918702235 312895.0401315093, -1550351.633170038 312911.70876906347, -1550343.4754099154 312925.7567484593, -1550330.9854281212 312942.62429695576, -1550317.292812929 312959.90236639883, -1550309.517506194 312966.6979146339, -1550305.0569610216 312970.4788060216, -1550294.1145631361 312980.3421051828, -1550289.8333971084 313000.9807370007, -1550283.861992955 313023.36744080856, -1550272.8507714202 313051.1746955337, -1550261.8764172713 313069.5908519523, -1550248.5580940074 313089.18602684885, -1550234.023677288 313102.9725406887, -1550193.5786170377 313129.84081585705, -1550181.6436214512 313136.15904205665, -1550161.9110401596 313143.890825226, -1550158.6766073233 313143.91167538986, -1550145.3455376124 313148.5548812812, -1550121.3251528463 313165.5039032623, -1550103.490556343 313167.5320735853, -1550084.0339949029 313174.35565237235, -1550068.6560027718 313184.649800146, -1550048.4755052857 313196.58792740107, -1550030.9608551583 313204.10423117783, -1550020.4683567714 313209.7619830612, -1550001.0280434645 313201.8135954123, -1549990.1249934176 313193.554013839, -1549985.7179277458 313194.1634893399, -1549976.7046618895 313189.769810006, -1549969.1395779087 313183.8779666368, -1549960.6042685746 313175.4560313672, -1549956.4731776046 313175.1573068714, -1549944.261824494 313182.38463615533, -1549926.2167239797 313197.1010511508, -1549914.745372927 313214.1638849601, -1549911.1294802697 313221.4374835091, -1549910.4939611023 313234.9811966028, -1549912.8545507707 313240.021748947, -1549915.2954209214 313242.0685457224, -1549922.3825436214 313251.98861446604, -1549938.9617595284 313262.27455841564, -1549946.123342287 313274.4033468552, -1549946.6905981784 313278.8047272675, -1549938.0573430208 313296.88068876415, -1549930.072522839 313316.36471405346, -1549930.004255055 313334.3097470682, -1549937.9053517946 313356.2748537678, -1549942.4971307826 313376.0507443594, -1549941.2943481507 313385.19301539194, -1549940.345162346 313388.04523335304, -1549942.6383548696 313411.03119744733, -1549944.5634288862 313435.22836216446, -1549943.0707007125 313460.0528610498, -1549939.5971003694 313472.5832488686, -1549922.345513642 313493.96348447725, -1549910.7323942408 313505.77054376155, -1549892.7408538905 313517.31535639334, -1549868.454297391 313525.60468149744, -1549853.6603793954 313525.52733371407, -1549827.6860121153 313526.8330541877, -1549816.9157377705 313542.13189000357, -1549806.7149685754 313561.8320545824, -1549803.5285610957 313570.59346923884, -1547805.1117430378 313101.3109630756, -1545162.0946185626 312480.80198184866, -1545161.9140527088 312477.7962833727, -1545162.9406548971 312463.2216065191, -1545168.7295480154 312444.1316090757, -1545175.984684451 312429.75869724713, -1545194.4522767256 312414.1730183, -1545204.5464800035 312400.81119114533, -1545204.9522837778 312385.00877514295, -1545207.7201188442 312374.24249632657, -1545198.409683433 312364.55025377125, -1545174.47470007 312360.22856124677, -1545150.1182745607 312351.5614469703, -1545143.8419368768 312344.96310024895, -1545139.3733302145 312319.03168450575, -1545138.5787234323 312312.37095840555, -1545133.1017578933 312307.2319058804, -1545123.3420725765 312293.0161694819, -1545121.0821236272 312281.6365364315, -1545120.9691730367 312258.26288719755, -1545119.8995842626 312252.51080428995, -1545116.3180738862 312241.6672249837, -1545103.747972535 312226.6188767534, -1545094.5573743004 312216.80165350065, -1545076.454240221 312204.987888501, -1545068.4127133437 312197.92996498756, -1545048.6182585375 312179.13597469125, -1545033.4562517465 312161.989815657, -1545027.8058878842 312151.41903831623, -1545027.0117154436 312144.7573911613, -1545028.538758757 312131.53609121963, -1545035.0014949276 312110.5022261366, -1545042.1132731691 312090.8754335474, -1545048.0242703327 312071.6601800937, -1545052.6662838806 312058.5394894667, -1545053.866202366 312049.3985609012, -1545048.3179111972 312032.48419945594, -1545045.591779269 312010.3628112534, -1545046.6695970015 311992.6178859323, -1545049.5186704819 311978.8595255334, -1545058.6480620296 311953.4030610677, -1545064.6116576372 311939.7462146161, -1545077.098454279 311922.8707286259, -1545086.5732421828 311908.28042834066, -1545101.829643236 311889.36830153037, -1545108.8111856526 311875.9054830037, -1545111.6602877541 311862.14704337623, -1545112.221181165 311836.83160189074, -1545111.9566497537 311822.97205513995, -1545108.4550479173 311800.4078001324, -1545106.1768459275 311774.08119425643, -1545102.6061686429 311748.47051166464, -1545099.2774653172 311731.33890732937, -1545089.3972945395 311717.24879772216, -1545083.8507465606 311700.3351302538, -1545071.0385099666 311668.07839371637, -1545065.819521563 311647.0855540829, -1545053.0763119354 311626.6042406792, -1545049.168026858 311619.8422726998, -1545029.598348304 311603.31116735935, -1545021.5584780606 311596.2540602572, -1545008.0627709157 311580.7097099526, -1544990.6314287772 311566.95351900253, -1544968.4232892818 311546.2952858275, -1544963.0721801496 311540.1948299529, -1544948.7323237187 311521.16052252706, -1544930.6566224985 311500.79787479993, -1544924.4088029347 311494.3779373178, -1544916.4709446817 311480.97939991206, -1544909.2060645297 311465.6367448, -1544901.665292598 311451.20455174986, -1544899.7515319586 311441.9623475084, -1544897.6982444345 311417.89861952513, -1544894.6748420554 311391.30846769083, -1544894.6119538096 311390.78249691334, -1544891.5006491062 311364.66473362874, -1544890.0864899065 311356.7756336555, -1544891.149979062 311332.813351986, -1544892.4828000995 311308.78005726915, -1544895.384441153 311291.85080208257, -1544899.5798871121 311274.20735743456, -1544899.6428387093 311256.2683316283, -1544895.0962499576 311233.33199275285, -1544887.1187680115 311199.6074894918, -1544882.1763908318 311177.7065661736, -1544876.9172481645 311145.1176143447, -1544876.945895302 311136.5669140043, -1544882.0376222208 311119.241487409, -1544888.056074082 311102.4136097189, -1544891.131081095 311082.1891440144, -1544892.2801838925 311076.2192954719, -1544898.074014778 311057.1295317672, -1544904.063358901 311040.12397469394, -1544916.0134248934 311019.02708589844, -1544926.8360759318 311000.5509620309, -1544929.1065276633 310997.1624289593, -1544944.0513067238 310967.5626824396, -1544950.8631209666 310948.6668797191, -1544959.271973006 310928.3253333913, -1544965.1184408346 310906.06487186346, -1544965.2865872504 310881.7844355069, -1544964.7469928705 310868.83532893565, -1544961.0988825585 310846.21901653334, -1544955.0482036658 310806.9689806383, -1544956.4228409517 310803.2613871461, -1544955.337120787 310782.563919954, -1544957.293072799 310768.48718071915, -1544956.4475976825 310764.9975574976, -1544958.5464734104 310756.1756357411, -1544960.0084356735 310731.18085127976, -1544961.1063157872 310728.38105414156, -1544963.838640341 310706.02025433816, -1544964.695828667 310694.74281522725, -1544968.72154603 310671.66643401515, -1544970.832143068 310648.07737489324, -1544972.668646284 310625.3974685306, -1544973.3262533105 310615.2210359145, -1547730.6666362272 310743.6472122539, -1550203.4556147933 310858.94460596517, -1550208.0531783353 310873.9189187614, -1550209.3541992316 310888.15401299857, -1550221.185945876 310908.33131521195, -1550223.7678794356 310915.63388731424, -1550226.3296739983 310917.5562929269, -1550230.4015667557 310929.7574306475, -1550222.3454579208 310937.4620309109, -1550214.342784884 310941.9949502805, -1550198.507032222 310956.4949520221, -1550199.221410664 310981.10108227935, -1550209.0568329357 311003.7567980476, -1550217.0922217604 311010.82329187915, -1550230.266811781 311015.69253369514, -1550244.0329936729 311021.6142531233, -1550252.1297416312 311040.4586750055, -1550254.9679777531 311041.4718942102, -1550261.4006852175 311038.56141927745, -1550267.9734143442 311040.9083404811, -1550281.9073862417 311052.26331336517, -1550291.6358780786 311081.26234255545, -1550307.1485869305 311105.9449257953, -1550309.710822756 311107.86643984914, -1550322.6078391233 311133.7991576409, -1550325.9585578 311142.38401454594, -1550341.5781122549 311160.72326189745, -1550359.8419756263 311177.99090409, -1550362.9032106278 311181.2666054731, -1550366.6376910727 311182.6003152812, -1550371.7809051357 311191.8261325611, -1550376.9859023246 311212.8289195569, -1550381.5428801663 311232.42484163307, -1550389.4995094023 311246.0140561629, -1550392.3377318247 311247.02728426363, -1550412.2249459 311259.50088158716, -1550424.1642952356 311273.33520993125, -1550442.3119846308 311281.9970944831, -1550463.0757749774 311289.41020460986, -1550465.4885307823 311291.279945923, -1550467.3770474703 311295.1443370776, -1550477.1791637817 311306.20153798535, -1550484.7098574273 311320.64591546915, -1550487.6350688168 311330.0872526271, -1550481.7770246167 311352.34750757087, -1550473.2167773957 311367.4288821379, -1550458.2786494165 311382.2485655965, -1550440.6226848867 311395.9291390367, -1550442.7880841978 311398.88568839803, -1550443.3535433586 311403.2865174934, -1550441.0483392829 311415.2262701951, -1550443.3819473537 311423.61733579356, -1550445.9441606703 311425.5388466874, -1550463.632774374 311423.45753919426, -1550468.2639369024 311425.11085322965, -1550469.3091954503 311425.48400511127, -1550472.9367508572 311433.16097610164, -1550470.408538486 311442.8382614972, -1550453.1985750264 311461.0459256163, -1550450.926279187 311464.4326230567, -1550446.6673217602 311485.24800941814, -1550447.0733179094 311499.16412813496, -1550448.2795672151 311510.17509928066, -1550454.3816229051 311531.49860724714, -1550460.2072210275 311553.73126505315, -1550459.7560670911 311557.937449825, -1550460.8979506018 311581.6888350332, -1550461.8174365612 311588.41799350176, -1550464.1083399702 311605.1706626443, -1550465.5179303652 311613.06311019696, -1550467.1301588118 311637.99008038733, -1550466.8829863784 311659.2303253077, -1550468.0152349751 311668.0314618144, -1550472.9742725634 311710.27591560036, -1550478.0449275693 311737.44477797486, -1550489.373932757 311765.0016472684, -1550496.7694193714 311785.6117839385, -1550496.318718491 311789.81703960523, -1550501.0459895013 311814.84927172307, -1550508.867355134 311834.6042347448, -1550520.371022711 311858.8640473066, -1550524.9569447907 311878.63942232355, -1550529.9606404072 311902.762432375, -1550530.1115708223 311922.9692515796, -1550529.708710936 311944.99389675166, -1550530.0291793763 311970.63465096895, -1550530.8719602022 311974.1266957326, -1550529.0461058512 311982.03947045654, -1550528.0243488678 312002.8348837225, -1550527.1481883388 312007.8965816628, -1550526.692762317 312033.0931538744, -1550522.853369847 312058.25656949077, -1550513.763994395 312080.5374633223, -1550510.7468607826 312103.81157838926, -1550516.8501196143 312125.1364469258, -1550528.010346438 312147.2594917286, -1550530.3161390703 312155.47227130644, -1550532.0126370867 312177.40574434586, -1550537.8838685264 312226.1906757783, -1550541.4940715106 312248.63965657353, -1550547.3595342382 312261.4830607278, -1550554.4802329135 312283.00290160254, -1550558.7914182818 312303.688018064, -1550553.865590182 312346.60064176284, -1550553.4644942645 312368.62582043465, -1550553.4424766365 312392.1300835153, -1550551.7306339918 312429.6404792238, -1550551.3042908807 312430.4964868333, -1550548.8065355935 312440.3527855966, -1550539.8923619569 312459.33773030806, -1550533.7806050605 312467.73443180695))";
		
		Polygon polygon = (Polygon)reader.read(wb);
		
		ArrayList<LineString> lines = new ArrayList<>();
		ArrayList<Polygon> polys = new ArrayList<>();
		
		lines.add((LineString)reader.read(line1));
		lines.add((LineString)reader.read(line2));
		lines.add((LineString)reader.read(line3));
		lines.add((LineString)reader.read(line4));
		
		polys.add((Polygon)reader.read(p1));
		polys.add((Polygon)reader.read(p2));
		polys.add((Polygon)reader.read(p3));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, polys, lines);
		Collection<ConstructionPoint> pnts = pg.getPoints();
		
		ArrayList<ConstructionPoint> expected = new ArrayList<>();
		expected.add(new ConstructionPoint(new Coordinate(-1548057.2939982228,308063.6058185636),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-1545116.6724219415,309802.54312652536),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550350.7992721763,310568.503093807),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1545442.1426244352, 308000.2138310028),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1545130.1527877913,310213.90950570535),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550653.227175346,308615.6164732883),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550790.4972609133,309653.47135985456),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550228.246048949, 310377.98523211945),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1545366.9223517894,308218.3907535542),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550813.5321511407,308946.0723840734),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550302.32115557,310111.8404649761),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-1547588.3938290146,310737.0206989875),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(-1544989.7215381619,308939.38913954794),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-1550275.0184973506,310717.4553442793),NodeType.BANK,FlowDirection.INPUT, null));
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		ArrayList<Polygon> expectedWbs = new ArrayList<>();
		expectedWbs.add((Polygon)reader.read("POLYGON ((-1545116.6724219415 309802.54312652536, -1545112.5946045234 309790.3494273452, -1545112.4516952015 309785.0943820588, -1545107.6031145942 309771.61978491675, -1545096.7550033492 309755.00362776313, -1545091.8538207298 309744.6997368522, -1545083.6428856107 309732.21139883343, -1545081.7308538663 309722.9694720451, -1545079.0116535418 309700.85194717254, -1545079.8051569925 309677.8003387805, -1545080.942729586 309656.8865895644, -1545081.4732678703 309649.6885837978, -1545079.7854078768 309642.7095025331, -1545080.6970137092 309628.26172239706, -1545077.6741440925 309606.87435172684, -1545070.6667133525 309585.2458904423, -1545060.4224625353 309563.64094531536, -1545052.0929222077 309542.5495291501, -1545046.2585472374 309520.3313085083, -1545035.8153333254 309493.11596477125, -1545033.4540076086 309488.07979703136, -1545030.444037849 309481.6377541479, -1545025.2430086643 309475.5913774697, -1545018.825947958 309463.741031982, -1545011.6473067878 309436.6801866973, -1544999.2906484252 309408.953044286, -1544991.6345021254 309385.9185843896, -1544991.0011226889 309369.7466492243, -1544991.5316480559 309362.5485653216, -1544992.481435401 309359.69639646634, -1544992.0626072444 309355.35182338394, -1544996.6990414748 309327.28763457667, -1544996.8881328104 309309.2253440581, -1545000.9645975337 309271.56227363367, -1545004.3744642562 309247.2602692591, -1545003.5186805548 309228.82624147274, -1545000.1954880496 309211.69709701836, -1544999.8509570467 309209.56007178966, -1544998.852677474 309185.8721977733, -1544996.8446049562 309173.40800454747, -1544998.4627515334 309148.4678424252, -1544998.0005323775 309137.72811427154, -1544995.6271227133 309117.74671172816, -1544994.2151095134 309109.85917255376, -1544997.155363343 309084.38185407687, -1544998.8482447732 309061.6505302191, -1544998.2475339987 309036.9278612165, -1544999.2494610974 309030.90573500656, -1544995.9797252852 309010.60611002985, -1544992.6043584403 308996.6489791041, -1544987.083969977 308985.11793772224, -1544987.6315380423 308963.15434524044, -1544989.7215381619 308939.38913954794, -1544988.087108785 308929.23952195887, -1544991.563438445 308916.7103273608, -1545005.263960927 308899.4233375862, -1545016.6630248297 308885.3466740642, -1545026.2547354216 308864.417063958, -1545036.2183362725 308845.8012245372, -1545046.1011200014 308830.1790102655, -1545056.3770414754 308822.24991447665, -1545068.5004182477 308811.7885123445, -1545083.4418691066 308796.95663062297, -1545091.4993656527 308789.2464828873, -1545107.9575769063 308775.9614447905, -1545127.3907564206 308757.5230209613, -1545137.4438605972 308747.33273956925, -1545141.2334231967 308745.49070266634, -1545148.1178415415 308738.3702856479, -1545151.9074057345 308736.52824802883, -1545156.175365116 308730.6601149542, -1545164.2328921298 308722.94994121976, -1545171.3633713368 308717.9970347611, -1545178.298439666 308713.1787638515, -1545193.7404971123 308699.7005310338, -1545206.6338459908 308690.5195494937, -1545222.7489435726 308675.0991679467, -1545237.6914031636 308660.26763730776, -1545247.7445656883 308650.07730531506, -1545261.64081 308634.8745086361, -1545274.6398492462 308619.3531012377, -1545285.793654824 308606.36403115746, -1545291.9082383013 308597.9630718054, -1545302.8245300786 308576.4960536519, -1545312.7083829904 308560.87407162227, -1545327.0309432014 308544.8150608875, -1545329.6995831907 308540.39276881237, -1545347.1917751234 308521.264290683, -1545356.732028312 308503.5056214286, -1545356.7855304263 308500.33518611453, -1545359.0583855016 308496.94624160416, -1545361.8871062656 308483.01128216553, -1545367.2451459698 308459.4004751984, -1545368.4699520355 308435.4950615028, -1545375.8448350755 308414.7834906578, -1545376.1008625366 308408.4952436993, -1545373.1102579143 308387.2871101955, -1545373.492271908 308380.03738962114, -1545376.9179295816 308370.67965824064, -1545383.1546973486 308362.1536151767, -1545377.4405872023 308348.53866940644, -1545360.063660072 308331.6153115062, -1545351.6314331903 308316.8660367569, -1545349.7069256646 308301.4089932032, -1545359.6457070368 308282.615895208, -1545365.1200449963 308267.6083666552, -1545368.0760747201 308232.5668883985, -1545366.9223517894 308218.3907535542, -1545366.6995034148 308216.12954063155, -1545363.0694964565 308208.4597626468, -1545359.7702301021 308196.7107020868, -1545346.0209686602 308167.3125317618, -1545344.097339832 308151.85585368983, -1545346.1473618771 308146.20563127473, -1545343.3318978825 308121.7027153587, -1545342.3673857334 308118.338178142, -1545339.9782303122 308113.12365280744, -1545338.9310411667 308092.60737203807, -1545346.147237168 308081.4078591829, -1545353.9834253495 308071.43575172685, -1545373.270711216 308052.94533645734, -1545386.8930846346 308038.6513404297, -1545416.5556860282 308015.45641052723, -1545420.0689804815 308014.52355922665, -1545422.0655132385 308012.0437999852, -1545442.1426244352 308000.2138310028, -1545459.2535032975 307988.33599348646, -1545469.4705446723 307968.6342384042, -1545479.4634088823 307946.67165802326, -1545486.59297732 307927.0474376315, -1545494.867017132 307906.65487552993, -1545503.1203023603 307880.8840620294, -1545509.770567317 307865.2855858896, -1545531.2916199826 307852.79429301526, -1545529.154867526 307850.0199469514, -1545508.7778519685 307841.5989743769, -1545496.9198359363 307836.2073844243, -1545481.6555280138 307825.40760472976, -1545470.3584549273 307808.3172639571, -1547931.02428742 308051.1388203427, -1548057.2939982228 308063.6058185636, -1550644.2170704934 308319.0207168367, -1550646.1077511846 308334.7916590972, -1550646.9492788133 308338.2823868776, -1550646.357873716 308363.599617593, -1550644.4994677838 308386.2804949209, -1550640.2281251752 308407.0937104691, -1550629.0125078717 308423.2449821476, -1550607.8310644375 308437.85503997933, -1550583.7559716655 308454.6251898892, -1550580.2429211137 308455.5546207754, -1550578.2455868872 308458.0329762455, -1550573.281936098 308460.4609382432, -1550564.3954043014 308470.05341305956, -1550566.8198400664 308493.08763636276, -1550574.568728504 308509.79115930013, -1550585.8854379146 308522.3950403137, -1550596.4814415034 308531.38144554384, -1550599.7640939315 308536.91921936814, -1550613.9852160818 308553.5820107041, -1550626.7914797135 308571.0835741507, -1550638.822231178 308588.1401026817, -1550653.227175346 308615.6164732883, -1550668.2893212289 308635.77083380055, -1550681.0955432337 308653.2723797634, -1550693.3745155085 308669.24239712954, -1550704.8978806315 308693.676243132, -1550718.8041618012 308719.79958970845, -1550728.0690939322 308738.0533054536, -1550737.427790116 308759.5307582766, -1550747.0347390305 308779.9217111822, -1550760.526277638 308801.6995219756, -1550771.3616922144 308818.32970963605, -1550783.5591691472 308840.82172299735, -1550790.9757387459 308861.6063628318, -1550800.5278233762 308885.1696774736, -1550805.022531696 308907.93488806766, -1550808.7048338905 308927.3870816147, -1550813.7359687292 308942.954885507, -1550813.5321511407 308946.0723840734, -1550815.2714829168 308964.83133364376, -1550806.2978225385 308989.9658092186, -1550801.1776844985 309004.3070958201, -1550805.0248500293 309014.2456242535, -1550812.7270565527 309025.3920165412, -1550820.1992677595 309043.0068329908, -1550822.807132294 309061.9081096342, -1550829.2181587387 309088.71598431934, -1550833.0390738111 309113.4241035115, -1550838.8015964415 309138.82585563324, -1550838.0641809932 309164.0901250271, -1550837.7901135518 309179.9475156497, -1550839.4468433233 309201.70057185274, -1550842.0289677677 309223.9517634306, -1550843.158551501 309232.7524267547, -1550843.466446199 309258.3897611238, -1550840.4382928456 309281.6613174854, -1550839.9046956713 309303.80798589904, -1550837.9654978435 309318.06237217784, -1550838.807423808 309321.5543284677, -1550835.8880110853 309338.4829012472, -1550829.4012444795 309359.51225716434, -1550827.6924780076 309367.29961415846, -1550820.5324240092 309390.27109948266, -1550814.516040916 309412.4761391701, -1550811.9570169155 309425.50294180214, -1550811.5165600148 309435.9260825021, -1550808.3398737346 309459.1438960051, -1550808.1210706555 309471.83010086976, -1550807.1989841869 309486.2803361304, -1550804.4482260572 309508.6428595595, -1550799.754533419 309530.3121432187, -1550797.6485035247 309539.13322438765, -1550794.897753547 309561.4956948506, -1550792.9046513538 309578.9226877168, -1550796.1622957138 309599.23141333647, -1550796.5637667 309613.14639221784, -1550790.4972609133 309653.47135985456, -1550786.0087466568 309672.02266461495, -1550777.9795188461 309691.32517306414, -1550771.038771454 309701.6115835393, -1550760.1707770457 309719.90169979166, -1550755.2264403207 309727.70945043024, -1550741.892150835 309747.3015741734, -1550727.540333641 309766.69861066993, -1550723.3249965627 309769.39238554426, -1550706.7260455196 309788.82733358257, -1550700.2656090967 309795.0870708702, -1550683.5280269976 309809.26610221155, -1550652.8869751908 309823.688788373, -1550650.8901530085 309826.16607619636, -1550639.1812107533 309840.9646512959, -1550633.594025596 309862.31445515994, -1550626.2681802136 309879.85276912246, -1550619.3818592227 309886.9676992856, -1550588.740901373 309901.3903275281, -1550568.154943325 309905.63155495934, -1550548.1232634608 309908.05388699286, -1550528.6561743561 309914.87686070707, -1550501.0175160158 309920.79907570407, -1550489.898055429 309925.22736472636, -1550468.9148731506 309930.5023753615, -1550445.1598528621 309937.8109888686, -1550414.3986684643 309952.35950197745, -1550392.382360813 309963.4795567887, -1550380.2176384244 309967.5346960211, -1550373.1092602513 309972.38746872544, -1550354.0147220923 309981.52704274096, -1550338.57180289 309994.9931328958, -1550334.1818301596 310000.98411193304, -1550326.581034943 310019.4310665671, -1550327.9337130492 310030.49395772815, -1550333.5213340307 310044.24435709044, -1550342.9921123537 310059.37978180964, -1550351.815739523 310073.10875201225, -1550358.3347420795 310078.626141103, -1550368.3657607506 310083.21377870254, -1550346.1205130413 310100.8022987433, -1550336.3968799547 310106.9043781208, -1550319.1023176424 310107.9532852229, -1550302.8053644442 310111.70932523906, -1550302.32115557 310111.8404649761, -1550287.5541407333 310115.83985975385, -1550278.4320085295 310117.78997189365, -1550271.3779977337 310119.47137237433, -1550251.49751232 310157.0479598297, -1550248.6713704476 310162.2528628381, -1550236.169966339 310179.1195867462, -1550226.681098848 310193.70320642553, -1550222.4720233467 310211.3461086657, -1550222.6182450836 310231.5506118024, -1550221.975492315 310245.09242457245, -1550226.2817429085 310265.7740488015, -1550225.3058745111 310303.54725674074, -1550225.1437986235 310313.06163096894, -1550226.8281545148 310320.044313618, -1550227.034861951 310352.0265226569, -1550228.246048949 310377.98523211945, -1550230.5305345927 310380.8164162589, -1550230.9756857874 310385.34104459174, -1550244.8887366885 310411.466263799, -1550260.933167704 310428.94885267597, -1550265.733132034 310436.03597623017, -1550268.512709727 310439.32138400245, -1550279.9850096982 310452.8776008971, -1550293.6628516293 310470.5222102478, -1550309.430792185 310488.9140034048, -1550318.9284780475 310500.70117841195, -1550331.1305452012 310523.19307850953, -1550345.968414649 310549.8172632223, -1550350.7992721763 310568.503093807, -1550353.5297662262 310575.85932999104, -1550355.786580974 310602.19234971516, -1550354.611890139 310622.9330769107, -1550349.7834190323 310639.34732736833, -1550344.8737505586 310658.7552019702, -1550336.6011319994 310679.1454257015, -1550333.4517586192 310687.59377741534, -1550330.2827156559 310690.6610130407, -1550329.1826549887 310693.46001543105, -1550318.510343629 310702.41355196014, -1550294.7589272151 310709.7221938921, -1550275.0184973506 310717.4553442793, -1550273.1374317394 310728.5393366078, -1550279.0153482978 310747.5990738021, -1550295.2540075318 310767.1654908452, -1550295.6452540986 310774.8626484703, -1550285.1551295759 310795.46966322046, -1550282.2625512325 310797.6276875194, -1550276.275834783 310805.0632230649, -1550259.3193826184 310816.98078256287, -1550241.9379342536 310829.7539721541, -1550233.8809156814 310837.4581605643, -1550220.9040690407 310838.2003014721, -1550210.063128397 310841.72003416345, -1550202.1466043103 310854.6807594467, -1550203.4556147933 310858.94460596517, -1547730.6666362272 310743.6472122539, -1547588.3938290146 310737.0206989875, -1544973.3262533105 310615.2210359145, -1544974.078489249 310603.57225288264, -1544974.6441776673 310578.2591666989, -1544977.8027466512 310555.04216154106, -1544980.954338859 310537.0269071087, -1544984.1120257636 310513.8094049543, -1544987.413524862 310495.8472189782, -1544990.5651252915 310477.8319164412, -1544998.3563585887 310456.26263293717, -1545017.3988834198 310415.3628538707, -1545025.810991898 310395.0212649405, -1545028.1331858598 310388.4615441449, -1545042.6955373222 310371.31500434317, -1545057.2856823043 310354.34651910514, -1545067.5885846897 310337.867574621, -1545077.518310103 310319.07315477636, -1545082.059768928 310312.29496334214, -1545098.6463582916 310292.8469624603, -1545104.309631561 310279.9219661597, -1545104.362226682 310276.7513189679, -1545111.7286679507 310256.0374533739, -1545119.2445642443 310235.377559023, -1545130.1527877913 310213.90950570535, -1545139.6332965195 310199.32068117615, -1545153.6728899013 310154.4584100852, -1545161.4364926745 310132.71070681326, -1545169.177060227 310114.3126327414, -1545175.319219321 310097.36076983996, -1545178.6070312385 310073.18231055513, -1545184.1809508575 310051.8319548052, -1545190.3761814258 310031.7084685182, -1545194.0071783403 310009.66733920295, -1545195.381863599 310005.9596026819, -1545197.220287623 309983.2799286023, -1545195.7950349986 309960.44611711986, -1545193.9351839828 309948.03444731794, -1545190.716005053 309924.56252154894, -1545179.0308347826 309894.89056677, -1545170.1986618263 309881.1731286952, -1545154.5679805854 309862.8560557198, -1545140.9249409505 309847.2604841776, -1545130.3523068621 309829.73470599484, -1545118.5101733825 309809.5752732996, -1545116.6724219415 309802.54312652536))"));
		expectedWbs.add((Polygon)reader.read("POLYGON ((-1550533.7806050605 312467.73443180695, -1550527.123036032 312477.1134495819, -1550516.6928764319 312494.54826033954, -1550512.203156268 312498.1516127251, -1550508.8617552496 312504.5154498117, -1550494.824689223 312519.6547246268, -1550479.0616166878 312537.20176318847, -1550469.0139560609 312547.38398147747, -1550445.236833662 312563.2449883502, -1550440.0074443251 312565.74369097874, -1550430.356153195 312574.8918033382, -1550421.8006064394 312589.9745451184, -1550415.1574401509 312605.57104026247, -1550405.2267860952 312624.3611960197, -1550401.8576562246 312630.54692041315, -1550391.84581141 312652.3304455625, -1550387.9524453958 312660.51292197686, -1550384.789532654 312683.73423418496, -1550380.7581592035 312706.81310906075, -1550379.3953604565 312725.471395229, -1550380.9480410826 312738.62101160735, -1550381.4732438226 312761.1443550056, -1550382.6282321562 312775.32847020496, -1550384.5171201744 312779.19400457013, -1550387.4563338992 312803.58654993866, -1550385.6150965397 312826.2717585927, -1550385.1648495565 312830.47816752084, -1550384.8572847098 312839.9407286281, -1550377.2132731518 312861.56167914346, -1550368.3750422553 312882.7567917071, -1550360.918702235 312895.0401315093, -1550351.633170038 312911.70876906347, -1550343.4754099154 312925.7567484593, -1550330.9854281212 312942.62429695576, -1550317.292812929 312959.90236639883, -1550309.517506194 312966.6979146339, -1550305.0569610216 312970.4788060216, -1550294.1145631361 312980.3421051828, -1550289.8333971084 313000.9807370007, -1550283.861992955 313023.36744080856, -1550272.8507714202 313051.1746955337, -1550261.8764172713 313069.5908519523, -1550248.5580940074 313089.18602684885, -1550234.023677288 313102.9725406887, -1550193.5786170377 313129.84081585705, -1550181.6436214512 313136.15904205665, -1550161.9110401596 313143.890825226, -1550158.6766073233 313143.91167538986, -1550145.3455376124 313148.5548812812, -1550121.3251528463 313165.5039032623, -1550103.490556343 313167.5320735853, -1550084.0339949029 313174.35565237235, -1550068.6560027718 313184.649800146, -1550048.4755052857 313196.58792740107, -1550030.9608551583 313204.10423117783, -1550020.4683567714 313209.7619830612, -1550001.0280434645 313201.8135954123, -1549990.1249934176 313193.554013839, -1549985.7179277458 313194.1634893399, -1549976.7046618895 313189.769810006, -1549969.1395779087 313183.8779666368, -1549960.6042685746 313175.4560313672, -1549956.4731776046 313175.1573068714, -1549944.261824494 313182.38463615533, -1549926.2167239797 313197.1010511508, -1549914.745372927 313214.1638849601, -1549911.1294802697 313221.4374835091, -1549910.4939611023 313234.9811966028, -1549912.8545507707 313240.021748947, -1549915.2954209214 313242.0685457224, -1549922.3825436214 313251.98861446604, -1549938.9617595284 313262.27455841564, -1549946.123342287 313274.4033468552, -1549946.6905981784 313278.8047272675, -1549938.0573430208 313296.88068876415, -1549930.072522839 313316.36471405346, -1549930.004255055 313334.3097470682, -1549937.9053517946 313356.2748537678, -1549942.4971307826 313376.0507443594, -1549941.2943481507 313385.19301539194, -1549940.345162346 313388.04523335304, -1549942.6383548696 313411.03119744733, -1549944.5634288862 313435.22836216446, -1549943.0707007125 313460.0528610498, -1549939.5971003694 313472.5832488686, -1549922.345513642 313493.96348447725, -1549910.7323942408 313505.77054376155, -1549892.7408538905 313517.31535639334, -1549868.454297391 313525.60468149744, -1549853.6603793954 313525.52733371407, -1549827.6860121153 313526.8330541877, -1549816.9157377705 313542.13189000357, -1549806.7149685754 313561.8320545824, -1549803.5285610957 313570.59346923884, -1547805.1117430378 313101.3109630756, -1545162.0946185626 312480.80198184866, -1545161.9140527088 312477.7962833727, -1545162.9406548971 312463.2216065191, -1545168.7295480154 312444.1316090757, -1545175.984684451 312429.75869724713, -1545194.4522767256 312414.1730183, -1545204.5464800035 312400.81119114533, -1545204.9522837778 312385.00877514295, -1545207.7201188442 312374.24249632657, -1545198.409683433 312364.55025377125, -1545174.47470007 312360.22856124677, -1545150.1182745607 312351.5614469703, -1545143.8419368768 312344.96310024895, -1545139.3733302145 312319.03168450575, -1545138.5787234323 312312.37095840555, -1545133.1017578933 312307.2319058804, -1545123.3420725765 312293.0161694819, -1545121.0821236272 312281.6365364315, -1545120.9691730367 312258.26288719755, -1545119.8995842626 312252.51080428995, -1545116.3180738862 312241.6672249837, -1545103.747972535 312226.6188767534, -1545094.5573743004 312216.80165350065, -1545076.454240221 312204.987888501, -1545068.4127133437 312197.92996498756, -1545048.6182585375 312179.13597469125, -1545033.4562517465 312161.989815657, -1545027.8058878842 312151.41903831623, -1545027.0117154436 312144.7573911613, -1545028.538758757 312131.53609121963, -1545035.0014949276 312110.5022261366, -1545042.1132731691 312090.8754335474, -1545048.0242703327 312071.6601800937, -1545052.6662838806 312058.5394894667, -1545053.866202366 312049.3985609012, -1545048.3179111972 312032.48419945594, -1545045.591779269 312010.3628112534, -1545046.6695970015 311992.6178859323, -1545049.5186704819 311978.8595255334, -1545058.6480620296 311953.4030610677, -1545064.6116576372 311939.7462146161, -1545077.098454279 311922.8707286259, -1545086.5732421828 311908.28042834066, -1545101.829643236 311889.36830153037, -1545108.8111856526 311875.9054830037, -1545111.6602877541 311862.14704337623, -1545112.221181165 311836.83160189074, -1545111.9566497537 311822.97205513995, -1545108.4550479173 311800.4078001324, -1545106.1768459275 311774.08119425643, -1545102.6061686429 311748.47051166464, -1545099.2774653172 311731.33890732937, -1545089.3972945395 311717.24879772216, -1545083.8507465606 311700.3351302538, -1545071.0385099666 311668.07839371637, -1545065.819521563 311647.0855540829, -1545053.0763119354 311626.6042406792, -1545049.168026858 311619.8422726998, -1545029.598348304 311603.31116735935, -1545021.5584780606 311596.2540602572, -1545008.0627709157 311580.7097099526, -1544990.6314287772 311566.95351900253, -1544968.4232892818 311546.2952858275, -1544963.0721801496 311540.1948299529, -1544948.7323237187 311521.16052252706, -1544930.6566224985 311500.79787479993, -1544924.4088029347 311494.3779373178, -1544916.4709446817 311480.97939991206, -1544909.2060645297 311465.6367448, -1544901.665292598 311451.20455174986, -1544899.7515319586 311441.9623475084, -1544897.6982444345 311417.89861952513, -1544894.6748420554 311391.30846769083, -1544894.6119538096 311390.78249691334, -1544891.5006491062 311364.66473362874, -1544890.0864899065 311356.7756336555, -1544891.149979062 311332.813351986, -1544892.4828000995 311308.78005726915, -1544895.384441153 311291.85080208257, -1544899.5798871121 311274.20735743456, -1544899.6428387093 311256.2683316283, -1544895.0962499576 311233.33199275285, -1544887.1187680115 311199.6074894918, -1544882.1763908318 311177.7065661736, -1544876.9172481645 311145.1176143447, -1544876.945895302 311136.5669140043, -1544882.0376222208 311119.241487409, -1544888.056074082 311102.4136097189, -1544891.131081095 311082.1891440144, -1544892.2801838925 311076.2192954719, -1544898.074014778 311057.1295317672, -1544904.063358901 311040.12397469394, -1544916.0134248934 311019.02708589844, -1544926.8360759318 311000.5509620309, -1544929.1065276633 310997.1624289593, -1544944.0513067238 310967.5626824396, -1544950.8631209666 310948.6668797191, -1544959.271973006 310928.3253333913, -1544965.1184408346 310906.06487186346, -1544965.2865872504 310881.7844355069, -1544964.7469928705 310868.83532893565, -1544961.0988825585 310846.21901653334, -1544955.0482036658 310806.9689806383, -1544956.4228409517 310803.2613871461, -1544955.337120787 310782.563919954, -1544957.293072799 310768.48718071915, -1544956.4475976825 310764.9975574976, -1544958.5464734104 310756.1756357411, -1544960.0084356735 310731.18085127976, -1544961.1063157872 310728.38105414156, -1544963.838640341 310706.02025433816, -1544964.695828667 310694.74281522725, -1544968.72154603 310671.66643401515, -1544970.832143068 310648.07737489324, -1544972.668646284 310625.3974685306, -1544973.3262533105 310615.2210359145, -1547588.3938290146 310737.0206989875, -1547730.6666362272 310743.6472122539, -1550203.4556147933 310858.94460596517, -1550208.0531783353 310873.9189187614, -1550209.3541992316 310888.15401299857, -1550221.185945876 310908.33131521195, -1550223.7678794356 310915.63388731424, -1550226.3296739983 310917.5562929269, -1550230.4015667557 310929.7574306475, -1550222.3454579208 310937.4620309109, -1550214.342784884 310941.9949502805, -1550198.507032222 310956.4949520221, -1550199.221410664 310981.10108227935, -1550209.0568329357 311003.7567980476, -1550217.0922217604 311010.82329187915, -1550230.266811781 311015.69253369514, -1550244.0329936729 311021.6142531233, -1550252.1297416312 311040.4586750055, -1550254.9679777531 311041.4718942102, -1550261.4006852175 311038.56141927745, -1550267.9734143442 311040.9083404811, -1550281.9073862417 311052.26331336517, -1550291.6358780786 311081.26234255545, -1550307.1485869305 311105.9449257953, -1550309.710822756 311107.86643984914, -1550322.6078391233 311133.7991576409, -1550325.9585578 311142.38401454594, -1550341.5781122549 311160.72326189745, -1550359.8419756263 311177.99090409, -1550362.9032106278 311181.2666054731, -1550366.6376910727 311182.6003152812, -1550371.7809051357 311191.8261325611, -1550376.9859023246 311212.8289195569, -1550381.5428801663 311232.42484163307, -1550389.4995094023 311246.0140561629, -1550392.3377318247 311247.02728426363, -1550412.2249459 311259.50088158716, -1550424.1642952356 311273.33520993125, -1550442.3119846308 311281.9970944831, -1550463.0757749774 311289.41020460986, -1550465.4885307823 311291.279945923, -1550467.3770474703 311295.1443370776, -1550477.1791637817 311306.20153798535, -1550484.7098574273 311320.64591546915, -1550487.6350688168 311330.0872526271, -1550481.7770246167 311352.34750757087, -1550473.2167773957 311367.4288821379, -1550458.2786494165 311382.2485655965, -1550440.6226848867 311395.9291390367, -1550442.7880841978 311398.88568839803, -1550443.3535433586 311403.2865174934, -1550441.0483392829 311415.2262701951, -1550443.3819473537 311423.61733579356, -1550445.9441606703 311425.5388466874, -1550463.632774374 311423.45753919426, -1550468.2639369024 311425.11085322965, -1550469.3091954503 311425.48400511127, -1550472.9367508572 311433.16097610164, -1550470.408538486 311442.8382614972, -1550453.1985750264 311461.0459256163, -1550450.926279187 311464.4326230567, -1550446.6673217602 311485.24800941814, -1550447.0733179094 311499.16412813496, -1550448.2795672151 311510.17509928066, -1550454.3816229051 311531.49860724714, -1550460.2072210275 311553.73126505315, -1550459.7560670911 311557.937449825, -1550460.8979506018 311581.6888350332, -1550461.8174365612 311588.41799350176, -1550464.1083399702 311605.1706626443, -1550465.5179303652 311613.06311019696, -1550467.1301588118 311637.99008038733, -1550466.8829863784 311659.2303253077, -1550468.0152349751 311668.0314618144, -1550472.9742725634 311710.27591560036, -1550478.0449275693 311737.44477797486, -1550489.373932757 311765.0016472684, -1550496.7694193714 311785.6117839385, -1550496.318718491 311789.81703960523, -1550501.0459895013 311814.84927172307, -1550508.867355134 311834.6042347448, -1550520.371022711 311858.8640473066, -1550524.9569447907 311878.63942232355, -1550529.9606404072 311902.762432375, -1550530.1115708223 311922.9692515796, -1550529.708710936 311944.99389675166, -1550530.0291793763 311970.63465096895, -1550530.8719602022 311974.1266957326, -1550529.0461058512 311982.03947045654, -1550528.0243488678 312002.8348837225, -1550527.1481883388 312007.8965816628, -1550526.692762317 312033.0931538744, -1550522.853369847 312058.25656949077, -1550513.763994395 312080.5374633223, -1550510.7468607826 312103.81157838926, -1550516.8501196143 312125.1364469258, -1550528.010346438 312147.2594917286, -1550530.3161390703 312155.47227130644, -1550532.0126370867 312177.40574434586, -1550537.8838685264 312226.1906757783, -1550541.4940715106 312248.63965657353, -1550547.3595342382 312261.4830607278, -1550554.4802329135 312283.00290160254, -1550558.7914182818 312303.688018064, -1550553.865590182 312346.60064176284, -1550553.4644942645 312368.62582043465, -1550553.4424766365 312392.1300835153, -1550551.7306339918 312429.6404792238, -1550551.3042908807 312430.4964868333, -1550548.8065355935 312440.3527855966, -1550539.8923619569 312459.33773030806, -1550533.7806050605 312467.73443180695))"));
		expectedWbs.add((Polygon)reader.read("POLYGON ((-1551902.7225822012 310404.035041363, -1551886.6564637872 310401.31841874775, -1551861.7187881086 310402.99009443354, -1551838.5178752074 310408.47460914403, -1551830.1710993166 310410.8672576966, -1551813.8575948277 310409.2375348229, -1551775.2896286314 310395.29167244583, -1551757.1425527236 310386.6250908151, -1551753.1315116938 310386.2004827, -1551741.1595155033 310380.9156981064, -1551738.0443117635 310380.8102591671, -1551729.5299225973 310377.7694192128, -1551687.34100316 310371.09602117445, -1551663.7508977468 310368.8840801632, -1551651.1706041833 310368.58867373224, -1551644.1460495892 310370.4466553405, -1551619.7327259004 310370.12369314395, -1551598.5287427153 310373.1310918629, -1551553.115327457 310372.69821920805, -1551530.975370843 310368.98885875754, -1551517.1268518565 310366.05771564785, -1551492.3520431628 310358.2163851252, -1551466.9034609664 310352.31804150157, -1551440.4750951936 310349.0929081114, -1551423.486041305 310349.40761656873, -1551398.4529384226 310347.85726746917, -1551372.644371259 310345.8618962951, -1551350.930346617 310341.29741460644, -1551342.7865840162 310340.57234140486, -1551322.9859061367 310336.5243508043, -1551316.6351424672 310336.43939913064, -1551297.1109434704 310331.48219896667, -1551290.7597255846 310331.39814054314, -1551280.7952100504 310329.8548732549, -1551275.0646959753 310330.99876042455, -1551271.329684925 310329.6658613272, -1551259.646579637 310329.69150855485, -1551238.7730872633 310328.61936678644, -1551217.871386889 310327.37003436964, -1551194.9841617132 310323.39523507375, -1551176.107515046 310319.84589695, -1551156.8593364304 310313.9804267818, -1551137.4836944016 310309.0768543724, -1551115.8236028412 310301.3420274062, -1551094.5059431882 310295.74569701403, -1551090.152019025 310293.1835485697, -1551085.9915380343 310292.7049835874, -1551067.566547127 310284.95059368946, -1551056.9826658 310282.1790004913, -1551035.5985790251 310273.5358823696, -1551013.0126418641 310265.30384569895, -1550989.8355440889 310256.0206458969, -1550969.6184212358 310247.62664871383, -1550917.2049540062 310245.7074640477, -1550868.6942326992 310250.5568951145, -1550865.181314684 310251.486152946, -1550862.3430252592 310250.4728932474, -1550858.9522526397 310251.277185319, -1550846.6479982 310250.07588758506, -1550828.0730805642 310242.2684793584, -1550825.6052971184 310241.29549097456, -1550801.1613808263 310231.6538659949, -1550781.3602379386 310227.60700261313, -1550771.8942736394 310227.41898001265, -1550767.48508479 310228.0277527822, -1550744.7360213392 310229.3121123137, -1550736.7870515194 310230.6725192899, -1550670.9149363984 310233.5249588974, -1550649.1447375505 310232.1357063176, -1550640.0760494533 310230.9139553178, -1550633.5040824118 310228.56743093766, -1550599.4839939242 310222.80562515557, -1550595.7203271477 310221.2942421166, -1550592.8820358587 310220.281000074, -1550586.7350893598 310217.0788196223, -1550583.524780826 310213.7503420999, -1550580.2161251036 310211.56140386034, -1550573.9736219882 310205.13476842083, -1550569.4510202399 310197.1387699414, -1550565.96470174 310194.71862327214, -1550561.2204367048 310184.459617232, -1550548.0972809945 310164.9971900508, -1550511.4909240329 310136.9842753038, -1550500.5349981165 310131.8975758264, -1550485.7227865104 310125.60346920136, -1550480.5929008015 310122.59725572634, -1550472.354467678 310118.6483296938, -1550468.3429780004 310118.22472273745, -1550454.7713028297 310114.38826439064, -1550448.42009683 310114.3043222781, -1550445.702599163 310113.1665579863, -1550442.4665852701 310113.1879704017, -1550437.4093713632 310112.3898702925, -1550427.0475650185 310111.88278135564, -1550421.7134370853 310111.99479556736, -1550401.116838159 310110.0173927462, -1550379.4126304782 310111.6759800194, -1550374.8544355463 310112.23212462105, -1550341.154682191 310123.38106432, -1550337.6417811392 310124.3103597034, -1550333.2043899682 310124.7419744544, -1550331.6343991903 310126.3644664753, -1550308.6815827577 310130.76859249454, -1550283.0681412045 310134.3907101331, -1550271.0717286863 310143.8805934051, -1550262.7372317335 310152.49384128675, -1550257.2288814934 310155.9021819001, -1550251.49751232 310157.0479598297, -1550271.3779977337 310119.47137237433, -1550278.4320085295 310117.78997189365, -1550287.5541407333 310115.83985975385, -1550302.32115557 310111.8404649761, -1550302.8053644442 310111.70932523906, -1550319.1023176424 310107.9532852229, -1550336.3968799547 310106.9043781208, -1550346.1205130413 310100.8022987433, -1550368.3657607506 310083.21377870254, -1550373.025717458 310085.0456262389, -1550382.2147905848 310086.1414408898, -1550387.7419426667 310088.11388724204, -1550412.3795771457 310090.69387814496, -1550440.103326134 310093.1993470667, -1550463.9833687602 310100.71469133627, -1550468.6142424566 310102.3666623561, -1550492.771175369 310108.97414305154, -1550494.7131976427 310109.66689227894, -1550512.6401744469 310116.06501605175, -1550523.1701943055 310122.0069319857, -1550526.2314983841 310125.282744769, -1550545.6193246825 310136.40196821094, -1550557.7614381544 310147.11766315345, -1550576.5490801763 310162.38843734376, -1550592.0275985715 310175.4711656049, -1550602.0581344105 310180.05974641256, -1550609.2794766698 310183.81273903884, -1550632.0602656608 310194.12770553306, -1550634.6212064445 310196.04971680883, -1550655.513435053 310202.5001459969, -1550658.7780946563 310202.6572926631, -1550662.5131164358 310203.99013896566, -1550665.6274187102 310204.09505438246, -1550669.362440365 310205.4279012792, -1550692.177944654 310207.1903128689, -1550712.654166455 310209.29372810293, -1550725.5108995985 310208.677435888, -1550748.6037657037 310209.531105794, -1550758.4947584716 310208.86345771234, -1550857.533390023 310221.1627454702, -1550974.8927087293 310235.7380699497, -1550984.027836546 310240.0067005446, -1551014.9787535274 310251.22540760227, -1551034.3000337332 310259.3002734035, -1551057.2827955575 310266.4994589323, -1551068.8842115072 310269.4661293747, -1551072.2210627599 310271.8323086556, -1551088.630970384 310276.6844662884, -1551108.6268777247 310282.8168462571, -1551134.0215383011 310291.88544647116, -1551153.2697263192 310297.75090599153, -1551193.066307385 310307.931240364, -1551212.9882468763 310311.8537536962, -1551236.5501267328 310313.8860416142, -1551259.520858992 310314.867160921, -1551280.1169944552 310316.84807417914, -1551300.8148386804 310321.21700211987, -1551321.0128050824 310324.2312302431, -1551345.8973489797 310325.727976514, -1551369.608689043 310327.81434197817, -1551397.6075503887 310329.4160747044, -1551420.69865146 310330.2736271396, -1551441.2284088635 310329.207780106, -1551461.426819354 310332.2234109668, -1551468.8959315363 310334.89102193713, -1551489.0399261385 310341.0780238779, -1551491.9351566252 310342.3438442685, -1551503.7294180766 310347.50056818686, -1551515.756756446 310349.61214690283, -1551537.4044051855 310351.12987529486, -1551553.6482874127 310348.88371311687, -1551563.166160525 310347.56730012037, -1551587.1535527962 310348.74543762393, -1551615.3563172414 310347.22994330246, -1551636.8363495306 310343.3142058542, -1551644.1124979758 310343.8973599225, -1551672.9642818945 310355.2111000838, -1551686.3855339328 310358.9979310818, -1551693.1622489805 310358.22771933395, -1551717.0288533662 310359.5304479636, -1551733.493157418 310361.2137115598, -1551752.562765049 310366.84999577794, -1551771.357839343 310376.92351322994, -1551792.591481515 310385.51699951664, -1551815.2848715107 310387.4093796108, -1551837.3302762597 310387.89483248163, -1551856.9093540371 310389.68224100396, -1551879.6108554462 310382.84434393793, -1551892.2447258155 310379.96797952894, -1551913.284526734 310386.47657959256, -1551924.239874661 310391.566771918, -1551933.7049813576 310391.75679451507, -1551937.0966827073 310390.95302151795, -1551950.609595567 310383.0158998715, -1551969.1206152213 310364.09941799194, -1551986.5605564064 310348.15965458006, -1551990.3495651158 310346.32212506793, -1552000.4053357262 310336.14236342907, -1552004.398703327 310331.18657637294, -1552014.3897852523 310325.94769132324, -1552021.5647957686 310333.8823067518, -1552028.2659177755 310341.2926930627, -1552009.8188616047 310354.45412353147, -1551992.3789107688 310370.3938793121, -1551983.6462519385 310380.0393850999, -1551971.871417535 310391.78891155124, -1551953.0243563328 310399.8356381599, -1551926.709548376 310405.21423765086, -1551906.8544309002 310404.33513258304, -1551902.7225822012 310404.035041363))"));
		expectedWbs.add((Polygon)reader.read("POLYGON ((-1550853.5260222028 304417.14907593, -1550850.5728197661 304422.4781826334, -1550844.7427172584 304441.5614499189, -1550846.135410273 304464.3948951848, -1550849.6994041891 304475.23861630075, -1550854.4951067176 304482.32354859635, -1550873.6938720327 304491.351848511, -1550880.2689827015 304493.69620207883, -1550882.0051923215 304497.50703408197, -1550878.5580774108 304521.8064612681, -1550882.0659115436 304535.82134743035, -1550892.8728069682 304562.0114495056, -1550905.9861063082 304581.4670801293, -1550924.3588416444 304592.38573153596, -1550930.2574428336 304596.67220667657, -1550948.4878927895 304613.7528329976, -1550960.790000629 304629.8967187442, -1550973.505042781 304650.38590973616, -1550987.486738542 304673.5104300743, -1551003.8089041072 304696.29415088426, -1551018.686073767 304719.7386984369, -1551034.4466949317 304738.1235519117, -1551037.727392849 304743.6598135205, -1551055.1175020845 304757.2510137744, -1551062.076648863 304767.2908636555, -1551079.3521880214 304787.22436329443, -1551094.0673437226 304805.2360459436, -1551107.7131438262 304832.44064525515, -1551110.2320592988 304842.9124549236, -1551107.2779585014 304848.24100210425, -1551093.5790174815 304865.69306963775, -1551083.516053604 304882.091740326, -1551083.2533735968 304888.3795598233, -1551087.9776879607 304893.2554136319, -1551116.8680520423 304883.5720857391, -1551125.385797759 304886.61059981864, -1551130.2384728491 304890.52480264194, -1551132.9064125726 304901.0492626289, -1551128.4578783659 304916.4265671503, -1551126.4585635394 304918.9044741886, -1551107.3524392853 304913.09855972324, -1551099.4541445756 304911.2886471106, -1551093.1640969038 304914.2525324682, -1551091.6625242124 304918.08314975817, -1551093.4331748208 304928.2888714932, -1551102.8112376367 304946.4128383137, -1551121.8027842664 304958.5610053288, -1551125.8161198706 304958.98401951883, -1551133.0101475436 304962.5578974141, -1551137.7344498702 304967.4337491561, -1551143.4756195939 304986.61285906937, -1551146.8696560597 305006.97026917525, -1551152.617521992 305032.366135044, -1551163.1048094444 305068.01796412, -1551165.8297870678 305075.37169326935, -1551164.0151463726 305094.87972499896, -1551159.403790958 305104.8236628873, -1551152.0034091272 305125.529324593, -1551140.9375313339 305147.1115190983, -1551138.3834357106 305151.407352861, -1551132.4770448213 305162.06519517023, -1551121.2479007954 305178.21502217464, -1551107.2734389745 305196.57667400874, -1551105.21708611 305202.22519333754, -1551096.8127888513 305214.0077256793, -1551084.3532844917 305233.9179721512, -1551083.2508221178 305236.7154473327, -1551067.055873603 305255.2927849181, -1551064.1597449167 305257.4510386847, -1551046.5849642695 305279.7347973697, -1551044.1865752006 305283.24573937245, -1551027.49392987 305300.4703419665, -1551011.5773167973 305318.13910153974, -1550995.9942656097 305331.7277940633, -1550963.719528295 305362.5414789645, -1550946.4792876446 305380.74552942626, -1550936.8379724906 305390.07171342336, -1550935.7355250781 305392.86916520726, -1550921.3205348854 305406.7073150836, -1550902.8423394903 305422.45463619474, -1550882.4857036136 305440.55522039067, -1550871.578662892 305447.24657070637, -1550849.5775722507 305443.59943381883, -1550848.6807421523 305443.2798291892, -1550844.1197927247 305443.8363323221, -1550840.94630719 305446.90352999326, -1550838.1802030012 305469.26219096687, -1550839.3556023997 305489.8357638987, -1550840.2739261643 305501.7506790804, -1550847.6256180643 305525.70298669767, -1550862.8472774075 305551.28570849076, -1550864.7338176281 305555.14863256924, -1550863.1414649638 305576.91873291414, -1550855.7431010765 305597.6248039203, -1550848.1239375696 305616.07011786755, -1550837.7941034103 305632.53918566275, -1550830.7724656616 305640.6164442785, -1550815.355600799 305659.638461221, -1550790.8174478982 305686.8288708655, -1550780.7502892234 305697.01029694546, -1550762.33109582 305709.587710605, -1550742.0178364275 305719.1392832082, -1550727.0904486254 305719.18960277084, -1550713.236380836 305716.26483810786, -1550692.6385586867 305720.507461505, -1550689.7424895235 305722.66566257924, -1550682.6229477867 305742.46441455465, -1550675.2826191701 305760.0001959298, -1550666.1680145408 305767.3310661884, -1550652.8216033918 305771.9759927364, -1550641.5165111262 305779.70073286165, -1550632.3825630385 305796.5972784059, -1550626.8381829762 305811.77237315103, -1550624.8362210602 305817.2508891169, -1550617.1624261257 305838.86654617265, -1550611.6153322908 305857.0423294855, -1550608.7421561657 305870.797410381, -1550606.893730683 305873.32876911294, -1550606.4380694572 305877.53370240703, -1550597.9962782473 305897.86719682533, -1550596.3391133975 305902.4824615037, -1550589.7829664904 305926.680561482, -1550585.394883705 305938.88702199794, -1550576.2770942727 305961.16378600243, -1550573.9443680337 305967.7214768771, -1550562.3862056178 305987.9514672123, -1550551.6440600348 306000.0765136471, -1550542.085138946 306017.82870625705, -1550538.3735325672 306028.0931310132, -1550530.0812698673 306048.4804833317, -1550520.1798482079 306064.09605322033, -1550513.0056736716 306087.06499252655, -1550510.5836293201 306111.56132657547, -1550505.9343235148 306130.05691980384, -1550504.250164529 306138.0207659537, -1550503.0032049154 306161.92816470657, -1550500.9442009998 306182.52356381156, -1550497.1756126964 306195.95839902945, -1550486.9420915793 306215.6532892287, -1550484.2682152332 306220.07389818225, -1550482.5140632351 306236.4108042987, -1550481.1957790027 306258.10920921434, -1550479.3051412008 306269.1917133806, -1550473.4830249182 306288.27606491186, -1550466.0885465606 306308.98321068846, -1550462.035351151 306317.111389827, -1550452.6986886417 306337.1257572621, -1550446.795328762 306347.78431224264, -1550431.5033014799 306366.6828832356, -1550418.829923062 306384.33223662805, -1550402.2990454156 306400.7737392429, -1550398.9775346222 306403.78856699076, -1550388.96537513 306425.74524085317, -1550385.1986227646 306439.180824046, -1550378.5928742506 306451.6040583197, -1550371.199363443 306472.31148710754, -1550367.3665761177 306482.7011294104, -1550368.4900617127 306506.44554445706, -1550366.0060866755 306527.89642183855, -1550363.0548763843 306533.225875536, -1550357.3459563698 306545.9686459629, -1550349.7312124292 306564.41400364786, -1550342.6159920348 306584.2128617177, -1550337.6103924755 306595.19133102335, -1550325.103173799 306618.273785525, -1550313.3262740367 306636.24339178577, -1550302.0484685597 306655.5651494879, -1550298.8207988292 306661.8039322281, -1550290.9210228575 306674.94135270454, -1550283.6559359974 306694.68698036764, -1550281.2380653578 306719.18354113493, -1550274.012957371 306730.37810143176, -1550258.5303272784 306747.19380895793, -1550246.356666881 306766.1963193733, -1550234.8024563128 306786.4273063559, -1550230.1959730515 306796.3726596497, -1550221.7576621089 306816.7079325877, -1550218.4092091962 306823.0712185642, -1550211.4157962897 306842.7457201835, -1550208.6559010341 306865.1047136197, -1550207.4431282366 306874.24455718417, -1550197.21258929 306893.94013541564, -1550182.2009242338 306911.9306299975, -1550169.917817198 306922.3302583508, -1550165.1444284085 306941.7876115097, -1550161.0361542057 306953.08681691345, -1550157.4669094367 306957.18723350484, -1550147.4594428143 306964.1998457974, -1550142.0666325202 306982.4286738653, -1550131.782270411 306990.34928099345, -1550123.2349618566 307002.0807780316, -1550116.0656170966 307025.0509312013, -1550114.63028686 307046.8748859968, -1550124.742948879 307074.8323632572, -1550140.4696798644 307101.768661893, -1550153.1352842348 307125.43024757504, -1550166.559825688 307144.155449016, -1550182.2138143422 307168.88335289806, -1550196.8776312633 307190.066843858, -1550209.431878073 307220.0704465732, -1550219.3141126444 307239.54974173475, -1550232.2408612196 307256.9223388424, -1550242.6607741688 307269.2033595247, -1550244.9620216861 307277.4139511883, -1550245.8022415375 307295.85077806376, -1550260.973651487 307324.60561763775, -1550263.2201350029 307335.9865470184, -1550264.734531861 307352.48145912495, -1550263.7825297618 307355.33310595714, -1550265.1874341827 307363.2231927728, -1550271.0017693955 307385.4497194905, -1550279.146921341 307401.11808080506, -1550280.3201315026 307415.47606042307, -1550283.2959743107 307436.6893269988, -1550298.5234155667 307462.27328565717, -1550305.2636510555 307470.05155909434, -1550318.1902813069 307487.42631102353, -1550335.350345377 307507.4855538765, -1550349.366345927 307527.2632262707, -1550360.3499171352 307543.94477065094, -1550372.5462102941 307566.43213168345, -1550383.0481569758 307587.14108563587, -1550394.9575908808 307604.3198778359, -1550410.7782965484 307619.5357334148, -1550440.1054959283 307646.9592431439, -1550455.5288927248 307663.2089770315, -1550460.4755104927 307670.3480501855, -1550477.6072378713 307690.2300581662, -1550489.9695601158 307703.2051097341, -1550506.9638989088 307717.83259362634, -1550525.3456301186 307734.9705666397, -1550540.989761848 307753.48307351675, -1550557.446324659 307775.30870555714, -1550559.526246473 307781.2573176874, -1550563.85476534 307787.1674858555, -1550567.2182596049 307801.131530053, -1550570.233055839 307813.7956791064, -1550564.85979554 307837.4056360638, -1550559.2639562236 307858.75413295906, -1550557.3315846275 307879.2253565034, -1550554.6298904368 307898.4149820898, -1550555.21135905 307923.1415789807, -1550559.6210774137 307937.47915916983, -1550563.7812044155 307964.32286958676, -1550566.5816950833 307988.8341900967, -1550566.1107104004 308014.0258665355, -1550562.06018188 308037.09991377685, -1550562.6239034769 308041.50041951705, -1550559.332205037 308086.0069668973, -1550558.6844479488 308099.5464312546, -1550565.3961780423 308122.09476176463, -1550573.2098196102 308141.8446465647, -1550580.1715837277 308151.88602243084, -1550591.1562430053 308168.5691391593, -1550600.5699314843 308186.8744604811, -1550610.8499379293 308205.3221430471, -1550618.6635455515 308225.07198929135, -1550621.8909806788 308233.7809614362, -1550628.8247827732 308258.591500354, -1550634.6962667617 308277.6485608956, -1550641.4088196715 308300.19723271485, -1550643.1847473353 308310.4042744171, -1550644.2170704934 308319.0207168367, -1548057.2939982228 308063.6058185636, -1547931.02428742 308051.1388203427, -1545470.3584549273 307808.3172639571, -1545467.874791227 307804.55955665745, -1545465.4533268 307787.75021629874, -1545467.8673361337 307769.4708578754, -1545472.3517192078 307750.9203004036, -1545470.9340548366 307728.0893349396, -1545470.2799850588 307715.2662175046, -1545471.9046737175 307690.3275612211, -1545468.8428934019 307687.0565139903, -1545459.0008097575 307684.5638325615, -1545459.1696922625 307689.99653206766, -1545456.566485669 307697.464098067, -1545448.7828200073 307704.26540256944, -1545435.3540282722 307700.4983347496, -1545423.3137440088 307683.45886909496, -1545418.221319161 307671.0719283316, -1545417.43198407 307664.41268740036, -1545421.0195710275 307645.54256105796, -1545427.5009285845 307624.5134450123, -1545431.101841265 307611.8607328385, -1545431.0686389802 307600.2654513074, -1545438.3937389664 307582.7254514806, -1545445.09841818 307563.9566566404, -1545448.975698651 307550.39461997803, -1545451.2495005175 307547.0059666587, -1545454.304258055 307535.33439851925, -1545458.0616443865 307521.8973490903, -1545466.486089364 307501.55885323323, -1545473.2580722845 307485.83600556385, -1545480.7516585672 307473.7273110971, -1545492.0164179238 307454.3981155213, -1545502.4042562714 307440.1295156982, -1545516.3594189163 307421.7565336805, -1545522.9031628422 307412.5002341829, -1545535.907587616 307396.97920883074, -1545543.7457326264 307387.0076539712, -1545547.1114445478 307365.8764323881, -1545548.8187880337 307358.08970722556, -1545559.1872591136 307338.4422461102, -1545565.9796082433 307328.0985163124, -1545574.4050375323 307307.7602752084, -1545573.89253449 307300.1907331394, -1545568.0660729795 307277.97453299724, -1545568.3160257344 307256.7436068943, -1545569.6934975171 307253.03675175365, -1545583.6496454063 307234.6640453385, -1545603.8802242754 307222.88708510716, -1545607.669956469 307221.04487019405, -1545611.718421041 307212.91543958336, -1545611.6256519344 307189.54813827295, -1545621.7598407445 307161.4225247931, -1545629.7603980633 307141.93988371827, -1545637.9099880052 307122.50987363793, -1545644.9791925235 307111.2580661094, -1545657.1165280337 307095.5963009363, -1545660.227133718 307080.75385947805, -1545662.758377854 307071.0783027271, -1545667.7576434487 307060.0967813516, -1545675.7582431503 307040.6140417047, -1545687.5786181262 307019.4671590738, -1545696.5180021713 307006.6978188902, -1545711.7438471678 306990.95881401, -1545724.751152769 306975.43880789634, -1545720.953557631 306962.3375620283, -1545713.2454049925 306951.2031116672, -1545709.6175694072 306943.53296097834, -1545705.0864188385 306920.6015999671, -1545712.6178685292 306899.94481644407, -1545717.7795322828 306879.45212456584, -1545725.3109958651 306858.7952998001, -1545726.5385811657 306855.03526748344, -1545740.64663378 306836.7161938576, -1545748.653792479 306832.17725860886, -1545750.9820812168 306825.61826328095, -1545749.7960724928 306819.9917519344, -1545739.766857225 306806.68900884315, -1545734.676178156 306794.30251157377, -1545742.0577508172 306773.59249836206, -1545753.825593795 306755.6164687751, -1545769.3960723625 306742.01450728904, -1545788.3609670943 306727.6050552428, -1545799.5937140638 306716.82567012776, -1545812.0355699852 306696.9077219283, -1545816.427755371 306690.91488632094, -1545820.247561817 306689.2507275697, -1545825.5006208667 306692.12612773664, -1545829.8033393403 306697.8527197996, -1545835.3614367966 306699.9973465651, -1545838.8757492935 306699.0648541292, -1545845.3666056492 306692.97801162023, -1545847.8701376438 306683.12417255435, -1545845.1630987453 306661.00875558984, -1545850.6436136619 306646.0018846616, -1545847.413369725 306637.29908823594, -1545831.3067257372 306623.01048786566, -1545827.6788787872 306615.3402305972, -1545827.8163982993 306609.178286463, -1545845.4536168575 306580.36217799503, -1545853.7196120066 306569.5357698593, -1545859.7842024271 306564.3051104024, -1545863.3276501542 306563.55027002376, -1545878.838730826 306573.26304596104, -1545888.958344963 306574.8468959704, -1545902.5867454035 306560.55449460447, -1545904.9159634046 306553.9958636975, -1545905.1296390563 306550.1257702345, -1545905.8907844778 306536.37900048215, -1545909.9946992234 306525.07948076725, -1545910.9814519228 306513.6785673555, -1545906.0596122057 306506.72489259485, -1545891.1929279482 306494.89120198786, -1545885.147674394 306470.41374302097, -1545886.9648661711 306456.28659616597, -1545894.1268656976 306433.3153177649, -1545904.3498366314 306413.6147656683, -1545905.4514472783 306410.8162051635, -1545920.2831022567 306396.11195814516, -1545938.074584335 306382.2929556649, -1545944.1907888772 306358.9494360555, -1545944.1059499714 306350.5251263287, -1545951.669806277 306341.4632769283, -1545958.6321444514 306336.55250975955, -1545973.1865843567 306322.7570936326, -1545984.6514007181 306305.51234319154, -1545997.4671122518 306287.90894309897, -1545997.6857541236 306275.22820169013, -1545997.3199271911 306252.7696944503, -1546002.9873086174 306198.5440151179, -1546005.6297964049 306182.5274404045, -1546008.913932441 306138.032021557, -1546013.5392247117 306098.3770749718, -1546020.3050712429 306076.4397668084, -1546027.136390476 306057.54774957057, -1546032.950538495 306038.4621157851, -1546041.6604112142 306017.2159698764, -1546047.5040615683 306009.72462466266, -1546059.4501725526 305988.4543520361, -1546071.000008307 305968.21843057405, -1546075.9727038012 305945.64331473503, -1546075.681597594 305925.3937270669, -1546076.392913473 305914.9023160385, -1546078.5265630616 305891.31732143555, -1546078.3590696072 305885.88597523794, -1546080.2874707526 305865.41774813086, -1546084.929354969 305846.9222509861, -1546090.1511088202 305823.2608870743, -1546091.416972624 305810.95160844736, -1546094.1721088972 305803.5373721607, -1546100.9139646604 305796.36501407064, -1546104.456599166 305795.6096693063, -1546107.147519144 305796.56729843, -1546113.556771284 305793.4737629313, -1546117.1547423734 305789.54850470833, -1546119.5762503427 305771.27107573114, -1546120.7848736746 305747.18920358364, -1546121.7075614075 305732.7443261659, -1546123.4149415349 305710.0153998276, -1546125.246375745 305702.1039695507, -1546128.7036230604 305677.9833349772, -1546132.354143008 305655.9451297056, -1546137.2451128084 305636.3633169653, -1546137.779293423 305614.224160213, -1546137.2690729692 305606.65629293676, -1546133.0774004783 305594.58869375475, -1546116.6663313464 305569.615325843, -1546109.5234163702 305547.9365215879, -1546110.8999633924 305529.28720147815, -1546117.1685157248 305505.99811227806, -1546121.5239438452 305482.1963477675, -1546122.8737455136 305478.3110660324, -1546120.772747312 305452.0455251727, -1546115.9061431522 305441.92162447795, -1546102.9185736664 305427.73384144437, -1546099.15308072 305426.22772762086, -1546071.5247010805 305432.35361094866, -1546066.8619242322 305430.5288843084, -1546056.8809259012 305422.78238883056, -1546052.977055813 305416.0225028526, -1546048.7285039567 305392.1834658524, -1546052.8066285716 305369.29052961245, -1546055.3019280918 305353.2216281872, -1546063.4605203648 305333.79313027114, -1546064.6890691132 305330.0332800746, -1546072.4224108001 305326.4033209244, -1546080.1004213127 305325.9433347015, -1546089.2847130827 305320.8136764802, -1546092.4941729812 305309.19625382964, -1546088.1911849694 305288.52753537335, -1546085.5172015429 305278.00731913093, -1546082.538388764 305271.7441203743, -1546067.535129432 305254.6584592331, -1546056.3504041408 305247.3245783374, -1546049.2078391179 305225.6468919432, -1546047.458911484 305215.6233823169, -1546044.0351456923 305189.8957216302, -1546042.8498435281 305169.3273779955, -1546042.709952632 305149.1320642121, -1546045.8639126457 305125.74261768255, -1546051.0621823976 305105.42954801675, -1546053.7904626871 305097.83741725795, -1546068.1836472135 305078.6113624787, -1546071.5771485057 305062.86132670846, -1546068.3763750133 305054.3370174896, -1546053.9553009379 305047.02724907734, -1546047.8309573762 305040.4854504345, -1546038.895109443 305018.16993941646, -1546037.8601532234 304997.6559057422, -1546038.6724270473 304974.6099400893, -1546038.32951274 304957.53139946423, -1546032.6861638573 304932.0221126331, -1546026.7014071862 304904.3758589821, -1546015.5737436912 304882.4569934979, -1546011.3684615365 304870.6853086548, -1548201.073782978 304185.2231910387, -1550356.7368787616 303510.4734781161, -1550363.7170960794 303521.054102147, -1550374.8580471266 303543.1622798918, -1550405.0115862384 303589.008432704, -1550409.9560504002 303596.14479935635, -1550427.4531646734 303618.33500604145, -1550437.2231689761 303629.20656550955, -1550452.3649359462 303646.3585743336, -1550464.5045617376 303657.06697048526, -1550480.0960397848 303663.7992811594, -1550483.1556079364 303667.07341733575, -1550495.3150434855 303689.3770243572, -1550509.295075765 303712.4974950431, -1550525.2761950751 303733.14080421906, -1550543.449241092 303753.389700735, -1550560.3263098374 303774.35214907955, -1550575.7458146028 303790.5964659434, -1550586.3547157971 303804.9579754006, -1550602.8775526346 303818.4050963558, -1550612.7969504888 303829.3306645034, -1550628.5710470327 303853.0916445162, -1550646.4499022344 303882.9774959292, -1550658.0471876834 303900.882950373, -1550669.0258822185 303917.5602279473, -1550679.2710572695 303939.35046559945, -1550687.8558543175 303965.7558991881, -1550707.2954474108 303988.6401444236, -1550721.610572858 304007.6833949648, -1550732.9312953155 304026.4982896736, -1550740.278887617 304050.4473310439, -1550747.8761022906 304073.3092047535, -1550763.7995186767 304097.124098924, -1550805.453397572 304140.86181046255, -1550814.4313154551 304160.0174678499, -1550820.18726967 304170.46692165174, -1550825.9911446886 304192.6908689523, -1550828.2600981628 304204.2486750614, -1550828.328202833 304227.6172746029, -1550833.0153040043 304247.2589353807, -1550838.7562644777 304266.4370918479, -1550842.8238956688 304284.8501113998, -1550845.5112073438 304306.9706121953, -1550853.9854584846 304318.55696700886, -1550865.7352655604 304315.356851032, -1550877.9321064919 304322.8958153846, -1550882.0504391987 304331.9224691307, -1550878.8961263252 304346.5857037157, -1550873.9910691835 304366.16588572226, -1550873.7136753863 304367.0748943109, -1550869.3697036803 304391.0548502542, -1550863.0350864525 304402.5685067605, -1550853.5260222028 304417.14907593), (-1545729.3393619352 307358.1506063733, -1545722.9856982501 307358.07413562015, -1545712.0312854988 307367.94474960025, -1545710.0347014247 307370.42459243257, -1545708.6581077764 307374.1318858266, -1545706.8105482606 307376.6643779278, -1545703.0928578698 307380.71430959925, -1545684.2208438443 307383.4046140546, -1545661.2261475306 307376.2354796743, -1545653.2735179164 307377.6041179495, -1545647.1020299797 307389.17572712526, -1545644.5712410293 307398.85248932615, -1545645.1377086702 307403.25052886084, -1545645.2526121715 307411.8525513448, -1545651.2409120433 307424.5587077914, -1545651.4093382782 307429.9901356576, -1545649.7642439774 307449.5498955371, -1545649.283556924 307453.5762158446, -1545650.721520325 307461.6415287778, -1545656.5483497614 307483.858956716, -1545662.8138873612 307495.6562476102, -1545672.398168353 307504.4365658816, -1545676.3377928606 307502.6474946784, -1545685.77538527 307491.23001152463, -1545688.7766899744 307482.72897112835, -1545689.727457616 307479.8769954769, -1545691.1040461413 307476.1697207317, -1545694.469374364 307455.0394347012, -1545695.1115363021 307441.501802966, -1545700.9735385864 307419.2441032557, -1545717.7151298684 307405.05194757506, -1545722.5515545714 307403.5823636288, -1545730.6670078002 307392.7019694941, -1545735.5782632288 307373.2962046983, -1545734.79031233 307366.6364157479, -1545733.2979416894 307361.7412080355, -1545729.3393619352 307358.1506063733))"));
		
		polygonSetEquals(expectedWbs, pg.getUpdatedPolygons());
	}
	
	@Test
	public void testMultiOutHeadwater() throws Exception{
		String wb = "POLYGON ((-55.82813399999997728 47.69994010000004891, -55.8282285999999317 47.69978800000006913, -55.82843439999993507 47.69970000000006394, -55.82884059999997817 47.69983920000004218, -55.82888569999994388 47.6999046000000817, -55.82869829999998501 47.69999040000004698, -55.82830449999994471 47.70008730000006381, -55.82813399999997728 47.69994010000004891))";
		String line1 = "LINESTRING (-55.82830449999994471 47.70008730000006381, -55.82817109999996319 47.70019900000005464, -55.82819509999995944 47.70033100000006243, -55.82838689999994131 47.70067470000003595, -55.82823259999997845 47.70111620000005814, -55.82793529999997872 47.7013688000000684, -55.82789619999994102 47.70151450000003024, -55.82779089999996813 47.701661500000057, -55.82756779999994023 47.70171930000003613, -55.8274244999999496 47.70171660000005431)";
		String line2 = "LINESTRING (-55.82813399999997728 47.69994010000004891, -55.82798889999997982 47.69989270000007764)";
		
		Polygon polygon = (Polygon)reader.read(wb);
		
		ArrayList<LineString> lines = new ArrayList<>();
		ArrayList<Polygon> polys = new ArrayList<>();
		
		lines.add((LineString)reader.read(line1));
		lines.add((LineString)reader.read(line2));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, polys, lines);
		Collection<ConstructionPoint> pnts = pg.getPoints();

		ArrayList<ConstructionPoint> expected = new ArrayList<>();
		expected.add(new ConstructionPoint(new Coordinate(-55.82813399999998, 47.69994010000005),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-55.828304499999945, 47.700087300000064),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-55.82884059999998, 47.69983920000004),NodeType.HEADWATER,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-55.828434399999935, 47.699700000000064),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-55.82821924999996, 47.700013700000056),NodeType.BANK,FlowDirection.INPUT, null));
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		ArrayList<Polygon> expectedWbs = new ArrayList<>();
		expectedWbs.add((Polygon)reader.read("POLYGON ((-55.82813399999998 47.69994010000005, -55.82822859999993 47.69978800000007, -55.828434399999935 47.699700000000064, -55.82884059999998 47.69983920000004, -55.828885699999944 47.69990460000008, -55.828698299999985 47.69999040000005, -55.828304499999945 47.700087300000064, -55.82821924999996 47.700013700000056, -55.82813399999998 47.69994010000005))"));
		
		polygonSetEquals(expectedWbs, pg.getUpdatedPolygons());
	}
	
	
	@Test
	public void testSingleInOut() throws Exception{
		String waterbody = "Polygon ((-79.82983759999999052 47.26586439999999811, -79.82984609999999748 47.26586559999999793, -79.82981949999999927 47.26587430000000012, -79.82981929999999693 47.26588329999999871, -79.8298580999999956 47.26591969999999776, -79.82992360000000076 47.26594739999999462, -79.82998809999999423 47.26602009999999865, -79.83006699999999967 47.26603889999999808, -79.83013230000000249 47.26607549999999947, -79.8301436999999936 47.26615659999999508, -79.83007719999999097 47.2661738999999983, -79.82997189999998966 47.26615489999999653, -79.82981470000000002 47.26609029999999478, -79.82973599999999692 47.26606249999999676, -79.82968569999999886 47.26594499999999499, -79.82971329999999455 47.26589129999999983, -79.82978020000000186 47.26585599999999943, -79.82983759999999052 47.26586439999999811))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String ls1 = "LineString (-79.82983759999999052 47.26586439999999811, -79.82991339999999525 47.26581230000000033, -79.82991379999999992 47.26579429999999604, -79.82994219999999075 47.2657045999999994, -79.82993109999999604 47.26560549999999949, -79.82988139999999078 47.26546099999999484, -79.82980469999999684 47.26534329999999784, -79.82970219999999983 47.26519829999999445, -79.82962559999999996 47.26507149999999768, -79.82953489999999874 47.26498959999999983, -79.82936469999999929 47.26491589999999832, -79.82916759999999101 47.26485979999999643, -79.82903670000000318 47.26480449999999678, -79.82893190000000061 47.26475849999999923, -79.82885459999999966 47.26466769999999684, -79.82881770000000188 47.26454129999999765, -79.82872879999999327 47.26437839999999824, -79.82859899999999698 47.26426909999999992, -79.82844339999999761 47.26413259999999639, -79.82831500000000347 47.26396030000000081, -79.82823789999999065 47.26386049999999983, -79.82818720000000212 47.26376099999999525, -79.82816379999999867 47.2636257999999998, -79.82821919999999238 47.26350939999999667, -79.82828809999999464 47.26338409999999612, -79.828448999999992 47.26327769999999617, -79.82863720000000285 47.26313569999999942, -79.82882440000000202 47.26303859999999446, -79.82898500000000297 47.26295029999999997, -79.82914479999999458 47.26289789999999869, -79.82930559999999787 47.2628005999999985, -79.82949359999999217 47.26266749999999917, -79.82957439999999849 47.26259639999999962, -79.82966909999998961 47.26249839999999836, -79.82979159999999297 47.26233759999999506, -79.82989919999999984 47.26225769999999926, -79.83000779999998997 47.26212389999999886, -79.83012899999999945 47.26202609999999993, -79.83026409999999373 47.26189249999999475, -79.83033179999999618 47.26182119999999998, -79.83040059999999016 47.26169600000000059, -79.83040179999998998 47.26164199999999482, -79.83041759999998987 47.26152520000000123, -79.83049989999999241 47.26139099999999615, -79.83051469999999483 47.26131919999999553, -79.83052990000000193 47.26122929999999656, -79.83050479999999993 47.26116609999999696, -79.8304921999999948 47.26113900000000001, -79.83047959999998966 47.26111189999999596)";
		String ls2 = "LineString (-79.8333456999999953 47.26602729999999752, -79.83326699999999221 47.2659994999999995, -79.833240399999994 47.26600819999999459, -79.83312119999999368 47.26601600000000047, -79.83287049999999851 47.26599549999999539, -79.83260699999999588 47.26595679999999788, -79.83239549999998985 47.2659546000000006, -79.83222429999999292 47.26592589999999916, -79.8319740999999965 47.26587839999999829, -79.8317107999999962 47.26583069999999509, -79.83143309999999815 47.26583679999999532, -79.83122099999999932 47.26586169999999498, -79.83099589999999068 47.26587740000000082, -79.83070630000000278 47.26582039999999552, -79.83060100000000148 47.26580129999999969, -79.83041639999999006 47.26578149999999567, -79.830244399999998 47.26578869999999455, -79.83013799999999094 47.26581459999999879, -79.82999209999999835 47.26584009999999836, -79.82991239999999777 47.26585730000000041, -79.82984609999999748 47.26586559999999793)";
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();

		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-79.82983759999999, 47.2658644),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-79.82997189999999, 47.2661549),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-79.8298461, 47.2658656),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-79.82984185, 47.265865),NodeType.BANK,FlowDirection.INPUT, null));
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	@Test
	public void testSinkLake() throws Exception{
		String waterbody = "Polygon ((-110.25508859999999345 51.62821919999999665, -110.25580579999999031 51.628287499999999, -110.25658939999999575 51.62844839999999635, -110.25679339999999229 51.6285854999999998, -110.25717759999999146 51.62872309999999487, -110.25776489999999797 51.62911009999999834, -110.25820369999999571 51.62950099999999765, -110.25819959999999753 51.62956699999999444, -110.25830479999999056 51.62968169999999901, -110.25831829999999911 51.62975439999999594, -110.25845869999999138 51.62988250000000079, -110.25856949999999301 51.63016449999999935, -110.25876849999998797 51.63047979999999626, -110.25900469999999132 51.63100430000000074, -110.25910599999998851 51.63114759999999848, -110.25915390000000116 51.63134579999999829, -110.25977659999999503 51.63216639999999558, -110.25992079999998907 51.63226590000000016, -110.26019689999999684 51.63266279999999853, -110.26056919999999195 51.63383909999999588, -110.26068159999999807 51.63393409999999761, -110.26067700000000116 51.63407489999999456, -110.26074719999999729 51.6341388999999964, -110.26075349999999275 51.63423139999999734, -110.2609385999999887 51.63451140000000095, -110.26131169999999315 51.63473489999999799, -110.26197049999998967 51.63503619999999472, -110.26210709999999438 51.63519289999999984, -110.26214069999998912 51.63585089999999411, -110.26207589999999925 51.63599159999999699, -110.26202669999999273 51.63640069999999582, -110.26192129999999736 51.63674369999999669, -110.26188559999999939 51.63722549999999956, -110.26195839999999748 51.6374105999999955, -110.26188390000000084 51.63787029999999589, -110.2625793999999928 51.63845560000000035, -110.26272749999999689 51.63894679999999937, -110.26264829999999506 51.63912699999999489, -110.26268650000000093 51.63964419999999933, -110.26287229999999795 51.63984949999999685, -110.26276009999999417 51.64017479999999694, -110.26228270000000009 51.6406023999999988, -110.26186659999999051 51.64088059999999558, -110.26180649999999162 51.64088040000000035, -110.26166080000000136 51.64096800000000087, -110.26132459999999469 51.64099110000000081, -110.26048509999999681 51.64114689999999541, -110.25971450000000118 51.64109609999999861, -110.25910410000000184 51.64091810000000038, -110.25886829999998895 51.64077650000000119, -110.25857899999999745 51.64068979999999698, -110.25787529999999492 51.64023639999999915, -110.25780569999999159 51.64009759999999716, -110.25762279999999294 51.63997599999999721, -110.25763039999999648 51.63991879999999668, -110.2575528999999932 51.63987449999999768, -110.25743829999998979 51.63962109999999939, -110.25737499999999613 51.63957469999999716, -110.25733149999999227 51.63927309999999693, -110.25743849999999213 51.63916340000000105, -110.25748529999999903 51.63863320000000101, -110.25730649999999855 51.63844559999999717, -110.25624030000000175 51.63821550000000116, -110.25527110000000164 51.63781189999999555, -110.25505579999999384 51.63776060000000001, -110.25466139999998916 51.63755909999999716, -110.2545162999999917 51.63757179999999636, -110.25348350000000153 51.63715919999999926, -110.25215639999998984 51.63641769999999553, -110.25164079999998989 51.63632810000000006, -110.25113309999998989 51.63614379999999926, -110.25095369999999662 51.63603099999999557, -110.25095779999999479 51.63596499999999878, -110.25047939999998903 51.63566409999999962, -110.24993649999998979 51.6350461999999979, -110.24983159999999316 51.63447370000000092, -110.24974729999999568 51.6344117999999952, -110.24973779999999124 51.63427319999999554, -110.24952439999999854 51.63399739999999838, -110.24893910000000119 51.6338061999999951, -110.24871720000000153 51.63369989999999632, -110.24873230000000035 51.63358549999999525, -110.24890320000000088 51.63344739999999433, -110.24894689999999287 51.63329129999999623, -110.24901810000000069 51.63324319999999545, -110.24900139999999737 51.63312429999999864, -110.2489380999999895 51.63307789999999642, -110.24882639999999867 51.63248779999999982, -110.24890099999998938 51.63244839999999414, -110.24932019999999966 51.63095560000000006, -110.24938779999999383 51.63089859999999476, -110.24938589999999294 51.6307027000000005, -110.24949329999999748 51.63055569999999506, -110.24957349999999678 51.63026319999999458, -110.25038289999999108 51.62903799999999421, -110.25038409999999089 51.62888840000000101, -110.2505014999999986 51.628805100000001, -110.25049519999998893 51.62871269999999413, -110.25057359999999562 51.62864469999999528, -110.25055719999998871 51.62848839999999484, -110.25070039999999949 51.62827979999999428, -110.25078630000000146 51.62773439999999425, -110.25086459999999988 51.62766639999999541, -110.2508632999999918 51.62739579999999506, -110.25078969999999856 51.6273228999999958, -110.25078339999998889 51.62723049999999603, -110.25049359999999865 51.62679819999999609, -110.2504887999999994 51.62651879999999949, -110.25065250000000106 51.62640049999999547, -110.25123649999999031 51.62632089999999607, -110.25151529999999411 51.62638119999999731, -110.25192659999999023 51.62666420000000045, -110.25239669999999137 51.6270971000000003, -110.25244899999999859 51.62719179999999852, -110.25262490000000071 51.62729579999999885, -110.2526242999999937 51.62737070000000017, -110.2529618999999883 51.62758079999999694, -110.25298929999999586 51.62768870000000021, -110.25349919999999315 51.62803139999999757, -110.2537071999999938 51.62810249999999712, -110.25394289999999842 51.62824409999999631, -110.25467799999999841 51.62828169999999517, -110.25508859999999345 51.62821919999999665))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String ls1 = "LineString (-110.25989299999999105 51.6248258999999976, -110.25964220000000182 51.62479869999999949, -110.25941909999998813 51.62484200000000101, -110.25886069999999961 51.62525389999999703, -110.25808819999998889 51.62546489999999721, -110.25754139999999381 51.62575359999999591, -110.25647809999999538 51.62694289999999597, -110.25611560000000111 51.62716619999999779, -110.25548469999999668 51.62735559999999424, -110.2550011000000012 51.62769079999999633, -110.25485390000000052 51.62796540000000078, -110.25508859999999345 51.62821919999999665)";
		String ls2 = "LineString (-110.26591919999999902 51.63652729999999735, -110.26521799999999018 51.63665269999999907, -110.26471359999999322 51.63693500000000114, -110.26416179999999656 51.63782229999999629, -110.26361019999998803 51.63825190000000021, -110.2625793999999928 51.63845560000000035)";
		String ls3 = "LineString (-110.24802099999999427 51.6336469999999963, -110.24873230000000035 51.63358549999999525)";
		String ls4 = "LineString (-110.2336389999999966 51.61803270000000055, -110.23437669999999855 51.61815399999999698, -110.23546849999999608 51.61860439999999528, -110.2366851999999966 51.61853149999999602, -110.23829250000000002 51.61865139999999741, -110.23892949999999757 51.61897479999999661, -110.23928180000000054 51.61910799999999711, -110.24009129999998891 51.61910629999999855, -110.24036409999999364 51.61903679999999639, -110.24080079999998816 51.61881160000000079, -110.24200569999999288 51.61886179999999769, -110.24273689999999704 51.61892809999999798, -110.24307439999999758 51.61913819999999475, -110.243146799999991 51.61936069999999432, -110.2432099999999906 51.61940709999999655, -110.24328579999999533 51.61963839999999948, -110.24324609999999325 51.61972850000000079, -110.24333249999999396 51.62036909999999779, -110.24343039999999405 51.62050370000000044, -110.24360999999998967 51.62057910000000049, -110.24428109999999492 51.62064509999999729, -110.24637009999999293 51.62149480000000068, -110.2466913999999889 51.62196899999999999, -110.24687419999999349 51.62209059999999994, -110.24728349999999466 51.62217769999999462, -110.24753649999999539 51.62236339999999757, -110.247302899999994 51.62322079999999858, -110.24805080000000146 51.62382619999999633, -110.24870999999998844 51.62531369999999953, -110.24928109999999037 51.62592730000000074, -110.24954830000000072 51.6261107999999993, -110.24998879999999701 51.62627729999999815, -110.25065250000000106 51.62640049999999547)";
		String ls5 = "LineString (-110.2517232000000007 51.6209510999999992, -110.25153789999998821 51.62112880000000104, -110.25153229999999382 51.62138179999999466, -110.25194479999998975 51.62193549999999931, -110.25192719999999724 51.62234910000000099, -110.25226769999999021 51.62264289999999534, -110.25222079999998925 51.62275269999999949, -110.25189709999999366 51.62299809999999667, -110.25185999999999353 51.62320929999999919, -110.2515679999999918 51.62345919999999921, -110.25164669999999489 51.62419440000000037, -110.25130149999999674 51.62446169999999768, -110.25120019999999954 51.62473869999999465, -110.25126979999998866 51.62487749999999664, -110.25127580000000194 51.62542769999999592, -110.25113069999999027 51.62586069999999694, -110.25123649999999031 51.62632089999999607)";

		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		items.add((LineString)reader.read(ls3));
		items.add((LineString)reader.read(ls4));
		items.add((LineString)reader.read(ls5));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();
		
		String waterbody2 = "POLYGON ((-110.2550886 51.6282192, -110.25580579999999 51.6282875, -110.2565894 51.628448399999996, -110.25679339999999 51.6285855, -110.25717759999999 51.628723099999995, -110.2577649 51.6291101, -110.2582037 51.629501, -110.2581996 51.629566999999994, -110.25830479999999 51.6296817, -110.2583183 51.629754399999996, -110.25845869999999 51.6298825, -110.2585695 51.6301645, -110.25876849999999 51.630479799999996, -110.25900469999999 51.6310043, -110.25910599999999 51.6311476, -110.2591539 51.6313458, -110.2597766 51.632166399999996, -110.25992079999999 51.6322659, -110.2601969 51.6326628, -110.26056919999999 51.633839099999996, -110.2606816 51.6339341, -110.260677 51.634074899999995, -110.2607472 51.634138899999996, -110.26075349999999 51.6342314, -110.26093859999999 51.6345114, -110.2613117 51.6347349, -110.26197049999999 51.635036199999995, -110.2621071 51.6351929, -110.26214069999999 51.635850899999994, -110.2620759 51.6359916, -110.26202669999999 51.636400699999996, -110.2619213 51.6367437, -110.2618856 51.6372255, -110.2619584 51.637410599999995, -110.2618839 51.637870299999996, -110.26257939999999 51.6384556, -110.2627275 51.6389468, -110.2626483 51.639126999999995, -110.2626865 51.6396442, -110.2628723 51.6398495, -110.2627601 51.6401748, -110.2622827 51.6406024, -110.26186659999999 51.640880599999996, -110.26180649999999 51.6408804, -110.2616608 51.640968, -110.2613246 51.6409911, -110.2604851 51.641146899999995, -110.2597145 51.6410961, -110.2591041 51.6409181, -110.25886829999999 51.6407765, -110.258579 51.6406898, -110.2578753 51.6402364, -110.25780569999999 51.6400976, -110.2576228 51.639976, -110.2576304 51.6399188, -110.2575529 51.6398745, -110.25743829999999 51.6396211, -110.257375 51.6395747, -110.25733149999999 51.6392731, -110.25743849999999 51.6391634, -110.2574853 51.6386332, -110.2573065 51.6384456, -110.2562403 51.6382155, -110.2552711 51.637811899999996, -110.2550558 51.6377606, -110.25466139999999 51.6375591, -110.25451629999999 51.637571799999996, -110.2534835 51.6371592, -110.25215639999999 51.636417699999996, -110.25164079999999 51.6363281, -110.25113309999999 51.6361438, -110.2509537 51.636030999999996, -110.2509578 51.635965, -110.25047939999999 51.6356641, -110.24993649999999 51.6350462, -110.2498316 51.6344737, -110.2497473 51.634411799999995, -110.24973779999999 51.634273199999996, -110.2495244 51.6339974, -110.2489391 51.633806199999995, -110.2487172 51.633699899999996, -110.2487323 51.633585499999995, -110.2489032 51.633447399999994, -110.24894689999999 51.633291299999996, -110.2490181 51.633243199999995, -110.2490014 51.6331243, -110.24893809999999 51.633077899999996, -110.2488264 51.6324878, -110.24890099999999 51.632448399999994, -110.2493202 51.6309556, -110.2493878 51.630898599999995, -110.2493859 51.6307027, -110.2494933 51.630555699999995, -110.2495735 51.630263199999995, -110.25038289999999 51.629037999999994, -110.25038409999999 51.6288884, -110.2505015 51.6288051, -110.25049519999999 51.628712699999994, -110.2505736 51.628644699999995, -110.25055719999999 51.628488399999995, -110.2507004 51.628279799999994, -110.2507863 51.627734399999994, -110.2508646 51.627666399999995, -110.25086329999999 51.627395799999995, -110.2507897 51.627322899999996, -110.25078339999999 51.627230499999996, -110.2504936 51.626798199999996, -110.2504888 51.6265188, -110.2506525 51.626400499999995, -110.2509445 51.62636069999999, -110.25123649999999 51.626320899999996, -110.2515153 51.6263812, -110.25192659999999 51.6266642, -110.25239669999999 51.6270971, -110.252449 51.6271918, -110.2526249 51.6272958, -110.2526243 51.6273707, -110.25296189999999 51.6275808, -110.2529893 51.6276887, -110.2534992 51.6280314, -110.2537072 51.6281025, -110.2539429 51.628244099999996, -110.254678 51.628281699999995, -110.2550886 51.6282192))";
		Polygon polygon2 = (Polygon)reader.read(waterbody2);

		Polygon wp = pg.getUpdatedPolygons().iterator().next();
		Assert.assertTrue("Fixed waterbody polygon does not match expected", polygon2.equalsExact(wp));
		
		Set<ConstructionPoint> expected = new HashSet<>();
		
		expected.add(new ConstructionPoint(new Coordinate(-110.2550886, 51.6282192),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.26257939999999, 51.6384556),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2487323, 51.633585499999995),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2506525, 51.626400499999995),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.25123649999999, 51.626320899999996),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.25296189999999, 51.6275808), NodeType.TERMINAL,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2509445, 51.62636069999999), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2495735, 51.630263199999995), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2562403, 51.6382155), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.25239669999999, 51.6270971), NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-110.2601969, 51.6326628),NodeType.BANK,FlowDirection.INPUT, null));

		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	@Test
	public void testNarrowChannel() throws Exception{
		String waterbody = "POLYGON (( -78.96453799999999 47.2036458, -78.9646037 47.2036641, -78.9645771 47.203691, -78.96452479999999 47.2036458, -78.9644194 47.2036273, -78.96431439999999 47.2035548, -78.9642489 47.2035096, -78.96389409999999 47.203354999999995, -78.9638681 47.2033099, -78.96388189999999 47.203255999999996, -78.9639478 47.2032653, -78.96401329999999 47.203310599999995, -78.96413299999999 47.2032301, -78.9642257 47.203203599999995, -78.9643706 47.2032313, -78.9643833 47.203267399999994, -78.9642904 47.2033298, -78.9642501 47.2033926, -78.9643018 47.2035098, -78.9643804 47.203555099999996, -78.9645121 47.2035918, -78.96453799999999 47.2036458 ))";
		Polygon polygon = (Polygon)reader.read(waterbody);

		String ls1 = "LINESTRING ( -78.9645771 47.203691, -78.9646954 47.2037455, -78.9647871 47.2038089, -78.9648265 47.2038361, -78.964984 47.2039269, -78.965181 47.2040267, -78.9662065 47.2044183, -78.96624609999999 47.2044275, -78.9667726 47.2045739, -78.96735129999999 47.2047834, -78.96770599999999 47.204965, -78.9681528 47.205155999999995, -78.9683366 47.205255799999996, -78.96890189999999 47.205492299999996, -78.96907329999999 47.205511099999995, -78.96916569999999 47.2055115, -78.969509 47.2054951, -78.96986559999999 47.205478799999995 )";
		String ls2 = "LINESTRING ( -78.964857 47.203422499999995, -78.964671 47.2035385, -78.96453799999999 47.2036458 )";
		ArrayList<LineString> items = new ArrayList<>();
		items.add((LineString)reader.read(ls1));
		items.add((LineString)reader.read(ls2));
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, Collections.emptyList(), items);
		List<ConstructionPoint> pnts = pg.getPoints();

		Set<ConstructionPoint> expected = new HashSet<>();
		expected.add(new ConstructionPoint(new Coordinate(-78.96453799999999, 47.2036458),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-78.9645771, 47.203691),NodeType.FLOWPATH,FlowDirection.OUTPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-78.96401329999999, 47.203310599999995),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(-78.9646037, 47.2036641),NodeType.BANK,FlowDirection.INPUT, null));
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
	}
	
	
	
	@Test
	public void testApplyNames() throws Exception{
		String waterbody = "POLYGON (( 0 0, 0 5, 3 5, 5 5, 5 2,  5 0, 0 0))";
		Polygon polygon = (Polygon)reader.read(waterbody);
		
		String waterbody2 = "POLYGON (( 5 0, 5 2, 5 5, 8 5, 8 0, 5 0))";
		Polygon polygon2 = (Polygon)reader.read(waterbody2);

		String ls1 = "LINESTRING ( -1 -1, 0 0 )";
		String ls2 = "LINESTRING ( -.4 -.2, 0 0)";
		String ls3 = "LINESTRING ( 6 6, 3 5)";
		
		
		ArrayList<LineString> items = new ArrayList<>();
		LineString g1 = (LineString) reader.read(ls1);
		g1.setUserData(new Object[] {DirectionType.KNOWN, new String[] {"edge1namea", "edge1nameb"}});
		
		LineString g2 = (LineString) reader.read(ls2);
		g2.setUserData(new Object[] {DirectionType.KNOWN, new String[] {"edge2namea"}});
		
		LineString g3 = (LineString) reader.read(ls3);
		g3.setUserData(new Object[] {DirectionType.KNOWN, new String[] {null, "edge3nameb"}});
		
		items.add(g1);
		items.add(g2);
		items.add(g3);
		
		List<Polygon> other = new ArrayList<>();
		other.add(polygon2);
		
		HashMap<Coordinate, List<String[]>> skelnames = new HashMap<>();
		List<String[]> names = new ArrayList<>();
		names.add(new String[] {"skeletonnamea", "skeletonnameb"});
		skelnames.put(new Coordinate(5, 2), names);
		
		PointGenerator pg = createPointGenerator();
		pg.processPolygon(polygon, other, items, skelnames);
		List<ConstructionPoint> pnts = pg.getPoints();

		List<ConstructionPoint> expected = new ArrayList<>();
		expected.add(new ConstructionPoint(new Coordinate(0, 0),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(3, 5),NodeType.FLOWPATH,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(5, 2.5),NodeType.WATER,FlowDirection.UNKNOWN, null));
		expected.add(new ConstructionPoint(new Coordinate(4, 5),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(0, 5),NodeType.BANK,FlowDirection.INPUT, null));
		expected.add(new ConstructionPoint(new Coordinate(2.5,0),NodeType.BANK,FlowDirection.INPUT, null));
		Assert.assertEquals("invalid number of nodes", expected.size(), pnts.size());
		setEquals(expected, pnts);
		
		for (ConstructionPoint pnt : pnts) {
			if (pnt.getCoordinate().equals2D(new Coordinate(0, 0))) {
				Assert.assertEquals("invalid number of names", pnt.getNameIds().size(), 2);
				Assert.assertEquals("invalid number of names", pnt.getNameIds().get(0).length, 2);
				Assert.assertEquals("invalid number of names", pnt.getNameIds().get(1).length, 1);
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[0], "edge1namea");
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[1], "edge1nameb");
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(1)[0], "edge2namea");
				
			}else if (pnt.getCoordinate().equals2D(new Coordinate(3, 5))) {
				Assert.assertEquals("invalid number of names", pnt.getNameIds().size(), 1);
				Assert.assertEquals("invalid number of names", pnt.getNameIds().get(0).length, 2);
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[0], null);
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[1], "edge3nameb");
			}else if (pnt.getCoordinate().equals2D(new Coordinate(5, 2.5))) {
				Assert.assertEquals("invalid number of names", pnt.getNameIds().size(), 1);
				Assert.assertEquals("invalid number of names", pnt.getNameIds().get(0).length, 2);
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[0], "skeletonnamea");
				Assert.assertEquals("invalid number of name", pnt.getNameIds().get(0)[1], "skeletonnameb");
			}else {
				Assert.assertEquals("invalid number of names", null, pnt.getNameIds());
				
			}
		}
	}
	
	
	
	
	private boolean equals(ConstructionPoint a, ConstructionPoint b) {
		 if (!a.getCoordinate().equals2D(b.getCoordinate())) return false;
		 if (!a.getType().equals(b.getType())) return false;
		 if (!a.getDirection().equals(b.getDirection())) return false;
		 return true;
	}
	
	private boolean equals(Polygon a, Polygon b) {
		return a.equalsExact(b);
	}
	

	private void setEquals(Collection<ConstructionPoint> expected, Collection<ConstructionPoint> actual) {
		for (ConstructionPoint p : expected) {
			boolean found = false;
			for (ConstructionPoint b : actual) {
				if (equals(p,b)) {
					found = true;
					break;
				}
			}
			if (!found) {
				Assert.fail("Expected skeleton points not found: POINT(" + p.getCoordinate().x + " " + p.getCoordinate().y + ") " + p.getType() + " " + p.getDirection());
			}
		}
	}
	
	private void polygonSetEquals(Collection<Polygon> expected, Collection<Polygon> actual) {
		for (Polygon p : expected) {
			boolean found = false;
			for (Polygon b : actual) {
				if (equals(p,b)) {
					found = true;
					break;
				}
			}
			if (!found) {
				Assert.fail("Expected updated polygons not found: " + p.toText());
			}
		}
	}


}
